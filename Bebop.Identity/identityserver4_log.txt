2025-04-02 07:46:02.430 +00:00 [INF] Starting IdentityServer4 version 4.1.1+cebd52f5bc61bdefc262fd20739d4d087c6f961f
2025-04-02 07:46:02.471 +00:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2025-04-02 07:46:02.472 +00:00 [DBG] Custom IssuerUri set to https://webapi:8081
2025-04-02 07:46:02.482 +00:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2025-04-02 07:46:02.483 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2025-04-02 07:46:02.484 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2025-04-02 07:46:02.485 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2025-04-02 07:46:02.486 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2025-04-02 07:46:02.487 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2025-04-02 07:46:02.661 +00:00 [WRN] Using an in-memory repository. Keys will not be persisted to storage.
2025-04-02 07:46:02.662 +00:00 [WRN] Neither user profile nor HKLM registry available. Using an ephemeral key repository. Protected data will be unavailable when application exits.
2025-04-02 07:46:02.680 +00:00 [WRN] No XML encryptor configured. Key "13e4e042-52b9-4caf-baa4-6b88d1dc3da1" may be persisted to storage in unencrypted form.
2025-04-02 07:47:01.140 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 07:47:01.150 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 07:47:01.151 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 07:47:01.179 +00:00 [DBG] Login Url: /Account/Login
2025-04-02 07:47:01.179 +00:00 [DBG] Login Return Url Parameter: ReturnUrl
2025-04-02 07:47:01.180 +00:00 [DBG] Logout Url: /Account/Logout
2025-04-02 07:47:01.181 +00:00 [DBG] ConsentUrl Url: /consent
2025-04-02 07:47:01.182 +00:00 [DBG] Consent Return Url Parameter: returnUrl
2025-04-02 07:47:01.183 +00:00 [DBG] Error Url: /home/error
2025-04-02 07:47:01.184 +00:00 [DBG] Error Id Parameter: errorId
2025-04-02 07:47:01.201 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 07:47:01.207 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 07:47:01.208 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 07:47:01.212 +00:00 [DBG] Start discovery request
2025-04-02 07:47:01.376 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 07:47:01.381 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 07:47:01.388 +00:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2025-04-02 07:47:01.413 +00:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2025-04-02 07:47:01.413 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2025-04-02 07:47:01.420 +00:00 [DBG] Start authorize request
2025-04-02 07:47:01.442 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 07:47:01.446 +00:00 [DBG] No user present in authorize request
2025-04-02 07:47:01.450 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 07:47:01.461 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 07:47:01.492 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 07:47:01.507 +00:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","AllowedRedirectUris":["http://localhost:3000/signin-oidc"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email doughnutapi","State":"32afe6e85eb24ab5aafdbc777b584171","UiLocales":null,"Nonce":"3816e3a33df4492ea53858268c6be6ab","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"wewantdoughnuts","redirect_uri":"http://localhost:3000/signin-oidc","response_type":"id_token token","scope":"openid profile email doughnutapi","state":"32afe6e85eb24ab5aafdbc777b584171","nonce":"3816e3a33df4492ea53858268c6be6ab"},"$type":"AuthorizeRequestValidationLog"}
2025-04-02 07:47:01.520 +00:00 [INF] Showing login: User is not authenticated
2025-04-02 07:47:01.549 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 07:47:01.552 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 07:47:01.602 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 07:47:01.603 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 07:47:01.604 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 07:47:01.605 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 07:47:01.609 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 07:47:03.375 +00:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2025-04-02 07:47:03.378 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 07:47:03.379 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 07:47:03.422 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 07:47:03.423 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 07:47:03.423 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 07:47:03.425 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 07:47:03.443 +00:00 [INF] {"Username":"alice","Provider":null,"ProviderUserId":null,"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","DisplayName":"alice","Endpoint":"UI","ClientId":"wewantdoughnuts","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HNBHNA6PHVJJ:00000005","TimeStamp":"2025-04-02T07:47:03.0000000Z","ProcessId":196,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"UserLoginSuccessEvent"}
2025-04-02 07:47:03.449 +00:00 [DBG] Augmenting SignInContext
2025-04-02 07:47:03.450 +00:00 [DBG] Adding idp claim with value: local
2025-04-02 07:47:03.451 +00:00 [DBG] Adding amr claim with value: pwd
2025-04-02 07:47:03.454 +00:00 [DBG] Adding auth_time claim with value: 1743580023
2025-04-02 07:47:03.457 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 07:47:03.467 +00:00 [INF] AuthenticationScheme: idsrv signed in.
2025-04-02 07:47:03.494 +00:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2025-04-02 07:47:03.498 +00:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2025-04-02 07:47:03.498 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2025-04-02 07:47:03.502 +00:00 [DBG] Start authorize callback request
2025-04-02 07:47:03.518 +00:00 [DBG] User in authorize request: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 07:47:03.518 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 07:47:03.519 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 07:47:03.521 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 07:47:03.529 +00:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","AllowedRedirectUris":["http://localhost:3000/signin-oidc"],"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email doughnutapi","State":"32afe6e85eb24ab5aafdbc777b584171","UiLocales":null,"Nonce":"3816e3a33df4492ea53858268c6be6ab","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"73078869144D95F24E8AF3DA89BD2F13","Raw":{"client_id":"wewantdoughnuts","redirect_uri":"http://localhost:3000/signin-oidc","response_type":"id_token token","scope":"openid profile email doughnutapi","state":"32afe6e85eb24ab5aafdbc777b584171","nonce":"3816e3a33df4492ea53858268c6be6ab"},"$type":"AuthorizeRequestValidationLog"}
2025-04-02 07:47:03.537 +00:00 [DBG] Client is configured to not require consent, no consent is required
2025-04-02 07:47:03.541 +00:00 [DBG] Creating Implicit Flow response.
2025-04-02 07:47:03.554 +00:00 [DBG] Getting claims for access token for client: wewantdoughnuts
2025-04-02 07:47:03.562 +00:00 [DBG] Getting claims for access token for subject: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 07:47:03.715 +00:00 [DBG] Getting claims for identity token for subject: 42006211-B900-4701-A6F8-2986370C3563 and client: wewantdoughnuts
2025-04-02 07:47:03.716 +00:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2025-04-02 07:47:03.728 +00:00 [INF] {"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","Endpoint":"Authorize","SubjectId":"42006211-B900-4701-A6F8-2986370C3563","Scopes":"openid profile email doughnutapi","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****1Qyw","$type":"Token"},{"TokenType":"access_token","TokenValue":"****MTcQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HNBHNA6PHVJJ:00000007","TimeStamp":"2025-04-02T07:47:03.0000000Z","ProcessId":196,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"TokenIssuedSuccessEvent"}
2025-04-02 07:47:03.731 +00:00 [DBG] Authorize endpoint response
{"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ClientId":"wewantdoughnuts","RedirectUri":"http://localhost:3000/signin-oidc","State":"32afe6e85eb24ab5aafdbc777b584171","Scope":"openid profile email doughnutapi","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2025-04-02 07:47:03.738 +00:00 [DBG] Augmenting SignInContext
2025-04-02 07:47:03.742 +00:00 [INF] AuthenticationScheme: idsrv signed in.
2025-04-02 07:47:04.297 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 07:47:04.298 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 07:47:04.299 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 07:47:04.300 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 07:47:04.305 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 07:47:04.310 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 07:47:04.311 +00:00 [DBG] Start discovery request
2025-04-02 07:47:04.334 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:3000
2025-04-02 07:47:04.335 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 07:47:04.336 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 07:47:04.381 +00:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2025-04-02 07:47:04.386 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2025-04-02 07:47:04.391 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2025-04-02 07:47:04.395 +00:00 [DBG] Start key discovery request
2025-04-02 07:47:04.464 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 07:47:04.464 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 07:47:04.465 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 07:47:04.499 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 07:47:04.500 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 07:47:04.500 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 07:47:04.501 +00:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2025-04-02 07:47:04.504 +00:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2025-04-02 07:47:04.505 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2025-04-02 07:47:04.509 +00:00 [DBG] Start userinfo request
2025-04-02 07:47:04.512 +00:00 [DBG] Bearer token found in header
2025-04-02 07:47:04.578 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 07:47:04.580 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 07:47:04.581 +00:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2025-04-02 07:47:04.583 +00:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":"91D9E2FEF517F1CDE8E3859C5E3FA4D0","Claims":{"nbf":1743580023,"exp":1743583623,"iss":"https://webapi:8081","aud":["doughnutapi","https://webapi:8081/resources"],"client_id":"wewantdoughnuts","sub":"42006211-B900-4701-A6F8-2986370C3563","auth_time":1743580023,"idp":"local","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress":"AliceSmith@email.com","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname":"Alice","jti":"91D9E2FEF517F1CDE8E3859C5E3FA4D0","sid":"73078869144D95F24E8AF3DA89BD2F13","iat":1743580023,"scope":["openid","profile","email","doughnutapi"],"amr":"pwd"},"$type":"TokenValidationLog"}
2025-04-02 07:47:04.587 +00:00 [DBG] Creating userinfo response
2025-04-02 07:47:04.591 +00:00 [DBG] Scopes in access token: openid profile email doughnutapi
2025-04-02 07:47:04.594 +00:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2025-04-02 07:47:04.595 +00:00 [INF] Profile service returned the following claim types: email given_name
2025-04-02 07:47:04.595 +00:00 [DBG] End userinfo request
2025-04-02 07:47:04.719 +00:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2025-04-02 07:47:04.720 +00:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2025-04-02 07:47:04.721 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2025-04-02 07:47:04.723 +00:00 [DBG] Rendering check session result
2025-04-02 07:47:09.916 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 07:47:09.918 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 07:47:09.918 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 07:47:09.919 +00:00 [DBG] Start discovery request
2025-04-02 07:47:09.946 +00:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2025-04-02 07:47:09.947 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2025-04-02 07:47:09.948 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2025-04-02 07:47:09.949 +00:00 [DBG] Start key discovery request
2025-04-02 09:08:13.174 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 09:08:13.208 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 09:08:13.208 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 09:08:13.248 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 09:08:13.253 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 09:08:13.254 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 09:08:13.255 +00:00 [DBG] Start discovery request
2025-04-02 09:08:13.431 +00:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2025-04-02 09:08:13.441 +00:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2025-04-02 09:08:13.442 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2025-04-02 09:08:13.446 +00:00 [DBG] Rendering check session result
2025-04-02 09:08:16.544 +00:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2025-04-02 09:08:16.554 +00:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2025-04-02 09:08:16.554 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2025-04-02 09:08:16.555 +00:00 [DBG] Start authorize request
2025-04-02 09:08:16.561 +00:00 [DBG] User in authorize request: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 09:08:16.563 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 09:08:16.567 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 09:08:16.573 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 09:08:16.579 +00:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","AllowedRedirectUris":["http://localhost:3000/signin-oidc"],"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email doughnutapi","State":"370ec91f66b64974bedaaba551e4a82e","UiLocales":null,"Nonce":"673323f600e34516b74a3cfe8725bd22","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"73078869144D95F24E8AF3DA89BD2F13","Raw":{"client_id":"wewantdoughnuts","redirect_uri":"http://localhost:3000/signin-oidc","response_type":"id_token token","scope":"openid profile email doughnutapi","state":"370ec91f66b64974bedaaba551e4a82e","nonce":"673323f600e34516b74a3cfe8725bd22"},"$type":"AuthorizeRequestValidationLog"}
2025-04-02 09:08:16.582 +00:00 [DBG] Client is configured to not require consent, no consent is required
2025-04-02 09:08:16.584 +00:00 [DBG] Creating Implicit Flow response.
2025-04-02 09:08:16.586 +00:00 [DBG] Getting claims for access token for client: wewantdoughnuts
2025-04-02 09:08:16.587 +00:00 [DBG] Getting claims for access token for subject: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 09:08:16.610 +00:00 [DBG] Getting claims for identity token for subject: 42006211-B900-4701-A6F8-2986370C3563 and client: wewantdoughnuts
2025-04-02 09:08:16.613 +00:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2025-04-02 09:08:16.626 +00:00 [INF] {"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","Endpoint":"Authorize","SubjectId":"42006211-B900-4701-A6F8-2986370C3563","Scopes":"openid profile email doughnutapi","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****t-PQ","$type":"Token"},{"TokenType":"access_token","TokenValue":"****CpLQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HNBHNA6PHVJO:00000001","TimeStamp":"2025-04-02T09:08:16.0000000Z","ProcessId":196,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"TokenIssuedSuccessEvent"}
2025-04-02 09:08:16.633 +00:00 [DBG] Authorize endpoint response
{"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ClientId":"wewantdoughnuts","RedirectUri":"http://localhost:3000/signin-oidc","State":"370ec91f66b64974bedaaba551e4a82e","Scope":"openid profile email doughnutapi","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2025-04-02 09:08:17.006 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 09:08:17.007 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 09:08:17.017 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 09:08:17.048 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 09:08:17.052 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 09:08:17.057 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 09:08:17.069 +00:00 [DBG] Start discovery request
2025-04-02 09:08:17.153 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 09:08:17.163 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 09:08:17.166 +00:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2025-04-02 09:08:17.171 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 09:08:17.182 +00:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2025-04-02 09:08:17.191 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 09:08:17.197 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2025-04-02 09:08:17.203 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 09:08:17.213 +00:00 [DBG] Rendering check session result
2025-04-02 09:08:17.218 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 09:08:17.227 +00:00 [DBG] Start discovery request
2025-04-02 09:08:17.291 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:3000
2025-04-02 09:08:17.304 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 09:08:17.308 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 09:08:17.315 +00:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2025-04-02 09:08:17.327 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2025-04-02 09:08:17.329 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2025-04-02 09:08:17.332 +00:00 [DBG] Start key discovery request
2025-04-02 09:08:17.493 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 09:08:17.495 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 09:08:17.503 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 09:08:17.521 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 09:08:17.528 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 09:08:17.539 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 09:08:17.545 +00:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2025-04-02 09:08:17.552 +00:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2025-04-02 09:08:17.552 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2025-04-02 09:08:17.554 +00:00 [DBG] Start userinfo request
2025-04-02 09:08:17.557 +00:00 [DBG] Bearer token found in header
2025-04-02 09:08:17.582 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 09:08:17.584 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 09:08:17.591 +00:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2025-04-02 09:08:17.601 +00:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":"555E1D5412B4DF4516A2CF31562BD084","Claims":{"nbf":1743584896,"exp":1743588496,"iss":"https://webapi:8081","aud":["doughnutapi","https://webapi:8081/resources"],"client_id":"wewantdoughnuts","sub":"42006211-B900-4701-A6F8-2986370C3563","auth_time":1743580023,"idp":"local","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress":"AliceSmith@email.com","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname":"Alice","jti":"555E1D5412B4DF4516A2CF31562BD084","sid":"73078869144D95F24E8AF3DA89BD2F13","iat":1743584896,"scope":["openid","profile","email","doughnutapi"],"amr":"pwd"},"$type":"TokenValidationLog"}
2025-04-02 09:08:17.604 +00:00 [DBG] Creating userinfo response
2025-04-02 09:08:17.607 +00:00 [DBG] Scopes in access token: openid profile email doughnutapi
2025-04-02 09:08:17.608 +00:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2025-04-02 09:08:17.609 +00:00 [INF] Profile service returned the following claim types: email given_name
2025-04-02 09:08:17.610 +00:00 [DBG] End userinfo request
2025-04-02 09:13:39.030 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 09:13:39.036 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 09:13:39.041 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 09:13:39.042 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 09:13:39.044 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 09:13:39.049 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 09:13:39.051 +00:00 [DBG] Start discovery request
2025-04-02 09:13:39.130 +00:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2025-04-02 09:13:39.141 +00:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2025-04-02 09:13:39.141 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2025-04-02 09:13:39.142 +00:00 [DBG] Start authorize request
2025-04-02 09:13:39.145 +00:00 [DBG] User in authorize request: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 09:13:39.147 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 09:13:39.152 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 09:13:39.160 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 09:13:39.162 +00:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","AllowedRedirectUris":["http://localhost:3000/signin-oidc"],"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email doughnutapi","State":"b6d282295d734cb2898db7ba63cf9b67","UiLocales":null,"Nonce":"f7c7b3a590cc4b61ae04c30448281988","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"73078869144D95F24E8AF3DA89BD2F13","Raw":{"client_id":"wewantdoughnuts","redirect_uri":"http://localhost:3000/signin-oidc","response_type":"id_token token","scope":"openid profile email doughnutapi","state":"b6d282295d734cb2898db7ba63cf9b67","nonce":"f7c7b3a590cc4b61ae04c30448281988"},"$type":"AuthorizeRequestValidationLog"}
2025-04-02 09:13:39.168 +00:00 [DBG] Client is configured to not require consent, no consent is required
2025-04-02 09:13:39.170 +00:00 [DBG] Creating Implicit Flow response.
2025-04-02 09:13:39.173 +00:00 [DBG] Getting claims for access token for client: wewantdoughnuts
2025-04-02 09:13:39.173 +00:00 [DBG] Getting claims for access token for subject: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 09:13:39.178 +00:00 [DBG] Getting claims for identity token for subject: 42006211-B900-4701-A6F8-2986370C3563 and client: wewantdoughnuts
2025-04-02 09:13:39.184 +00:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2025-04-02 09:13:39.187 +00:00 [INF] {"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","Endpoint":"Authorize","SubjectId":"42006211-B900-4701-A6F8-2986370C3563","Scopes":"openid profile email doughnutapi","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****jKRw","$type":"Token"},{"TokenType":"access_token","TokenValue":"****b3Xw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HNBHNA6PHVJQ:00000001","TimeStamp":"2025-04-02T09:13:39.0000000Z","ProcessId":196,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"TokenIssuedSuccessEvent"}
2025-04-02 09:13:39.189 +00:00 [DBG] Authorize endpoint response
{"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ClientId":"wewantdoughnuts","RedirectUri":"http://localhost:3000/signin-oidc","State":"b6d282295d734cb2898db7ba63cf9b67","Scope":"openid profile email doughnutapi","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2025-04-02 09:13:39.605 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 09:13:39.620 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 09:13:39.626 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 09:13:39.629 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 09:13:39.630 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 09:13:39.633 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 09:13:39.634 +00:00 [DBG] Start discovery request
2025-04-02 09:13:39.667 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:3000
2025-04-02 09:13:39.670 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 09:13:39.672 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 09:13:39.676 +00:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2025-04-02 09:13:39.684 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2025-04-02 09:13:39.686 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2025-04-02 09:13:39.691 +00:00 [DBG] Start key discovery request
2025-04-02 09:13:39.728 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 09:13:39.730 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 09:13:39.733 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 09:13:39.790 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 09:13:39.791 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 09:13:39.791 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 09:13:39.793 +00:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2025-04-02 09:13:39.797 +00:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2025-04-02 09:13:39.798 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2025-04-02 09:13:39.799 +00:00 [DBG] Start userinfo request
2025-04-02 09:13:39.800 +00:00 [DBG] Bearer token found in header
2025-04-02 09:13:39.802 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 09:13:39.803 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 09:13:39.804 +00:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2025-04-02 09:13:39.805 +00:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":"E441F9CA2BFDAD075365BD8FEF68B0D8","Claims":{"nbf":1743585219,"exp":1743588819,"iss":"https://webapi:8081","aud":["doughnutapi","https://webapi:8081/resources"],"client_id":"wewantdoughnuts","sub":"42006211-B900-4701-A6F8-2986370C3563","auth_time":1743580023,"idp":"local","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress":"AliceSmith@email.com","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname":"Alice","jti":"E441F9CA2BFDAD075365BD8FEF68B0D8","sid":"73078869144D95F24E8AF3DA89BD2F13","iat":1743585219,"scope":["openid","profile","email","doughnutapi"],"amr":"pwd"},"$type":"TokenValidationLog"}
2025-04-02 09:13:39.806 +00:00 [DBG] Creating userinfo response
2025-04-02 09:13:39.807 +00:00 [DBG] Scopes in access token: openid profile email doughnutapi
2025-04-02 09:13:39.808 +00:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2025-04-02 09:13:39.814 +00:00 [INF] Profile service returned the following claim types: email given_name
2025-04-02 09:13:39.815 +00:00 [DBG] End userinfo request
2025-04-02 09:13:39.976 +00:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2025-04-02 09:13:39.976 +00:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2025-04-02 09:13:39.977 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2025-04-02 09:13:39.977 +00:00 [DBG] Rendering check session result
2025-04-02 09:29:28.931 +00:00 [INF] Starting IdentityServer4 version 4.1.1+cebd52f5bc61bdefc262fd20739d4d087c6f961f
2025-04-02 09:29:29.003 +00:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2025-04-02 09:29:29.006 +00:00 [DBG] Custom IssuerUri set to https://webapi:8081
2025-04-02 09:29:29.024 +00:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2025-04-02 09:29:29.025 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2025-04-02 09:29:29.026 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2025-04-02 09:29:29.030 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2025-04-02 09:29:29.033 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2025-04-02 09:29:29.036 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2025-04-02 09:29:29.390 +00:00 [WRN] Using an in-memory repository. Keys will not be persisted to storage.
2025-04-02 09:29:29.391 +00:00 [WRN] Neither user profile nor HKLM registry available. Using an ephemeral key repository. Protected data will be unavailable when application exits.
2025-04-02 09:29:29.419 +00:00 [WRN] No XML encryptor configured. Key "f1916776-0de6-4f96-b18a-e026582679d5" may be persisted to storage in unencrypted form.
2025-04-02 09:29:30.950 +00:00 [DBG] Login Url: /Account/Login
2025-04-02 09:29:30.953 +00:00 [DBG] Login Return Url Parameter: ReturnUrl
2025-04-02 09:29:30.953 +00:00 [DBG] Logout Url: /Account/Logout
2025-04-02 09:29:30.954 +00:00 [DBG] ConsentUrl Url: /consent
2025-04-02 09:29:30.955 +00:00 [DBG] Consent Return Url Parameter: returnUrl
2025-04-02 09:29:30.957 +00:00 [DBG] Error Url: /home/error
2025-04-02 09:29:30.958 +00:00 [DBG] Error Id Parameter: errorId
2025-04-02 09:29:30.985 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 09:29:30.993 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 09:29:30.994 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 09:29:30.996 +00:00 [DBG] Start discovery request
2025-04-02 09:29:31.129 +00:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2025-04-02 09:29:31.131 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2025-04-02 09:29:31.132 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2025-04-02 09:29:31.136 +00:00 [DBG] Start key discovery request
2025-04-02 09:30:02.614 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 09:30:02.620 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 09:30:02.622 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 09:30:02.642 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 09:30:02.645 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 09:30:02.647 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 09:30:02.649 +00:00 [DBG] Start discovery request
2025-04-02 09:30:02.729 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 09:30:02.732 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 09:30:03.377 +00:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2025-04-02 09:30:03.443 +00:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2025-04-02 09:30:03.445 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2025-04-02 09:30:03.459 +00:00 [DBG] Start authorize request
2025-04-02 09:30:03.482 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 09:30:03.486 +00:00 [DBG] No user present in authorize request
2025-04-02 09:30:03.494 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 09:30:03.512 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 09:30:03.553 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 09:30:03.571 +00:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","AllowedRedirectUris":["http://localhost:3000/signin-oidc"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email doughnutapi","State":"d4821722c5544e1bafc3c04ab82e27fd","UiLocales":null,"Nonce":"b8539cd0d6254b449cf02032e38c6483","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"wewantdoughnuts","redirect_uri":"http://localhost:3000/signin-oidc","response_type":"id_token token","scope":"openid profile email doughnutapi","state":"d4821722c5544e1bafc3c04ab82e27fd","nonce":"b8539cd0d6254b449cf02032e38c6483"},"$type":"AuthorizeRequestValidationLog"}
2025-04-02 09:30:03.587 +00:00 [INF] Showing login: User is not authenticated
2025-04-02 09:30:03.616 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 09:30:03.617 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 09:30:03.685 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 09:30:03.686 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 09:30:03.686 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 09:30:03.688 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 09:30:03.692 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 09:30:05.293 +00:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2025-04-02 09:30:05.295 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 09:30:05.296 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 09:30:05.339 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 09:30:05.339 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 09:30:05.340 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 09:30:05.341 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 09:30:05.366 +00:00 [INF] {"Username":"alice","Provider":null,"ProviderUserId":null,"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","DisplayName":"alice","Endpoint":"UI","ClientId":"wewantdoughnuts","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HNBHP3FIDACH:00000005","TimeStamp":"2025-04-02T09:30:05.0000000Z","ProcessId":658,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"UserLoginSuccessEvent"}
2025-04-02 09:30:05.376 +00:00 [DBG] Augmenting SignInContext
2025-04-02 09:30:05.378 +00:00 [DBG] Adding idp claim with value: local
2025-04-02 09:30:05.379 +00:00 [DBG] Adding amr claim with value: pwd
2025-04-02 09:30:05.380 +00:00 [DBG] Adding auth_time claim with value: 1743586205
2025-04-02 09:30:05.383 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 09:30:05.398 +00:00 [INF] AuthenticationScheme: idsrv signed in.
2025-04-02 09:30:05.447 +00:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2025-04-02 09:30:05.450 +00:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2025-04-02 09:30:05.450 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2025-04-02 09:30:05.454 +00:00 [DBG] Start authorize callback request
2025-04-02 09:30:05.459 +00:00 [DBG] User in authorize request: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 09:30:05.460 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 09:30:05.461 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 09:30:05.464 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 09:30:05.467 +00:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","AllowedRedirectUris":["http://localhost:3000/signin-oidc"],"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email doughnutapi","State":"d4821722c5544e1bafc3c04ab82e27fd","UiLocales":null,"Nonce":"b8539cd0d6254b449cf02032e38c6483","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"E4B462430272C155F64393CD4B6C03C0","Raw":{"client_id":"wewantdoughnuts","redirect_uri":"http://localhost:3000/signin-oidc","response_type":"id_token token","scope":"openid profile email doughnutapi","state":"d4821722c5544e1bafc3c04ab82e27fd","nonce":"b8539cd0d6254b449cf02032e38c6483"},"$type":"AuthorizeRequestValidationLog"}
2025-04-02 09:30:05.475 +00:00 [DBG] Client is configured to not require consent, no consent is required
2025-04-02 09:30:05.479 +00:00 [DBG] Creating Implicit Flow response.
2025-04-02 09:30:05.485 +00:00 [DBG] Getting claims for access token for client: wewantdoughnuts
2025-04-02 09:30:05.487 +00:00 [DBG] Getting claims for access token for subject: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 09:30:05.581 +00:00 [DBG] Getting claims for identity token for subject: 42006211-B900-4701-A6F8-2986370C3563 and client: wewantdoughnuts
2025-04-02 09:30:05.582 +00:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2025-04-02 09:30:05.593 +00:00 [INF] {"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","Endpoint":"Authorize","SubjectId":"42006211-B900-4701-A6F8-2986370C3563","Scopes":"openid profile email doughnutapi","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****GI_w","$type":"Token"},{"TokenType":"access_token","TokenValue":"****NQYw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HNBHP3FIDACH:00000007","TimeStamp":"2025-04-02T09:30:05.0000000Z","ProcessId":658,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"TokenIssuedSuccessEvent"}
2025-04-02 09:30:05.595 +00:00 [DBG] Authorize endpoint response
{"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ClientId":"wewantdoughnuts","RedirectUri":"http://localhost:3000/signin-oidc","State":"d4821722c5544e1bafc3c04ab82e27fd","Scope":"openid profile email doughnutapi","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2025-04-02 09:30:05.602 +00:00 [DBG] Augmenting SignInContext
2025-04-02 09:30:05.603 +00:00 [INF] AuthenticationScheme: idsrv signed in.
2025-04-02 09:30:06.431 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 09:30:06.432 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 09:30:06.433 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 09:30:06.436 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 09:30:06.446 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 09:30:06.449 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 09:30:06.451 +00:00 [DBG] Start discovery request
2025-04-02 09:30:06.505 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:3000
2025-04-02 09:30:06.506 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 09:30:06.507 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 09:30:06.508 +00:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2025-04-02 09:30:06.510 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2025-04-02 09:30:06.512 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2025-04-02 09:30:06.514 +00:00 [DBG] Start key discovery request
2025-04-02 09:30:06.565 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 09:30:06.566 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 09:30:06.567 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 09:30:06.602 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 09:30:06.602 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 09:30:06.602 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 09:30:06.603 +00:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2025-04-02 09:30:06.606 +00:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2025-04-02 09:30:06.608 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2025-04-02 09:30:06.612 +00:00 [DBG] Start userinfo request
2025-04-02 09:30:06.616 +00:00 [DBG] Bearer token found in header
2025-04-02 09:30:06.695 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 09:30:06.698 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 09:30:06.699 +00:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2025-04-02 09:30:06.701 +00:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":"0E7ADD0BA17C5679D8E2BB355D4594BD","Claims":{"nbf":1743586205,"exp":1743589805,"iss":"https://webapi:8081","aud":["doughnutapi","https://webapi:8081/resources"],"client_id":"wewantdoughnuts","sub":"42006211-B900-4701-A6F8-2986370C3563","auth_time":1743586205,"idp":"local","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress":"AliceSmith@email.com","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname":"Alice","jti":"0E7ADD0BA17C5679D8E2BB355D4594BD","sid":"E4B462430272C155F64393CD4B6C03C0","iat":1743586205,"scope":["openid","profile","email","doughnutapi"],"amr":"pwd"},"$type":"TokenValidationLog"}
2025-04-02 09:30:06.706 +00:00 [DBG] Creating userinfo response
2025-04-02 09:30:06.709 +00:00 [DBG] Scopes in access token: openid profile email doughnutapi
2025-04-02 09:30:06.713 +00:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2025-04-02 09:30:06.715 +00:00 [INF] Profile service returned the following claim types: email given_name
2025-04-02 09:30:06.717 +00:00 [DBG] End userinfo request
2025-04-02 09:30:06.812 +00:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2025-04-02 09:30:06.813 +00:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2025-04-02 09:30:06.814 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2025-04-02 09:30:06.815 +00:00 [DBG] Rendering check session result
2025-04-02 09:31:03.916 +00:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2025-04-02 09:31:03.920 +00:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2025-04-02 09:31:03.922 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2025-04-02 09:31:03.931 +00:00 [DBG] Processing signout request for 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 09:31:03.936 +00:00 [DBG] Start end session request validation
2025-04-02 09:31:03.941 +00:00 [INF] End session request validation success
{"ClientId":null,"ClientName":null,"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","PostLogOutUri":null,"State":null,"Raw":{"post_logout_redirect_uri":"http://localhost:3000/signout-oidc"},"$type":"EndSessionRequestValidationLog"}
2025-04-02 09:31:03.942 +00:00 [DBG] Success validating end session request from null
2025-04-02 09:31:06.407 +00:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2025-04-02 09:31:06.450 +00:00 [INF] AuthenticationScheme: idsrv signed out.
2025-04-02 09:31:06.451 +00:00 [INF] {"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","DisplayName":"alice","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HNBHP3FIDACH:0000001B","TimeStamp":"2025-04-02T09:31:06.0000000Z","ProcessId":658,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"UserLogoutSuccessEvent"}
2025-04-02 09:31:06.463 +00:00 [DBG] SignOutCalled set; processing post-signout session cleanup.
2025-04-02 09:31:06.467 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 09:31:06.468 +00:00 [DBG] No client back-channel logout URLs
2025-04-02 09:31:06.585 +00:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2025-04-02 09:31:06.589 +00:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2025-04-02 09:31:06.593 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2025-04-02 09:31:06.598 +00:00 [DBG] Processing signout callback request
2025-04-02 09:31:06.615 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 09:31:06.618 +00:00 [DBG] No client front-channel logout URLs
2025-04-02 09:31:06.620 +00:00 [INF] Successful signout callback.
2025-04-02 09:31:08.696 +00:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2025-04-02 09:31:08.699 +00:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2025-04-02 09:31:08.701 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2025-04-02 09:31:08.708 +00:00 [DBG] Processing signout callback request
2025-04-02 09:31:08.721 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 09:31:08.728 +00:00 [DBG] No client front-channel logout URLs
2025-04-02 09:31:08.729 +00:00 [INF] Successful signout callback.
2025-04-02 09:34:44.759 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 09:34:44.760 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 09:34:44.760 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 09:34:44.762 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 09:34:44.763 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 09:34:44.763 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 09:34:44.764 +00:00 [DBG] Start discovery request
2025-04-02 09:34:44.819 +00:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2025-04-02 09:34:44.820 +00:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2025-04-02 09:34:44.821 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2025-04-02 09:34:44.822 +00:00 [DBG] Start authorize request
2025-04-02 09:34:44.825 +00:00 [DBG] No user present in authorize request
2025-04-02 09:34:44.826 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 09:34:44.828 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 09:34:44.830 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 09:34:44.830 +00:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","AllowedRedirectUris":["http://localhost:3000/signin-oidc"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email doughnutapi","State":"3a518b9d636e4711bee9f04feca0cad9","UiLocales":null,"Nonce":"159f06f58e4a47778fb2a949d9f470dc","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"wewantdoughnuts","redirect_uri":"http://localhost:3000/signin-oidc","response_type":"id_token token","scope":"openid profile email doughnutapi","state":"3a518b9d636e4711bee9f04feca0cad9","nonce":"159f06f58e4a47778fb2a949d9f470dc"},"$type":"AuthorizeRequestValidationLog"}
2025-04-02 09:34:44.831 +00:00 [INF] Showing login: User is not authenticated
2025-04-02 09:34:44.911 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 09:34:44.912 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 09:34:44.912 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 09:34:44.913 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 09:34:46.136 +00:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2025-04-02 09:34:46.199 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 09:34:46.199 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 09:34:46.200 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 09:34:46.202 +00:00 [INF] {"Username":"alice","Provider":null,"ProviderUserId":null,"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","DisplayName":"alice","Endpoint":"UI","ClientId":"wewantdoughnuts","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HNBHP3FIDACH:00000043","TimeStamp":"2025-04-02T09:34:46.0000000Z","ProcessId":658,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"UserLoginSuccessEvent"}
2025-04-02 09:34:46.202 +00:00 [DBG] Augmenting SignInContext
2025-04-02 09:34:46.203 +00:00 [DBG] Adding idp claim with value: local
2025-04-02 09:34:46.204 +00:00 [DBG] Adding amr claim with value: pwd
2025-04-02 09:34:46.204 +00:00 [DBG] Adding auth_time claim with value: 1743586486
2025-04-02 09:34:46.206 +00:00 [INF] AuthenticationScheme: idsrv signed in.
2025-04-02 09:34:46.231 +00:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2025-04-02 09:34:46.232 +00:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2025-04-02 09:34:46.232 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2025-04-02 09:34:46.233 +00:00 [DBG] Start authorize callback request
2025-04-02 09:34:46.234 +00:00 [DBG] User in authorize request: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 09:34:46.235 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 09:34:46.236 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 09:34:46.237 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 09:34:46.238 +00:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","AllowedRedirectUris":["http://localhost:3000/signin-oidc"],"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email doughnutapi","State":"3a518b9d636e4711bee9f04feca0cad9","UiLocales":null,"Nonce":"159f06f58e4a47778fb2a949d9f470dc","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"93043AA3FB15952A2F77C61EEE7B2121","Raw":{"client_id":"wewantdoughnuts","redirect_uri":"http://localhost:3000/signin-oidc","response_type":"id_token token","scope":"openid profile email doughnutapi","state":"3a518b9d636e4711bee9f04feca0cad9","nonce":"159f06f58e4a47778fb2a949d9f470dc"},"$type":"AuthorizeRequestValidationLog"}
2025-04-02 09:34:46.239 +00:00 [DBG] Client is configured to not require consent, no consent is required
2025-04-02 09:34:46.241 +00:00 [DBG] Creating Implicit Flow response.
2025-04-02 09:34:46.242 +00:00 [DBG] Getting claims for access token for client: wewantdoughnuts
2025-04-02 09:34:46.243 +00:00 [DBG] Getting claims for access token for subject: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 09:34:46.249 +00:00 [DBG] Getting claims for identity token for subject: 42006211-B900-4701-A6F8-2986370C3563 and client: wewantdoughnuts
2025-04-02 09:34:46.249 +00:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2025-04-02 09:34:46.252 +00:00 [INF] {"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","Endpoint":"Authorize","SubjectId":"42006211-B900-4701-A6F8-2986370C3563","Scopes":"openid profile email doughnutapi","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****NM0A","$type":"Token"},{"TokenType":"access_token","TokenValue":"****rrew","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HNBHP3FIDACH:00000045","TimeStamp":"2025-04-02T09:34:46.0000000Z","ProcessId":658,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"TokenIssuedSuccessEvent"}
2025-04-02 09:34:46.253 +00:00 [DBG] Authorize endpoint response
{"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ClientId":"wewantdoughnuts","RedirectUri":"http://localhost:3000/signin-oidc","State":"3a518b9d636e4711bee9f04feca0cad9","Scope":"openid profile email doughnutapi","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2025-04-02 09:34:46.254 +00:00 [DBG] Augmenting SignInContext
2025-04-02 09:34:46.256 +00:00 [INF] AuthenticationScheme: idsrv signed in.
2025-04-02 09:34:46.700 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 09:34:46.701 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 09:34:46.703 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 09:34:46.705 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 09:34:46.709 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 09:34:46.710 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 09:34:46.711 +00:00 [DBG] Start discovery request
2025-04-02 09:34:46.734 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:3000
2025-04-02 09:34:46.735 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 09:34:46.735 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 09:34:46.737 +00:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2025-04-02 09:34:46.740 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2025-04-02 09:34:46.741 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2025-04-02 09:34:46.741 +00:00 [DBG] Start key discovery request
2025-04-02 09:34:46.771 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 09:34:46.772 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 09:34:46.772 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 09:34:46.783 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 09:34:46.784 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 09:34:46.785 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 09:34:46.786 +00:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2025-04-02 09:34:46.787 +00:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2025-04-02 09:34:46.788 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2025-04-02 09:34:46.790 +00:00 [DBG] Start userinfo request
2025-04-02 09:34:46.791 +00:00 [DBG] Bearer token found in header
2025-04-02 09:34:46.793 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 09:34:46.794 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 09:34:46.795 +00:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2025-04-02 09:34:46.797 +00:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":"DC767F5990EB6DBD204F5754BF4794F3","Claims":{"nbf":1743586486,"exp":1743590086,"iss":"https://webapi:8081","aud":["doughnutapi","https://webapi:8081/resources"],"client_id":"wewantdoughnuts","sub":"42006211-B900-4701-A6F8-2986370C3563","auth_time":1743586486,"idp":"local","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress":"AliceSmith@email.com","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname":"Alice","jti":"DC767F5990EB6DBD204F5754BF4794F3","sid":"93043AA3FB15952A2F77C61EEE7B2121","iat":1743586486,"scope":["openid","profile","email","doughnutapi"],"amr":"pwd"},"$type":"TokenValidationLog"}
2025-04-02 09:34:46.798 +00:00 [DBG] Creating userinfo response
2025-04-02 09:34:46.799 +00:00 [DBG] Scopes in access token: openid profile email doughnutapi
2025-04-02 09:34:46.799 +00:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2025-04-02 09:34:46.801 +00:00 [INF] Profile service returned the following claim types: email given_name
2025-04-02 09:34:46.801 +00:00 [DBG] End userinfo request
2025-04-02 09:34:46.892 +00:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2025-04-02 09:34:46.892 +00:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2025-04-02 09:34:46.893 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2025-04-02 09:34:46.894 +00:00 [DBG] Rendering check session result
2025-04-02 09:37:56.598 +00:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2025-04-02 09:37:56.599 +00:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2025-04-02 09:37:56.600 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2025-04-02 09:37:56.602 +00:00 [DBG] Processing signout request for 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 09:37:56.604 +00:00 [DBG] Start end session request validation
2025-04-02 09:37:56.610 +00:00 [INF] End session request validation success
{"ClientId":null,"ClientName":null,"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","PostLogOutUri":null,"State":null,"Raw":{"post_logout_redirect_uri":"http://localhost:3000/signout-oidc"},"$type":"EndSessionRequestValidationLog"}
2025-04-02 09:37:56.611 +00:00 [DBG] Success validating end session request from null
2025-04-02 09:37:58.142 +00:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2025-04-02 09:37:58.147 +00:00 [INF] AuthenticationScheme: idsrv signed out.
2025-04-02 09:37:58.148 +00:00 [INF] {"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","DisplayName":"alice","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HNBHP3FIDACH:00000059","TimeStamp":"2025-04-02T09:37:58.0000000Z","ProcessId":658,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"UserLogoutSuccessEvent"}
2025-04-02 09:37:58.150 +00:00 [DBG] SignOutCalled set; processing post-signout session cleanup.
2025-04-02 09:37:58.151 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 09:37:58.152 +00:00 [DBG] No client back-channel logout URLs
2025-04-02 09:37:58.276 +00:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2025-04-02 09:37:58.309 +00:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2025-04-02 09:37:58.310 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2025-04-02 09:37:58.312 +00:00 [DBG] Processing signout callback request
2025-04-02 09:37:58.320 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 09:37:58.321 +00:00 [DBG] No client front-channel logout URLs
2025-04-02 09:37:58.325 +00:00 [INF] Successful signout callback.
2025-04-02 09:37:59.306 +00:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2025-04-02 09:37:59.308 +00:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2025-04-02 09:37:59.309 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2025-04-02 09:37:59.312 +00:00 [DBG] Processing signout callback request
2025-04-02 09:37:59.324 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 09:37:59.325 +00:00 [DBG] No client front-channel logout URLs
2025-04-02 09:37:59.326 +00:00 [INF] Successful signout callback.
2025-04-02 09:38:02.869 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 09:38:02.869 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 09:38:02.870 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 09:38:02.871 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 09:38:02.872 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 09:38:02.873 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 09:38:02.876 +00:00 [DBG] Start discovery request
2025-04-02 09:38:02.933 +00:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2025-04-02 09:38:02.939 +00:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2025-04-02 09:38:02.940 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2025-04-02 09:38:02.940 +00:00 [DBG] Start authorize request
2025-04-02 09:38:02.941 +00:00 [DBG] No user present in authorize request
2025-04-02 09:38:02.942 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 09:38:02.946 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 09:38:02.947 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 09:38:02.948 +00:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","AllowedRedirectUris":["http://localhost:3000/signin-oidc"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email doughnutapi","State":"eba762ffcd514cae9d32a7312b9cca4b","UiLocales":null,"Nonce":"52c264cc37b846739ce45bf4fc83f083","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"wewantdoughnuts","redirect_uri":"http://localhost:3000/signin-oidc","response_type":"id_token token","scope":"openid profile email doughnutapi","state":"eba762ffcd514cae9d32a7312b9cca4b","nonce":"52c264cc37b846739ce45bf4fc83f083"},"$type":"AuthorizeRequestValidationLog"}
2025-04-02 09:38:02.950 +00:00 [INF] Showing login: User is not authenticated
2025-04-02 09:38:02.970 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 09:38:02.971 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 09:38:02.972 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 09:38:02.972 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 09:38:06.580 +00:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2025-04-02 09:38:06.630 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 09:38:06.631 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 09:38:06.631 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 09:38:06.632 +00:00 [INF] {"Username":"alice","Provider":null,"ProviderUserId":null,"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","DisplayName":"alice","Endpoint":"UI","ClientId":"wewantdoughnuts","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HNBHP3FIDACH:0000008F","TimeStamp":"2025-04-02T09:38:06.0000000Z","ProcessId":658,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"UserLoginSuccessEvent"}
2025-04-02 09:38:06.633 +00:00 [DBG] Augmenting SignInContext
2025-04-02 09:38:06.634 +00:00 [DBG] Adding idp claim with value: local
2025-04-02 09:38:06.635 +00:00 [DBG] Adding amr claim with value: pwd
2025-04-02 09:38:06.636 +00:00 [DBG] Adding auth_time claim with value: 1743586686
2025-04-02 09:38:06.638 +00:00 [INF] AuthenticationScheme: idsrv signed in.
2025-04-02 09:38:06.665 +00:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2025-04-02 09:38:06.671 +00:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2025-04-02 09:38:06.671 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2025-04-02 09:38:06.672 +00:00 [DBG] Start authorize callback request
2025-04-02 09:38:06.672 +00:00 [DBG] User in authorize request: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 09:38:06.673 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 09:38:06.674 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 09:38:06.678 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 09:38:06.679 +00:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","AllowedRedirectUris":["http://localhost:3000/signin-oidc"],"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email doughnutapi","State":"eba762ffcd514cae9d32a7312b9cca4b","UiLocales":null,"Nonce":"52c264cc37b846739ce45bf4fc83f083","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"2F0F5B99061D4BFDA6235138B1EC85CA","Raw":{"client_id":"wewantdoughnuts","redirect_uri":"http://localhost:3000/signin-oidc","response_type":"id_token token","scope":"openid profile email doughnutapi","state":"eba762ffcd514cae9d32a7312b9cca4b","nonce":"52c264cc37b846739ce45bf4fc83f083"},"$type":"AuthorizeRequestValidationLog"}
2025-04-02 09:38:06.680 +00:00 [DBG] Client is configured to not require consent, no consent is required
2025-04-02 09:38:06.681 +00:00 [DBG] Creating Implicit Flow response.
2025-04-02 09:38:06.682 +00:00 [DBG] Getting claims for access token for client: wewantdoughnuts
2025-04-02 09:38:06.685 +00:00 [DBG] Getting claims for access token for subject: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 09:38:06.688 +00:00 [DBG] Getting claims for identity token for subject: 42006211-B900-4701-A6F8-2986370C3563 and client: wewantdoughnuts
2025-04-02 09:38:06.688 +00:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2025-04-02 09:38:06.693 +00:00 [INF] {"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","Endpoint":"Authorize","SubjectId":"42006211-B900-4701-A6F8-2986370C3563","Scopes":"openid profile email doughnutapi","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****03Xw","$type":"Token"},{"TokenType":"access_token","TokenValue":"****ezPA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HNBHP3FIDACH:00000091","TimeStamp":"2025-04-02T09:38:06.0000000Z","ProcessId":658,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"TokenIssuedSuccessEvent"}
2025-04-02 09:38:06.694 +00:00 [DBG] Authorize endpoint response
{"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ClientId":"wewantdoughnuts","RedirectUri":"http://localhost:3000/signin-oidc","State":"eba762ffcd514cae9d32a7312b9cca4b","Scope":"openid profile email doughnutapi","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2025-04-02 09:38:06.696 +00:00 [DBG] Augmenting SignInContext
2025-04-02 09:38:06.698 +00:00 [INF] AuthenticationScheme: idsrv signed in.
2025-04-02 09:38:07.521 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 09:38:07.523 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 09:38:07.534 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 09:38:07.538 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 09:38:07.539 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 09:38:07.543 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 09:38:07.543 +00:00 [DBG] Start discovery request
2025-04-02 09:38:07.575 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:3000
2025-04-02 09:38:07.577 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 09:38:07.577 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 09:38:07.578 +00:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2025-04-02 09:38:07.578 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2025-04-02 09:38:07.579 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2025-04-02 09:38:07.580 +00:00 [DBG] Start key discovery request
2025-04-02 09:38:07.634 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 09:38:07.636 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 09:38:07.636 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 09:38:07.650 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 09:38:07.651 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 09:38:07.651 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 09:38:07.652 +00:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2025-04-02 09:38:07.656 +00:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2025-04-02 09:38:07.657 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2025-04-02 09:38:07.659 +00:00 [DBG] Start userinfo request
2025-04-02 09:38:07.660 +00:00 [DBG] Bearer token found in header
2025-04-02 09:38:07.664 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 09:38:07.669 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 09:38:07.670 +00:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2025-04-02 09:38:07.671 +00:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":"A7F97A231350012FD20A653ED7EDE417","Claims":{"nbf":1743586686,"exp":1743590286,"iss":"https://webapi:8081","aud":["doughnutapi","https://webapi:8081/resources"],"client_id":"wewantdoughnuts","sub":"42006211-B900-4701-A6F8-2986370C3563","auth_time":1743586686,"idp":"local","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress":"AliceSmith@email.com","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname":"Alice","jti":"A7F97A231350012FD20A653ED7EDE417","sid":"2F0F5B99061D4BFDA6235138B1EC85CA","iat":1743586686,"scope":["openid","profile","email","doughnutapi"],"amr":"pwd"},"$type":"TokenValidationLog"}
2025-04-02 09:38:07.673 +00:00 [DBG] Creating userinfo response
2025-04-02 09:38:07.675 +00:00 [DBG] Scopes in access token: openid profile email doughnutapi
2025-04-02 09:38:07.676 +00:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2025-04-02 09:38:07.677 +00:00 [INF] Profile service returned the following claim types: email given_name
2025-04-02 09:38:07.678 +00:00 [DBG] End userinfo request
2025-04-02 09:38:07.737 +00:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2025-04-02 09:38:07.738 +00:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2025-04-02 09:38:07.738 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2025-04-02 09:38:07.739 +00:00 [DBG] Rendering check session result
2025-04-02 09:41:32.968 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 09:41:32.990 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 09:41:32.990 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 09:41:32.991 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 09:41:32.991 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 09:41:32.993 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 09:41:32.994 +00:00 [DBG] Start discovery request
2025-04-02 09:41:33.028 +00:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2025-04-02 09:41:33.028 +00:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2025-04-02 09:41:33.029 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2025-04-02 09:41:33.030 +00:00 [DBG] Start authorize request
2025-04-02 09:41:33.032 +00:00 [DBG] User in authorize request: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 09:41:33.033 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 09:41:33.035 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 09:41:33.037 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 09:41:33.039 +00:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","AllowedRedirectUris":["http://localhost:3000/signin-oidc"],"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email doughnutapi","State":"05f840457c474c989aff6d8db8d0cc9a","UiLocales":null,"Nonce":"c5596c2360ea487daef973fd15636ec2","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"2F0F5B99061D4BFDA6235138B1EC85CA","Raw":{"client_id":"wewantdoughnuts","redirect_uri":"http://localhost:3000/signin-oidc","response_type":"id_token token","scope":"openid profile email doughnutapi","state":"05f840457c474c989aff6d8db8d0cc9a","nonce":"c5596c2360ea487daef973fd15636ec2"},"$type":"AuthorizeRequestValidationLog"}
2025-04-02 09:41:33.043 +00:00 [DBG] Client is configured to not require consent, no consent is required
2025-04-02 09:41:33.044 +00:00 [DBG] Creating Implicit Flow response.
2025-04-02 09:41:33.046 +00:00 [DBG] Getting claims for access token for client: wewantdoughnuts
2025-04-02 09:41:33.047 +00:00 [DBG] Getting claims for access token for subject: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 09:41:33.051 +00:00 [DBG] Getting claims for identity token for subject: 42006211-B900-4701-A6F8-2986370C3563 and client: wewantdoughnuts
2025-04-02 09:41:33.051 +00:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2025-04-02 09:41:33.054 +00:00 [INF] {"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","Endpoint":"Authorize","SubjectId":"42006211-B900-4701-A6F8-2986370C3563","Scopes":"openid profile email doughnutapi","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****U6qg","$type":"Token"},{"TokenType":"access_token","TokenValue":"****3UbQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HNBHP3FIDACH:00000093","TimeStamp":"2025-04-02T09:41:33.0000000Z","ProcessId":658,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"TokenIssuedSuccessEvent"}
2025-04-02 09:41:33.054 +00:00 [DBG] Authorize endpoint response
{"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ClientId":"wewantdoughnuts","RedirectUri":"http://localhost:3000/signin-oidc","State":"05f840457c474c989aff6d8db8d0cc9a","Scope":"openid profile email doughnutapi","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2025-04-02 09:41:33.858 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 09:41:33.862 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 09:41:33.865 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 09:41:33.883 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 09:41:33.885 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 09:41:33.890 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 09:41:33.899 +00:00 [DBG] Start discovery request
2025-04-02 09:41:33.938 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:3000
2025-04-02 09:41:33.939 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 09:41:33.940 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 09:41:33.943 +00:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2025-04-02 09:41:33.947 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2025-04-02 09:41:33.950 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2025-04-02 09:41:33.951 +00:00 [DBG] Start key discovery request
2025-04-02 09:41:33.979 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 09:41:33.979 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 09:41:33.980 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 09:41:34.012 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 09:41:34.013 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 09:41:34.013 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 09:41:34.014 +00:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2025-04-02 09:41:34.015 +00:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2025-04-02 09:41:34.017 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2025-04-02 09:41:34.018 +00:00 [DBG] Start userinfo request
2025-04-02 09:41:34.019 +00:00 [DBG] Bearer token found in header
2025-04-02 09:41:34.022 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 09:41:34.023 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 09:41:34.024 +00:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2025-04-02 09:41:34.027 +00:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":"4A0ABD74CA598F10167004BFAAD1CD3C","Claims":{"nbf":1743586893,"exp":1743590493,"iss":"https://webapi:8081","aud":["doughnutapi","https://webapi:8081/resources"],"client_id":"wewantdoughnuts","sub":"42006211-B900-4701-A6F8-2986370C3563","auth_time":1743586686,"idp":"local","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress":"AliceSmith@email.com","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname":"Alice","jti":"4A0ABD74CA598F10167004BFAAD1CD3C","sid":"2F0F5B99061D4BFDA6235138B1EC85CA","iat":1743586893,"scope":["openid","profile","email","doughnutapi"],"amr":"pwd"},"$type":"TokenValidationLog"}
2025-04-02 09:41:34.028 +00:00 [DBG] Creating userinfo response
2025-04-02 09:41:34.029 +00:00 [DBG] Scopes in access token: openid profile email doughnutapi
2025-04-02 09:41:34.030 +00:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2025-04-02 09:41:34.031 +00:00 [INF] Profile service returned the following claim types: email given_name
2025-04-02 09:41:34.033 +00:00 [DBG] End userinfo request
2025-04-02 09:41:34.144 +00:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2025-04-02 09:41:34.146 +00:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2025-04-02 09:41:34.148 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2025-04-02 09:41:34.149 +00:00 [DBG] Rendering check session result
2025-04-02 09:42:08.253 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 09:42:08.253 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 09:42:08.254 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 09:42:08.254 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 09:42:08.256 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 09:42:08.257 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 09:42:08.258 +00:00 [DBG] Start discovery request
2025-04-02 09:42:08.295 +00:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2025-04-02 09:42:08.296 +00:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2025-04-02 09:42:08.297 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2025-04-02 09:42:08.298 +00:00 [DBG] Start authorize request
2025-04-02 09:42:08.299 +00:00 [DBG] User in authorize request: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 09:42:08.301 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 09:42:08.302 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 09:42:08.303 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 09:42:08.305 +00:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","AllowedRedirectUris":["http://localhost:3000/signin-oidc"],"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email doughnutapi","State":"142a2f0fda90409fbc5a401b25de56c5","UiLocales":null,"Nonce":"35f5a81cca364b88a72bc62dd619b39d","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"2F0F5B99061D4BFDA6235138B1EC85CA","Raw":{"client_id":"wewantdoughnuts","redirect_uri":"http://localhost:3000/signin-oidc","response_type":"id_token token","scope":"openid profile email doughnutapi","state":"142a2f0fda90409fbc5a401b25de56c5","nonce":"35f5a81cca364b88a72bc62dd619b39d"},"$type":"AuthorizeRequestValidationLog"}
2025-04-02 09:42:08.309 +00:00 [DBG] Client is configured to not require consent, no consent is required
2025-04-02 09:42:08.314 +00:00 [DBG] Creating Implicit Flow response.
2025-04-02 09:42:08.315 +00:00 [DBG] Getting claims for access token for client: wewantdoughnuts
2025-04-02 09:42:08.316 +00:00 [DBG] Getting claims for access token for subject: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 09:42:08.320 +00:00 [DBG] Getting claims for identity token for subject: 42006211-B900-4701-A6F8-2986370C3563 and client: wewantdoughnuts
2025-04-02 09:42:08.321 +00:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2025-04-02 09:42:08.325 +00:00 [INF] {"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","Endpoint":"Authorize","SubjectId":"42006211-B900-4701-A6F8-2986370C3563","Scopes":"openid profile email doughnutapi","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****pyow","$type":"Token"},{"TokenType":"access_token","TokenValue":"****l5RQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HNBHP3FIDACH:00000095","TimeStamp":"2025-04-02T09:42:08.0000000Z","ProcessId":658,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"TokenIssuedSuccessEvent"}
2025-04-02 09:42:08.326 +00:00 [DBG] Authorize endpoint response
{"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ClientId":"wewantdoughnuts","RedirectUri":"http://localhost:3000/signin-oidc","State":"142a2f0fda90409fbc5a401b25de56c5","Scope":"openid profile email doughnutapi","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2025-04-02 09:42:08.637 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 09:42:08.648 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 09:42:08.653 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 09:42:08.659 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 09:42:08.670 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 09:42:08.672 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 09:42:08.674 +00:00 [DBG] Start discovery request
2025-04-02 09:42:08.696 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:3000
2025-04-02 09:42:08.697 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 09:42:08.701 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 09:42:08.703 +00:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2025-04-02 09:42:08.706 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2025-04-02 09:42:08.709 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2025-04-02 09:42:08.714 +00:00 [DBG] Start key discovery request
2025-04-02 09:42:08.748 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 09:42:08.749 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 09:42:08.751 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 09:42:08.769 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 09:42:08.770 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 09:42:08.770 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 09:42:08.771 +00:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2025-04-02 09:42:08.772 +00:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2025-04-02 09:42:08.774 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2025-04-02 09:42:08.775 +00:00 [DBG] Start userinfo request
2025-04-02 09:42:08.777 +00:00 [DBG] Bearer token found in header
2025-04-02 09:42:08.780 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 09:42:08.781 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 09:42:08.783 +00:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2025-04-02 09:42:08.785 +00:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":"841DA2BC7D51A6DDEFB39FEC1371C771","Claims":{"nbf":1743586928,"exp":1743590528,"iss":"https://webapi:8081","aud":["doughnutapi","https://webapi:8081/resources"],"client_id":"wewantdoughnuts","sub":"42006211-B900-4701-A6F8-2986370C3563","auth_time":1743586686,"idp":"local","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress":"AliceSmith@email.com","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname":"Alice","jti":"841DA2BC7D51A6DDEFB39FEC1371C771","sid":"2F0F5B99061D4BFDA6235138B1EC85CA","iat":1743586928,"scope":["openid","profile","email","doughnutapi"],"amr":"pwd"},"$type":"TokenValidationLog"}
2025-04-02 09:42:08.787 +00:00 [DBG] Creating userinfo response
2025-04-02 09:42:08.788 +00:00 [DBG] Scopes in access token: openid profile email doughnutapi
2025-04-02 09:42:08.789 +00:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2025-04-02 09:42:08.790 +00:00 [INF] Profile service returned the following claim types: email given_name
2025-04-02 09:42:08.791 +00:00 [DBG] End userinfo request
2025-04-02 09:42:08.857 +00:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2025-04-02 09:42:08.866 +00:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2025-04-02 09:42:08.874 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2025-04-02 09:42:08.881 +00:00 [DBG] Rendering check session result
2025-04-02 09:47:50.486 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 09:47:50.486 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 09:47:50.487 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 09:47:50.487 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 09:47:50.488 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 09:47:50.489 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 09:47:50.489 +00:00 [DBG] Start discovery request
2025-04-02 09:47:50.522 +00:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2025-04-02 09:47:50.522 +00:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2025-04-02 09:47:50.523 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2025-04-02 09:47:50.524 +00:00 [DBG] Start authorize request
2025-04-02 09:47:50.525 +00:00 [DBG] User in authorize request: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 09:47:50.527 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 09:47:50.528 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 09:47:50.531 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 09:47:50.531 +00:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","AllowedRedirectUris":["http://localhost:3000/signin-oidc"],"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email doughnutapi","State":"efd509f9fa2e46d88c23b4d7368e47bf","UiLocales":null,"Nonce":"c8cef03ed8a14b53b2ae96758f9d0670","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"2F0F5B99061D4BFDA6235138B1EC85CA","Raw":{"client_id":"wewantdoughnuts","redirect_uri":"http://localhost:3000/signin-oidc","response_type":"id_token token","scope":"openid profile email doughnutapi","state":"efd509f9fa2e46d88c23b4d7368e47bf","nonce":"c8cef03ed8a14b53b2ae96758f9d0670"},"$type":"AuthorizeRequestValidationLog"}
2025-04-02 09:47:50.532 +00:00 [DBG] Client is configured to not require consent, no consent is required
2025-04-02 09:47:50.534 +00:00 [DBG] Creating Implicit Flow response.
2025-04-02 09:47:50.535 +00:00 [DBG] Getting claims for access token for client: wewantdoughnuts
2025-04-02 09:47:50.536 +00:00 [DBG] Getting claims for access token for subject: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 09:47:50.539 +00:00 [DBG] Getting claims for identity token for subject: 42006211-B900-4701-A6F8-2986370C3563 and client: wewantdoughnuts
2025-04-02 09:47:50.539 +00:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2025-04-02 09:47:50.541 +00:00 [INF] {"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","Endpoint":"Authorize","SubjectId":"42006211-B900-4701-A6F8-2986370C3563","Scopes":"openid profile email doughnutapi","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****wwtw","$type":"Token"},{"TokenType":"access_token","TokenValue":"****L1QA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HNBHP3FIDACH:00000097","TimeStamp":"2025-04-02T09:47:50.0000000Z","ProcessId":658,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"TokenIssuedSuccessEvent"}
2025-04-02 09:47:50.542 +00:00 [DBG] Authorize endpoint response
{"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ClientId":"wewantdoughnuts","RedirectUri":"http://localhost:3000/signin-oidc","State":"efd509f9fa2e46d88c23b4d7368e47bf","Scope":"openid profile email doughnutapi","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2025-04-02 09:47:50.866 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 09:47:50.868 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 09:47:50.869 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 09:47:50.870 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 09:47:50.873 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 09:47:50.877 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 09:47:50.885 +00:00 [DBG] Start discovery request
2025-04-02 09:47:50.902 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:3000
2025-04-02 09:47:50.904 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 09:47:50.906 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 09:47:50.913 +00:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2025-04-02 09:47:50.925 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2025-04-02 09:47:50.927 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2025-04-02 09:47:50.928 +00:00 [DBG] Start key discovery request
2025-04-02 09:47:50.983 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 09:47:50.984 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 09:47:50.984 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 09:47:50.995 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 09:47:50.997 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 09:47:50.998 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 09:47:50.999 +00:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2025-04-02 09:47:51.000 +00:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2025-04-02 09:47:51.001 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2025-04-02 09:47:51.002 +00:00 [DBG] Start userinfo request
2025-04-02 09:47:51.003 +00:00 [DBG] Bearer token found in header
2025-04-02 09:47:51.005 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 09:47:51.005 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 09:47:51.005 +00:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2025-04-02 09:47:51.006 +00:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":"C0066012E70AA270A1DD2E70714A82C5","Claims":{"nbf":1743587270,"exp":1743590870,"iss":"https://webapi:8081","aud":["doughnutapi","https://webapi:8081/resources"],"client_id":"wewantdoughnuts","sub":"42006211-B900-4701-A6F8-2986370C3563","auth_time":1743586686,"idp":"local","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress":"AliceSmith@email.com","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname":"Alice","jti":"C0066012E70AA270A1DD2E70714A82C5","sid":"2F0F5B99061D4BFDA6235138B1EC85CA","iat":1743587270,"scope":["openid","profile","email","doughnutapi"],"amr":"pwd"},"$type":"TokenValidationLog"}
2025-04-02 09:47:51.007 +00:00 [DBG] Creating userinfo response
2025-04-02 09:47:51.009 +00:00 [DBG] Scopes in access token: openid profile email doughnutapi
2025-04-02 09:47:51.010 +00:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2025-04-02 09:47:51.010 +00:00 [INF] Profile service returned the following claim types: email given_name
2025-04-02 09:47:51.015 +00:00 [DBG] End userinfo request
2025-04-02 09:47:51.111 +00:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2025-04-02 09:47:51.113 +00:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2025-04-02 09:47:51.115 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2025-04-02 09:47:51.116 +00:00 [DBG] Rendering check session result
2025-04-02 09:52:48.447 +00:00 [INF] Starting IdentityServer4 version 4.1.1+cebd52f5bc61bdefc262fd20739d4d087c6f961f
2025-04-02 09:52:48.494 +00:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2025-04-02 09:52:48.495 +00:00 [DBG] Custom IssuerUri set to https://webapi:8081
2025-04-02 09:52:48.507 +00:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2025-04-02 09:52:48.508 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2025-04-02 09:52:48.508 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2025-04-02 09:52:48.509 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2025-04-02 09:52:48.510 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2025-04-02 09:52:48.510 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2025-04-02 09:52:48.719 +00:00 [WRN] Using an in-memory repository. Keys will not be persisted to storage.
2025-04-02 09:52:48.720 +00:00 [WRN] Neither user profile nor HKLM registry available. Using an ephemeral key repository. Protected data will be unavailable when application exits.
2025-04-02 09:52:48.743 +00:00 [WRN] No XML encryptor configured. Key "c7921a9c-0ad3-4ec8-ba1f-0b2f5e6a8be6" may be persisted to storage in unencrypted form.
2025-04-02 09:53:02.994 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 09:53:03.002 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 09:53:03.003 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 09:53:03.023 +00:00 [DBG] Login Url: /Account/Login
2025-04-02 09:53:03.023 +00:00 [DBG] Login Return Url Parameter: ReturnUrl
2025-04-02 09:53:03.024 +00:00 [DBG] Logout Url: /Account/Logout
2025-04-02 09:53:03.025 +00:00 [DBG] ConsentUrl Url: /consent
2025-04-02 09:53:03.026 +00:00 [DBG] Consent Return Url Parameter: returnUrl
2025-04-02 09:53:03.026 +00:00 [DBG] Error Url: /home/error
2025-04-02 09:53:03.027 +00:00 [DBG] Error Id Parameter: errorId
2025-04-02 09:53:03.043 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 09:53:03.047 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 09:53:03.047 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 09:53:03.050 +00:00 [DBG] Start discovery request
2025-04-02 09:53:03.167 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 09:53:03.168 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 09:53:03.174 +00:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2025-04-02 09:53:03.194 +00:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2025-04-02 09:53:03.195 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2025-04-02 09:53:03.205 +00:00 [DBG] Start authorize request
2025-04-02 09:53:03.235 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 09:53:03.238 +00:00 [DBG] No user present in authorize request
2025-04-02 09:53:03.241 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 09:53:03.253 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 09:53:03.280 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 09:53:03.293 +00:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","AllowedRedirectUris":["http://localhost:3000/signin-oidc"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email doughnutapi","State":"0d697dc4846b41e6a86c35191d130f0a","UiLocales":null,"Nonce":"cc527d47fd0e416e995744099387d349","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"wewantdoughnuts","redirect_uri":"http://localhost:3000/signin-oidc","response_type":"id_token token","scope":"openid profile email doughnutapi","state":"0d697dc4846b41e6a86c35191d130f0a","nonce":"cc527d47fd0e416e995744099387d349"},"$type":"AuthorizeRequestValidationLog"}
2025-04-02 09:53:03.307 +00:00 [INF] Showing login: User is not authenticated
2025-04-02 09:53:03.337 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 09:53:03.341 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 09:53:03.388 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 09:53:03.389 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 09:53:03.389 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 09:53:03.391 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 09:53:03.396 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 09:53:05.014 +00:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2025-04-02 09:53:05.019 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 09:53:05.020 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 09:53:05.058 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 09:53:05.058 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 09:53:05.059 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 09:53:05.063 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 09:53:05.081 +00:00 [INF] {"Username":"alice","Provider":null,"ProviderUserId":null,"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","DisplayName":"alice","Endpoint":"UI","ClientId":"wewantdoughnuts","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HNBHPGKD5RK9:0000000F","TimeStamp":"2025-04-02T09:53:05.0000000Z","ProcessId":898,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"UserLoginSuccessEvent"}
2025-04-02 09:53:05.089 +00:00 [DBG] Augmenting SignInContext
2025-04-02 09:53:05.091 +00:00 [DBG] Adding idp claim with value: local
2025-04-02 09:53:05.092 +00:00 [DBG] Adding amr claim with value: pwd
2025-04-02 09:53:05.092 +00:00 [DBG] Adding auth_time claim with value: 1743587585
2025-04-02 09:53:05.095 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 09:53:05.107 +00:00 [INF] AuthenticationScheme: idsrv signed in.
2025-04-02 09:53:05.130 +00:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2025-04-02 09:53:05.133 +00:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2025-04-02 09:53:05.134 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2025-04-02 09:53:05.139 +00:00 [DBG] Start authorize callback request
2025-04-02 09:53:05.155 +00:00 [DBG] User in authorize request: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 09:53:05.155 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 09:53:05.156 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 09:53:05.157 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 09:53:05.161 +00:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","AllowedRedirectUris":["http://localhost:3000/signin-oidc"],"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email doughnutapi","State":"0d697dc4846b41e6a86c35191d130f0a","UiLocales":null,"Nonce":"cc527d47fd0e416e995744099387d349","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"4E6C1E04816C8659E3C7B5B7C8E5D842","Raw":{"client_id":"wewantdoughnuts","redirect_uri":"http://localhost:3000/signin-oidc","response_type":"id_token token","scope":"openid profile email doughnutapi","state":"0d697dc4846b41e6a86c35191d130f0a","nonce":"cc527d47fd0e416e995744099387d349"},"$type":"AuthorizeRequestValidationLog"}
2025-04-02 09:53:05.169 +00:00 [DBG] Client is configured to not require consent, no consent is required
2025-04-02 09:53:05.173 +00:00 [DBG] Creating Implicit Flow response.
2025-04-02 09:53:05.186 +00:00 [DBG] Getting claims for access token for client: wewantdoughnuts
2025-04-02 09:53:05.187 +00:00 [DBG] Getting claims for access token for subject: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 09:53:05.274 +00:00 [DBG] Getting claims for identity token for subject: 42006211-B900-4701-A6F8-2986370C3563 and client: wewantdoughnuts
2025-04-02 09:53:05.274 +00:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2025-04-02 09:53:05.283 +00:00 [INF] {"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","Endpoint":"Authorize","SubjectId":"42006211-B900-4701-A6F8-2986370C3563","Scopes":"openid profile email doughnutapi","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****6Dtw","$type":"Token"},{"TokenType":"access_token","TokenValue":"****XnTQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HNBHPGKD5RK9:00000011","TimeStamp":"2025-04-02T09:53:05.0000000Z","ProcessId":898,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"TokenIssuedSuccessEvent"}
2025-04-02 09:53:05.285 +00:00 [DBG] Authorize endpoint response
{"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ClientId":"wewantdoughnuts","RedirectUri":"http://localhost:3000/signin-oidc","State":"0d697dc4846b41e6a86c35191d130f0a","Scope":"openid profile email doughnutapi","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2025-04-02 09:53:05.291 +00:00 [DBG] Augmenting SignInContext
2025-04-02 09:53:05.293 +00:00 [INF] AuthenticationScheme: idsrv signed in.
2025-04-02 09:53:05.711 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 09:53:05.712 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 09:53:05.713 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 09:53:05.715 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 09:53:05.720 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 09:53:05.722 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 09:53:05.724 +00:00 [DBG] Start discovery request
2025-04-02 09:53:05.766 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:3000
2025-04-02 09:53:05.768 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 09:53:05.768 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 09:53:05.770 +00:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2025-04-02 09:53:05.771 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2025-04-02 09:53:05.772 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2025-04-02 09:53:05.775 +00:00 [DBG] Start key discovery request
2025-04-02 09:53:05.837 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 09:53:05.838 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 09:53:05.838 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 09:53:05.870 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 09:53:05.870 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 09:53:05.871 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 09:53:05.872 +00:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2025-04-02 09:53:05.876 +00:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2025-04-02 09:53:05.877 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2025-04-02 09:53:05.881 +00:00 [DBG] Start userinfo request
2025-04-02 09:53:05.886 +00:00 [DBG] Bearer token found in header
2025-04-02 09:53:05.954 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 09:53:05.960 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 09:53:05.961 +00:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2025-04-02 09:53:05.963 +00:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":"3F9FCDD3806FA35BC396ABFA0B8AD547","Claims":{"nbf":1743587585,"exp":1743591185,"iss":"https://webapi:8081","aud":["doughnutapi","https://webapi:8081/resources"],"client_id":"wewantdoughnuts","sub":"42006211-B900-4701-A6F8-2986370C3563","auth_time":1743587585,"idp":"local","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress":"AliceSmith@email.com","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname":"Alice","jti":"3F9FCDD3806FA35BC396ABFA0B8AD547","sid":"4E6C1E04816C8659E3C7B5B7C8E5D842","iat":1743587585,"scope":["openid","profile","email","doughnutapi"],"amr":"pwd"},"$type":"TokenValidationLog"}
2025-04-02 09:53:05.967 +00:00 [DBG] Creating userinfo response
2025-04-02 09:53:05.970 +00:00 [DBG] Scopes in access token: openid profile email doughnutapi
2025-04-02 09:53:05.974 +00:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2025-04-02 09:53:05.974 +00:00 [INF] Profile service returned the following claim types: email given_name
2025-04-02 09:53:05.975 +00:00 [DBG] End userinfo request
2025-04-02 09:53:06.045 +00:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2025-04-02 09:53:06.046 +00:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2025-04-02 09:53:06.046 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2025-04-02 09:53:06.048 +00:00 [DBG] Rendering check session result
2025-04-02 09:54:10.979 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 09:54:10.982 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 09:54:10.982 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 09:54:10.983 +00:00 [DBG] Start discovery request
2025-04-02 09:54:11.014 +00:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2025-04-02 09:54:11.015 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2025-04-02 09:54:11.016 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2025-04-02 09:54:11.018 +00:00 [DBG] Start key discovery request
2025-04-02 10:04:41.534 +00:00 [INF] Starting IdentityServer4 version 4.1.1+cebd52f5bc61bdefc262fd20739d4d087c6f961f
2025-04-02 10:04:41.574 +00:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2025-04-02 10:04:41.576 +00:00 [DBG] Custom IssuerUri set to https://webapi:8081
2025-04-02 10:04:41.590 +00:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2025-04-02 10:04:41.590 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2025-04-02 10:04:41.591 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2025-04-02 10:04:41.591 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2025-04-02 10:04:41.592 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2025-04-02 10:04:41.592 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2025-04-02 10:04:41.794 +00:00 [WRN] Using an in-memory repository. Keys will not be persisted to storage.
2025-04-02 10:04:41.794 +00:00 [WRN] Neither user profile nor HKLM registry available. Using an ephemeral key repository. Protected data will be unavailable when application exits.
2025-04-02 10:04:41.814 +00:00 [WRN] No XML encryptor configured. Key "13a85ad6-30bb-4069-a5bb-15d65f39a749" may be persisted to storage in unencrypted form.
2025-04-02 10:04:58.623 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 10:04:58.631 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 10:04:58.632 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 10:04:58.652 +00:00 [DBG] Login Url: /Account/Login
2025-04-02 10:04:58.653 +00:00 [DBG] Login Return Url Parameter: ReturnUrl
2025-04-02 10:04:58.654 +00:00 [DBG] Logout Url: /Account/Logout
2025-04-02 10:04:58.655 +00:00 [DBG] ConsentUrl Url: /consent
2025-04-02 10:04:58.656 +00:00 [DBG] Consent Return Url Parameter: returnUrl
2025-04-02 10:04:58.657 +00:00 [DBG] Error Url: /home/error
2025-04-02 10:04:58.658 +00:00 [DBG] Error Id Parameter: errorId
2025-04-02 10:04:58.672 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 10:04:58.676 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 10:04:58.677 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 10:04:58.679 +00:00 [DBG] Start discovery request
2025-04-02 10:04:58.797 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 10:04:58.798 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 10:04:58.806 +00:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2025-04-02 10:04:58.832 +00:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2025-04-02 10:04:58.833 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2025-04-02 10:04:58.843 +00:00 [DBG] Start authorize request
2025-04-02 10:04:58.872 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 10:04:58.876 +00:00 [DBG] No user present in authorize request
2025-04-02 10:04:58.879 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 10:04:58.893 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:04:58.923 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 10:04:58.935 +00:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","AllowedRedirectUris":["http://localhost:3000/signin-oidc"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email doughnutapi","State":"7c0843fa90fc4cad9bca5b6e97a29280","UiLocales":null,"Nonce":"5d2fcebeea4f4ec0bc35f55ef6f308f2","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"wewantdoughnuts","redirect_uri":"http://localhost:3000/signin-oidc","response_type":"id_token token","scope":"openid profile email doughnutapi","state":"7c0843fa90fc4cad9bca5b6e97a29280","nonce":"5d2fcebeea4f4ec0bc35f55ef6f308f2"},"$type":"AuthorizeRequestValidationLog"}
2025-04-02 10:04:58.949 +00:00 [INF] Showing login: User is not authenticated
2025-04-02 10:04:58.979 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 10:04:58.982 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 10:04:59.037 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 10:04:59.038 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 10:04:59.039 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:04:59.040 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 10:04:59.045 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:05:00.455 +00:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2025-04-02 10:05:00.458 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 10:05:00.459 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 10:05:00.497 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 10:05:00.498 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 10:05:00.499 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:05:00.501 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 10:05:00.525 +00:00 [INF] {"Username":"alice","Provider":null,"ProviderUserId":null,"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","DisplayName":"alice","Endpoint":"UI","ClientId":"wewantdoughnuts","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HNBHPN9M06V0:00000005","TimeStamp":"2025-04-02T10:05:00.0000000Z","ProcessId":1038,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"UserLoginSuccessEvent"}
2025-04-02 10:05:00.530 +00:00 [DBG] Augmenting SignInContext
2025-04-02 10:05:00.531 +00:00 [DBG] Adding idp claim with value: local
2025-04-02 10:05:00.532 +00:00 [DBG] Adding amr claim with value: pwd
2025-04-02 10:05:00.532 +00:00 [DBG] Adding auth_time claim with value: 1743588300
2025-04-02 10:05:00.535 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 10:05:00.544 +00:00 [INF] AuthenticationScheme: idsrv signed in.
2025-04-02 10:05:00.573 +00:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2025-04-02 10:05:00.576 +00:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2025-04-02 10:05:00.576 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2025-04-02 10:05:00.580 +00:00 [DBG] Start authorize callback request
2025-04-02 10:05:00.595 +00:00 [DBG] User in authorize request: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 10:05:00.595 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 10:05:00.596 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:05:00.597 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 10:05:00.600 +00:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","AllowedRedirectUris":["http://localhost:3000/signin-oidc"],"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email doughnutapi","State":"7c0843fa90fc4cad9bca5b6e97a29280","UiLocales":null,"Nonce":"5d2fcebeea4f4ec0bc35f55ef6f308f2","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"82D84B3018C095440A38A9E43ECC2E20","Raw":{"client_id":"wewantdoughnuts","redirect_uri":"http://localhost:3000/signin-oidc","response_type":"id_token token","scope":"openid profile email doughnutapi","state":"7c0843fa90fc4cad9bca5b6e97a29280","nonce":"5d2fcebeea4f4ec0bc35f55ef6f308f2"},"$type":"AuthorizeRequestValidationLog"}
2025-04-02 10:05:00.609 +00:00 [DBG] Client is configured to not require consent, no consent is required
2025-04-02 10:05:00.612 +00:00 [DBG] Creating Implicit Flow response.
2025-04-02 10:05:00.624 +00:00 [DBG] Getting claims for access token for client: wewantdoughnuts
2025-04-02 10:05:00.626 +00:00 [DBG] Getting claims for access token for subject: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 10:05:00.706 +00:00 [DBG] Getting claims for identity token for subject: 42006211-B900-4701-A6F8-2986370C3563 and client: wewantdoughnuts
2025-04-02 10:05:00.707 +00:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2025-04-02 10:05:00.716 +00:00 [INF] {"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","Endpoint":"Authorize","SubjectId":"42006211-B900-4701-A6F8-2986370C3563","Scopes":"openid profile email doughnutapi","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****O2BQ","$type":"Token"},{"TokenType":"access_token","TokenValue":"****Ag1A","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HNBHPN9M06V0:00000007","TimeStamp":"2025-04-02T10:05:00.0000000Z","ProcessId":1038,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"TokenIssuedSuccessEvent"}
2025-04-02 10:05:00.718 +00:00 [DBG] Authorize endpoint response
{"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ClientId":"wewantdoughnuts","RedirectUri":"http://localhost:3000/signin-oidc","State":"7c0843fa90fc4cad9bca5b6e97a29280","Scope":"openid profile email doughnutapi","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2025-04-02 10:05:00.723 +00:00 [DBG] Augmenting SignInContext
2025-04-02 10:05:00.725 +00:00 [INF] AuthenticationScheme: idsrv signed in.
2025-04-02 10:05:01.155 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 10:05:01.157 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 10:05:01.161 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 10:05:01.163 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 10:05:01.165 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 10:05:01.169 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 10:05:01.175 +00:00 [DBG] Start discovery request
2025-04-02 10:05:01.219 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:3000
2025-04-02 10:05:01.221 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 10:05:01.222 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 10:05:01.224 +00:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2025-04-02 10:05:01.225 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2025-04-02 10:05:01.226 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2025-04-02 10:05:01.229 +00:00 [DBG] Start key discovery request
2025-04-02 10:05:01.269 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 10:05:01.270 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 10:05:01.270 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 10:05:01.302 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 10:05:01.302 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 10:05:01.303 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 10:05:01.304 +00:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2025-04-02 10:05:01.307 +00:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2025-04-02 10:05:01.307 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2025-04-02 10:05:01.312 +00:00 [DBG] Start userinfo request
2025-04-02 10:05:01.314 +00:00 [DBG] Bearer token found in header
2025-04-02 10:05:01.373 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:05:01.375 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:05:01.377 +00:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2025-04-02 10:05:01.379 +00:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":"447C6E3E03FB680F2D0A6164548B92F1","Claims":{"nbf":1743588300,"exp":1743591900,"iss":"https://webapi:8081","aud":["doughnutapi","https://webapi:8081/resources"],"client_id":"wewantdoughnuts","sub":"42006211-B900-4701-A6F8-2986370C3563","auth_time":1743588300,"idp":"local","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress":"AliceSmith@email.com","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname":"Alice","jti":"447C6E3E03FB680F2D0A6164548B92F1","sid":"82D84B3018C095440A38A9E43ECC2E20","iat":1743588300,"scope":["openid","profile","email","doughnutapi"],"amr":"pwd"},"$type":"TokenValidationLog"}
2025-04-02 10:05:01.382 +00:00 [DBG] Creating userinfo response
2025-04-02 10:05:01.384 +00:00 [DBG] Scopes in access token: openid profile email doughnutapi
2025-04-02 10:05:01.388 +00:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2025-04-02 10:05:01.389 +00:00 [INF] Profile service returned the following claim types: email given_name
2025-04-02 10:05:01.390 +00:00 [DBG] End userinfo request
2025-04-02 10:05:01.489 +00:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2025-04-02 10:05:01.490 +00:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2025-04-02 10:05:01.491 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2025-04-02 10:05:01.493 +00:00 [DBG] Rendering check session result
2025-04-02 10:05:01.858 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 10:05:01.860 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 10:05:01.860 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 10:05:01.860 +00:00 [DBG] Start discovery request
2025-04-02 10:05:01.887 +00:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2025-04-02 10:05:01.888 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2025-04-02 10:05:01.890 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2025-04-02 10:05:01.892 +00:00 [DBG] Start key discovery request
2025-04-02 10:09:54.455 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 10:09:54.477 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 10:09:54.477 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 10:09:54.479 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 10:09:54.479 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 10:09:54.479 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 10:09:54.480 +00:00 [DBG] Start discovery request
2025-04-02 10:09:54.515 +00:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2025-04-02 10:09:54.517 +00:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2025-04-02 10:09:54.519 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2025-04-02 10:09:54.520 +00:00 [DBG] Start authorize request
2025-04-02 10:09:54.521 +00:00 [DBG] User in authorize request: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 10:09:54.521 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 10:09:54.522 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:09:54.523 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 10:09:54.524 +00:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","AllowedRedirectUris":["http://localhost:3000/signin-oidc"],"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email doughnutapi","State":"ef3a8f39edad42c19711e838a0709e82","UiLocales":null,"Nonce":"400f16b3b3ae4ad59c6795bcdb1d5b6f","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"82D84B3018C095440A38A9E43ECC2E20","Raw":{"client_id":"wewantdoughnuts","redirect_uri":"http://localhost:3000/signin-oidc","response_type":"id_token token","scope":"openid profile email doughnutapi","state":"ef3a8f39edad42c19711e838a0709e82","nonce":"400f16b3b3ae4ad59c6795bcdb1d5b6f"},"$type":"AuthorizeRequestValidationLog"}
2025-04-02 10:09:54.525 +00:00 [DBG] Client is configured to not require consent, no consent is required
2025-04-02 10:09:54.526 +00:00 [DBG] Creating Implicit Flow response.
2025-04-02 10:09:54.528 +00:00 [DBG] Getting claims for access token for client: wewantdoughnuts
2025-04-02 10:09:54.529 +00:00 [DBG] Getting claims for access token for subject: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 10:09:54.532 +00:00 [DBG] Getting claims for identity token for subject: 42006211-B900-4701-A6F8-2986370C3563 and client: wewantdoughnuts
2025-04-02 10:09:54.533 +00:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2025-04-02 10:09:54.538 +00:00 [INF] {"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","Endpoint":"Authorize","SubjectId":"42006211-B900-4701-A6F8-2986370C3563","Scopes":"openid profile email doughnutapi","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****xSpg","$type":"Token"},{"TokenType":"access_token","TokenValue":"****Nr9w","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HNBHPN9M06V0:00000009","TimeStamp":"2025-04-02T10:09:54.0000000Z","ProcessId":1038,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"TokenIssuedSuccessEvent"}
2025-04-02 10:09:54.540 +00:00 [DBG] Authorize endpoint response
{"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ClientId":"wewantdoughnuts","RedirectUri":"http://localhost:3000/signin-oidc","State":"ef3a8f39edad42c19711e838a0709e82","Scope":"openid profile email doughnutapi","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2025-04-02 10:09:54.855 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 10:09:54.857 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 10:09:54.857 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 10:09:54.859 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 10:09:54.863 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 10:09:54.864 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 10:09:54.865 +00:00 [DBG] Start discovery request
2025-04-02 10:09:54.884 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:3000
2025-04-02 10:09:54.886 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 10:09:54.887 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 10:09:54.888 +00:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2025-04-02 10:09:54.891 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2025-04-02 10:09:54.892 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2025-04-02 10:09:54.893 +00:00 [DBG] Start key discovery request
2025-04-02 10:09:54.920 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 10:09:54.921 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 10:09:54.922 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 10:09:54.932 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 10:09:54.933 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 10:09:54.934 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 10:09:54.934 +00:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2025-04-02 10:09:54.937 +00:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2025-04-02 10:09:54.937 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2025-04-02 10:09:54.938 +00:00 [DBG] Start userinfo request
2025-04-02 10:09:54.939 +00:00 [DBG] Bearer token found in header
2025-04-02 10:09:54.940 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:09:54.942 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:09:54.942 +00:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2025-04-02 10:09:54.945 +00:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":"A8E15697AAB7598A38D54E7BF897D316","Claims":{"nbf":1743588594,"exp":1743592194,"iss":"https://webapi:8081","aud":["doughnutapi","https://webapi:8081/resources"],"client_id":"wewantdoughnuts","sub":"42006211-B900-4701-A6F8-2986370C3563","auth_time":1743588300,"idp":"local","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress":"AliceSmith@email.com","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname":"Alice","jti":"A8E15697AAB7598A38D54E7BF897D316","sid":"82D84B3018C095440A38A9E43ECC2E20","iat":1743588594,"scope":["openid","profile","email","doughnutapi"],"amr":"pwd"},"$type":"TokenValidationLog"}
2025-04-02 10:09:54.945 +00:00 [DBG] Creating userinfo response
2025-04-02 10:09:54.945 +00:00 [DBG] Scopes in access token: openid profile email doughnutapi
2025-04-02 10:09:54.946 +00:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2025-04-02 10:09:54.947 +00:00 [INF] Profile service returned the following claim types: email given_name
2025-04-02 10:09:54.948 +00:00 [DBG] End userinfo request
2025-04-02 10:09:55.022 +00:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2025-04-02 10:09:55.023 +00:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2025-04-02 10:09:55.024 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2025-04-02 10:09:55.025 +00:00 [DBG] Rendering check session result
2025-04-02 10:10:41.953 +00:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2025-04-02 10:10:41.959 +00:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2025-04-02 10:10:41.961 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2025-04-02 10:10:41.967 +00:00 [DBG] Processing signout request for 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 10:10:41.970 +00:00 [DBG] Start end session request validation
2025-04-02 10:10:41.982 +00:00 [INF] End session request validation success
{"ClientId":null,"ClientName":null,"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","PostLogOutUri":null,"State":null,"Raw":{"post_logout_redirect_uri":"http://localhost:3000/signout-oidc"},"$type":"EndSessionRequestValidationLog"}
2025-04-02 10:10:41.982 +00:00 [DBG] Success validating end session request from null
2025-04-02 10:10:44.641 +00:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2025-04-02 10:10:44.697 +00:00 [INF] AuthenticationScheme: idsrv signed out.
2025-04-02 10:10:44.698 +00:00 [INF] {"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","DisplayName":"alice","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HNBHPN9M06V0:0000001D","TimeStamp":"2025-04-02T10:10:44.0000000Z","ProcessId":1038,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"UserLogoutSuccessEvent"}
2025-04-02 10:10:44.705 +00:00 [DBG] SignOutCalled set; processing post-signout session cleanup.
2025-04-02 10:10:44.710 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:10:44.711 +00:00 [DBG] No client back-channel logout URLs
2025-04-02 10:10:44.800 +00:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2025-04-02 10:10:44.808 +00:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2025-04-02 10:10:44.811 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2025-04-02 10:10:44.832 +00:00 [DBG] Processing signout callback request
2025-04-02 10:10:44.852 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:10:44.854 +00:00 [DBG] No client front-channel logout URLs
2025-04-02 10:10:44.858 +00:00 [INF] Successful signout callback.
2025-04-02 10:10:46.846 +00:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2025-04-02 10:10:46.852 +00:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2025-04-02 10:10:46.853 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2025-04-02 10:10:46.856 +00:00 [DBG] Processing signout callback request
2025-04-02 10:10:46.860 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:10:46.867 +00:00 [DBG] No client front-channel logout URLs
2025-04-02 10:10:46.868 +00:00 [INF] Successful signout callback.
2025-04-02 10:10:51.220 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 10:10:51.220 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 10:10:51.221 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 10:10:51.222 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 10:10:51.223 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 10:10:51.224 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 10:10:51.226 +00:00 [DBG] Start discovery request
2025-04-02 10:10:51.268 +00:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2025-04-02 10:10:51.274 +00:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2025-04-02 10:10:51.277 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2025-04-02 10:10:51.279 +00:00 [DBG] Start authorize request
2025-04-02 10:10:51.280 +00:00 [DBG] No user present in authorize request
2025-04-02 10:10:51.282 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 10:10:51.283 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:10:51.285 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 10:10:51.286 +00:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","AllowedRedirectUris":["http://localhost:3000/signin-oidc"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email doughnutapi","State":"c903d4af944f43ac8758a98a0a2844f9","UiLocales":null,"Nonce":"09463d8e22004fb78b167a50788a200d","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"wewantdoughnuts","redirect_uri":"http://localhost:3000/signin-oidc","response_type":"id_token token","scope":"openid profile email doughnutapi","state":"c903d4af944f43ac8758a98a0a2844f9","nonce":"09463d8e22004fb78b167a50788a200d"},"$type":"AuthorizeRequestValidationLog"}
2025-04-02 10:10:51.287 +00:00 [INF] Showing login: User is not authenticated
2025-04-02 10:10:51.307 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 10:10:51.308 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:10:51.310 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 10:10:51.312 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:10:53.484 +00:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2025-04-02 10:10:53.527 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 10:10:53.528 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:10:53.528 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 10:10:53.530 +00:00 [INF] {"Username":"alice","Provider":null,"ProviderUserId":null,"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","DisplayName":"alice","Endpoint":"UI","ClientId":"wewantdoughnuts","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HNBHPN9M06V0:00000053","TimeStamp":"2025-04-02T10:10:53.0000000Z","ProcessId":1038,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"UserLoginSuccessEvent"}
2025-04-02 10:10:53.530 +00:00 [DBG] Augmenting SignInContext
2025-04-02 10:10:53.531 +00:00 [DBG] Adding idp claim with value: local
2025-04-02 10:10:53.532 +00:00 [DBG] Adding amr claim with value: pwd
2025-04-02 10:10:53.532 +00:00 [DBG] Adding auth_time claim with value: 1743588653
2025-04-02 10:10:53.534 +00:00 [INF] AuthenticationScheme: idsrv signed in.
2025-04-02 10:10:53.574 +00:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2025-04-02 10:10:53.576 +00:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2025-04-02 10:10:53.576 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2025-04-02 10:10:53.578 +00:00 [DBG] Start authorize callback request
2025-04-02 10:10:53.579 +00:00 [DBG] User in authorize request: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 10:10:53.580 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 10:10:53.581 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:10:53.582 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 10:10:53.583 +00:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","AllowedRedirectUris":["http://localhost:3000/signin-oidc"],"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email doughnutapi","State":"c903d4af944f43ac8758a98a0a2844f9","UiLocales":null,"Nonce":"09463d8e22004fb78b167a50788a200d","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"1AF2E6898CAF4B873D5004D1FAD7AB33","Raw":{"client_id":"wewantdoughnuts","redirect_uri":"http://localhost:3000/signin-oidc","response_type":"id_token token","scope":"openid profile email doughnutapi","state":"c903d4af944f43ac8758a98a0a2844f9","nonce":"09463d8e22004fb78b167a50788a200d"},"$type":"AuthorizeRequestValidationLog"}
2025-04-02 10:10:53.583 +00:00 [DBG] Client is configured to not require consent, no consent is required
2025-04-02 10:10:53.584 +00:00 [DBG] Creating Implicit Flow response.
2025-04-02 10:10:53.585 +00:00 [DBG] Getting claims for access token for client: wewantdoughnuts
2025-04-02 10:10:53.586 +00:00 [DBG] Getting claims for access token for subject: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 10:10:53.589 +00:00 [DBG] Getting claims for identity token for subject: 42006211-B900-4701-A6F8-2986370C3563 and client: wewantdoughnuts
2025-04-02 10:10:53.589 +00:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2025-04-02 10:10:53.592 +00:00 [INF] {"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","Endpoint":"Authorize","SubjectId":"42006211-B900-4701-A6F8-2986370C3563","Scopes":"openid profile email doughnutapi","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****L0Rw","$type":"Token"},{"TokenType":"access_token","TokenValue":"****8-1A","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HNBHPN9M06V0:00000055","TimeStamp":"2025-04-02T10:10:53.0000000Z","ProcessId":1038,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"TokenIssuedSuccessEvent"}
2025-04-02 10:10:53.592 +00:00 [DBG] Authorize endpoint response
{"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ClientId":"wewantdoughnuts","RedirectUri":"http://localhost:3000/signin-oidc","State":"c903d4af944f43ac8758a98a0a2844f9","Scope":"openid profile email doughnutapi","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2025-04-02 10:10:53.595 +00:00 [DBG] Augmenting SignInContext
2025-04-02 10:10:53.596 +00:00 [INF] AuthenticationScheme: idsrv signed in.
2025-04-02 10:10:54.396 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 10:10:54.398 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 10:10:54.398 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 10:10:54.401 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 10:10:54.403 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 10:10:54.408 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 10:10:54.414 +00:00 [DBG] Start discovery request
2025-04-02 10:10:54.476 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:3000
2025-04-02 10:10:54.479 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 10:10:54.480 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 10:10:54.481 +00:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2025-04-02 10:10:54.482 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2025-04-02 10:10:54.486 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2025-04-02 10:10:54.488 +00:00 [DBG] Start key discovery request
2025-04-02 10:10:54.526 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 10:10:54.528 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 10:10:54.529 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 10:10:54.545 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 10:10:54.546 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 10:10:54.546 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 10:10:54.547 +00:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2025-04-02 10:10:54.550 +00:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2025-04-02 10:10:54.551 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2025-04-02 10:10:54.552 +00:00 [DBG] Start userinfo request
2025-04-02 10:10:54.553 +00:00 [DBG] Bearer token found in header
2025-04-02 10:10:54.554 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:10:54.555 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:10:54.556 +00:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2025-04-02 10:10:54.556 +00:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":"2BD980FCBF59D5953A094FE7F702AD43","Claims":{"nbf":1743588653,"exp":1743592253,"iss":"https://webapi:8081","aud":["doughnutapi","https://webapi:8081/resources"],"client_id":"wewantdoughnuts","sub":"42006211-B900-4701-A6F8-2986370C3563","auth_time":1743588653,"idp":"local","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress":"AliceSmith@email.com","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname":"Alice","jti":"2BD980FCBF59D5953A094FE7F702AD43","sid":"1AF2E6898CAF4B873D5004D1FAD7AB33","iat":1743588653,"scope":["openid","profile","email","doughnutapi"],"amr":"pwd"},"$type":"TokenValidationLog"}
2025-04-02 10:10:54.557 +00:00 [DBG] Creating userinfo response
2025-04-02 10:10:54.559 +00:00 [DBG] Scopes in access token: openid profile email doughnutapi
2025-04-02 10:10:54.560 +00:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2025-04-02 10:10:54.562 +00:00 [INF] Profile service returned the following claim types: email given_name
2025-04-02 10:10:54.563 +00:00 [DBG] End userinfo request
2025-04-02 10:10:54.618 +00:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2025-04-02 10:10:54.620 +00:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2025-04-02 10:10:54.629 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2025-04-02 10:10:54.630 +00:00 [DBG] Rendering check session result
2025-04-02 10:16:28.885 +00:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2025-04-02 10:16:28.900 +00:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2025-04-02 10:16:28.901 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2025-04-02 10:16:28.903 +00:00 [DBG] Processing signout request for 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 10:16:28.904 +00:00 [DBG] Start end session request validation
2025-04-02 10:16:28.907 +00:00 [INF] End session request validation success
{"ClientId":null,"ClientName":null,"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","PostLogOutUri":null,"State":null,"Raw":{"post_logout_redirect_uri":"http://localhost:3000/signout-oidc"},"$type":"EndSessionRequestValidationLog"}
2025-04-02 10:16:28.907 +00:00 [DBG] Success validating end session request from null
2025-04-02 10:16:31.110 +00:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2025-04-02 10:16:31.183 +00:00 [INF] AuthenticationScheme: idsrv signed out.
2025-04-02 10:16:31.184 +00:00 [INF] {"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","DisplayName":"alice","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HNBHPN9M06V0:00000069","TimeStamp":"2025-04-02T10:16:31.0000000Z","ProcessId":1038,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"UserLogoutSuccessEvent"}
2025-04-02 10:16:31.186 +00:00 [DBG] SignOutCalled set; processing post-signout session cleanup.
2025-04-02 10:16:31.187 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:16:31.187 +00:00 [DBG] No client back-channel logout URLs
2025-04-02 10:16:31.272 +00:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2025-04-02 10:16:31.278 +00:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2025-04-02 10:16:31.282 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2025-04-02 10:16:31.284 +00:00 [DBG] Processing signout callback request
2025-04-02 10:16:31.287 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:16:31.291 +00:00 [DBG] No client front-channel logout URLs
2025-04-02 10:16:31.292 +00:00 [INF] Successful signout callback.
2025-04-02 10:16:33.214 +00:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2025-04-02 10:16:33.215 +00:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2025-04-02 10:16:33.217 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2025-04-02 10:16:33.220 +00:00 [DBG] Processing signout callback request
2025-04-02 10:16:33.228 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:16:33.234 +00:00 [DBG] No client front-channel logout URLs
2025-04-02 10:16:33.238 +00:00 [INF] Successful signout callback.
2025-04-02 10:16:36.202 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 10:16:36.203 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 10:16:36.204 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 10:16:36.204 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 10:16:36.205 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 10:16:36.206 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 10:16:36.207 +00:00 [DBG] Start discovery request
2025-04-02 10:16:36.245 +00:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2025-04-02 10:16:36.247 +00:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2025-04-02 10:16:36.247 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2025-04-02 10:16:36.248 +00:00 [DBG] Start authorize request
2025-04-02 10:16:36.250 +00:00 [DBG] No user present in authorize request
2025-04-02 10:16:36.251 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 10:16:36.254 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:16:36.257 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 10:16:36.259 +00:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","AllowedRedirectUris":["http://localhost:3000/signin-oidc"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email doughnutapi","State":"aed7d58fec3a453cb0a2780d3930f06a","UiLocales":null,"Nonce":"b8d1b97206a64debaa03a4bee90ce0e8","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"wewantdoughnuts","redirect_uri":"http://localhost:3000/signin-oidc","response_type":"id_token token","scope":"openid profile email doughnutapi","state":"aed7d58fec3a453cb0a2780d3930f06a","nonce":"b8d1b97206a64debaa03a4bee90ce0e8"},"$type":"AuthorizeRequestValidationLog"}
2025-04-02 10:16:36.263 +00:00 [INF] Showing login: User is not authenticated
2025-04-02 10:16:36.308 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 10:16:36.308 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:16:36.311 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 10:16:36.316 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:16:38.309 +00:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2025-04-02 10:16:38.384 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 10:16:38.384 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:16:38.385 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 10:16:38.386 +00:00 [INF] {"Username":"alice","Provider":null,"ProviderUserId":null,"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","DisplayName":"alice","Endpoint":"UI","ClientId":"wewantdoughnuts","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HNBHPN9M06V0:0000009F","TimeStamp":"2025-04-02T10:16:38.0000000Z","ProcessId":1038,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"UserLoginSuccessEvent"}
2025-04-02 10:16:38.387 +00:00 [DBG] Augmenting SignInContext
2025-04-02 10:16:38.387 +00:00 [DBG] Adding idp claim with value: local
2025-04-02 10:16:38.389 +00:00 [DBG] Adding amr claim with value: pwd
2025-04-02 10:16:38.390 +00:00 [DBG] Adding auth_time claim with value: 1743588998
2025-04-02 10:16:38.393 +00:00 [INF] AuthenticationScheme: idsrv signed in.
2025-04-02 10:16:38.417 +00:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2025-04-02 10:16:38.424 +00:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2025-04-02 10:16:38.425 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2025-04-02 10:16:38.426 +00:00 [DBG] Start authorize callback request
2025-04-02 10:16:38.429 +00:00 [DBG] User in authorize request: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 10:16:38.431 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 10:16:38.432 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:16:38.434 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 10:16:38.435 +00:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","AllowedRedirectUris":["http://localhost:3000/signin-oidc"],"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email doughnutapi","State":"aed7d58fec3a453cb0a2780d3930f06a","UiLocales":null,"Nonce":"b8d1b97206a64debaa03a4bee90ce0e8","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"AC5F9686DF7DDF1BFF956A45E9EE83A7","Raw":{"client_id":"wewantdoughnuts","redirect_uri":"http://localhost:3000/signin-oidc","response_type":"id_token token","scope":"openid profile email doughnutapi","state":"aed7d58fec3a453cb0a2780d3930f06a","nonce":"b8d1b97206a64debaa03a4bee90ce0e8"},"$type":"AuthorizeRequestValidationLog"}
2025-04-02 10:16:38.437 +00:00 [DBG] Client is configured to not require consent, no consent is required
2025-04-02 10:16:38.438 +00:00 [DBG] Creating Implicit Flow response.
2025-04-02 10:16:38.440 +00:00 [DBG] Getting claims for access token for client: wewantdoughnuts
2025-04-02 10:16:38.440 +00:00 [DBG] Getting claims for access token for subject: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 10:16:38.445 +00:00 [DBG] Getting claims for identity token for subject: 42006211-B900-4701-A6F8-2986370C3563 and client: wewantdoughnuts
2025-04-02 10:16:38.445 +00:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2025-04-02 10:16:38.448 +00:00 [INF] {"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","Endpoint":"Authorize","SubjectId":"42006211-B900-4701-A6F8-2986370C3563","Scopes":"openid profile email doughnutapi","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****F-yg","$type":"Token"},{"TokenType":"access_token","TokenValue":"****t0rg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HNBHPN9M06V0:000000A1","TimeStamp":"2025-04-02T10:16:38.0000000Z","ProcessId":1038,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"TokenIssuedSuccessEvent"}
2025-04-02 10:16:38.449 +00:00 [DBG] Authorize endpoint response
{"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ClientId":"wewantdoughnuts","RedirectUri":"http://localhost:3000/signin-oidc","State":"aed7d58fec3a453cb0a2780d3930f06a","Scope":"openid profile email doughnutapi","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2025-04-02 10:16:38.450 +00:00 [DBG] Augmenting SignInContext
2025-04-02 10:16:38.452 +00:00 [INF] AuthenticationScheme: idsrv signed in.
2025-04-02 10:16:39.316 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 10:16:39.318 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 10:16:39.324 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 10:16:39.332 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 10:16:39.333 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 10:16:39.335 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 10:16:39.336 +00:00 [DBG] Start discovery request
2025-04-02 10:16:39.375 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:3000
2025-04-02 10:16:39.383 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 10:16:39.385 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 10:16:39.388 +00:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2025-04-02 10:16:39.390 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2025-04-02 10:16:39.391 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2025-04-02 10:16:39.393 +00:00 [DBG] Start key discovery request
2025-04-02 10:16:39.449 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 10:16:39.450 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 10:16:39.450 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 10:16:39.481 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 10:16:39.482 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 10:16:39.483 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 10:16:39.484 +00:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2025-04-02 10:16:39.485 +00:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2025-04-02 10:16:39.487 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2025-04-02 10:16:39.488 +00:00 [DBG] Start userinfo request
2025-04-02 10:16:39.488 +00:00 [DBG] Bearer token found in header
2025-04-02 10:16:39.490 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:16:39.491 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:16:39.493 +00:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2025-04-02 10:16:39.495 +00:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":"3D446548377D4AC40716410DE56D1196","Claims":{"nbf":1743588998,"exp":1743592598,"iss":"https://webapi:8081","aud":["doughnutapi","https://webapi:8081/resources"],"client_id":"wewantdoughnuts","sub":"42006211-B900-4701-A6F8-2986370C3563","auth_time":1743588998,"idp":"local","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress":"AliceSmith@email.com","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname":"Alice","jti":"3D446548377D4AC40716410DE56D1196","sid":"AC5F9686DF7DDF1BFF956A45E9EE83A7","iat":1743588998,"scope":["openid","profile","email","doughnutapi"],"amr":"pwd"},"$type":"TokenValidationLog"}
2025-04-02 10:16:39.497 +00:00 [DBG] Creating userinfo response
2025-04-02 10:16:39.499 +00:00 [DBG] Scopes in access token: openid profile email doughnutapi
2025-04-02 10:16:39.501 +00:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2025-04-02 10:16:39.503 +00:00 [INF] Profile service returned the following claim types: email given_name
2025-04-02 10:16:39.505 +00:00 [DBG] End userinfo request
2025-04-02 10:16:39.583 +00:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2025-04-02 10:16:39.587 +00:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2025-04-02 10:16:39.589 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2025-04-02 10:16:39.593 +00:00 [DBG] Rendering check session result
2025-04-02 10:18:43.276 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 10:18:43.276 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 10:18:43.277 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 10:18:43.277 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 10:18:43.278 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 10:18:43.279 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 10:18:43.280 +00:00 [DBG] Start discovery request
2025-04-02 10:18:43.318 +00:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2025-04-02 10:18:43.319 +00:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2025-04-02 10:18:43.320 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2025-04-02 10:18:43.321 +00:00 [DBG] Start authorize request
2025-04-02 10:18:43.323 +00:00 [DBG] User in authorize request: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 10:18:43.328 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 10:18:43.333 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:18:43.335 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 10:18:43.336 +00:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","AllowedRedirectUris":["http://localhost:3000/signin-oidc"],"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email doughnutapi","State":"1af5ed9a859946af903c8365b2407511","UiLocales":null,"Nonce":"2c0b9fa832a94f6ba7f127c15b9bf17d","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"AC5F9686DF7DDF1BFF956A45E9EE83A7","Raw":{"client_id":"wewantdoughnuts","redirect_uri":"http://localhost:3000/signin-oidc","response_type":"id_token token","scope":"openid profile email doughnutapi","state":"1af5ed9a859946af903c8365b2407511","nonce":"2c0b9fa832a94f6ba7f127c15b9bf17d"},"$type":"AuthorizeRequestValidationLog"}
2025-04-02 10:18:43.337 +00:00 [DBG] Client is configured to not require consent, no consent is required
2025-04-02 10:18:43.337 +00:00 [DBG] Creating Implicit Flow response.
2025-04-02 10:18:43.338 +00:00 [DBG] Getting claims for access token for client: wewantdoughnuts
2025-04-02 10:18:43.340 +00:00 [DBG] Getting claims for access token for subject: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 10:18:43.344 +00:00 [DBG] Getting claims for identity token for subject: 42006211-B900-4701-A6F8-2986370C3563 and client: wewantdoughnuts
2025-04-02 10:18:43.345 +00:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2025-04-02 10:18:43.352 +00:00 [INF] {"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","Endpoint":"Authorize","SubjectId":"42006211-B900-4701-A6F8-2986370C3563","Scopes":"openid profile email doughnutapi","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****zQrg","$type":"Token"},{"TokenType":"access_token","TokenValue":"****uLJw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HNBHPN9M06V0:000000A3","TimeStamp":"2025-04-02T10:18:43.0000000Z","ProcessId":1038,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"TokenIssuedSuccessEvent"}
2025-04-02 10:18:43.352 +00:00 [DBG] Authorize endpoint response
{"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ClientId":"wewantdoughnuts","RedirectUri":"http://localhost:3000/signin-oidc","State":"1af5ed9a859946af903c8365b2407511","Scope":"openid profile email doughnutapi","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2025-04-02 10:18:43.660 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 10:18:43.661 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 10:18:43.662 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 10:18:43.663 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 10:18:43.665 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 10:18:43.667 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 10:18:43.668 +00:00 [DBG] Start discovery request
2025-04-02 10:18:43.707 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:3000
2025-04-02 10:18:43.709 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 10:18:43.709 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 10:18:43.711 +00:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2025-04-02 10:18:43.715 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2025-04-02 10:18:43.716 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2025-04-02 10:18:43.717 +00:00 [DBG] Start key discovery request
2025-04-02 10:18:43.740 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 10:18:43.741 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 10:18:43.742 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 10:18:43.753 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 10:18:43.754 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 10:18:43.754 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 10:18:43.755 +00:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2025-04-02 10:18:43.756 +00:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2025-04-02 10:18:43.757 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2025-04-02 10:18:43.758 +00:00 [DBG] Start userinfo request
2025-04-02 10:18:43.759 +00:00 [DBG] Bearer token found in header
2025-04-02 10:18:43.761 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:18:43.762 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:18:43.764 +00:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2025-04-02 10:18:43.765 +00:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":"449B559CF503FFE84E5021670EC3BCD6","Claims":{"nbf":1743589123,"exp":1743592723,"iss":"https://webapi:8081","aud":["doughnutapi","https://webapi:8081/resources"],"client_id":"wewantdoughnuts","sub":"42006211-B900-4701-A6F8-2986370C3563","auth_time":1743588998,"idp":"local","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress":"AliceSmith@email.com","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname":"Alice","jti":"449B559CF503FFE84E5021670EC3BCD6","sid":"AC5F9686DF7DDF1BFF956A45E9EE83A7","iat":1743589123,"scope":["openid","profile","email","doughnutapi"],"amr":"pwd"},"$type":"TokenValidationLog"}
2025-04-02 10:18:43.766 +00:00 [DBG] Creating userinfo response
2025-04-02 10:18:43.768 +00:00 [DBG] Scopes in access token: openid profile email doughnutapi
2025-04-02 10:18:43.769 +00:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2025-04-02 10:18:43.770 +00:00 [INF] Profile service returned the following claim types: email given_name
2025-04-02 10:18:43.770 +00:00 [DBG] End userinfo request
2025-04-02 10:18:43.826 +00:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2025-04-02 10:18:43.830 +00:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2025-04-02 10:18:43.835 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2025-04-02 10:18:43.837 +00:00 [DBG] Rendering check session result
2025-04-02 10:37:58.174 +00:00 [INF] Starting IdentityServer4 version 4.1.1+cebd52f5bc61bdefc262fd20739d4d087c6f961f
2025-04-02 10:37:58.263 +00:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2025-04-02 10:37:58.266 +00:00 [DBG] Custom IssuerUri set to https://webapi:8081
2025-04-02 10:37:58.281 +00:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2025-04-02 10:37:58.281 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2025-04-02 10:37:58.282 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2025-04-02 10:37:58.283 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2025-04-02 10:37:58.286 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2025-04-02 10:37:58.288 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2025-04-02 10:37:58.576 +00:00 [WRN] Using an in-memory repository. Keys will not be persisted to storage.
2025-04-02 10:37:58.577 +00:00 [WRN] Neither user profile nor HKLM registry available. Using an ephemeral key repository. Protected data will be unavailable when application exits.
2025-04-02 10:37:58.611 +00:00 [WRN] No XML encryptor configured. Key "0bc5b61a-b1da-445d-8569-bd8715eabbce" may be persisted to storage in unencrypted form.
2025-04-02 10:37:59.517 +00:00 [DBG] Login Url: /Account/Login
2025-04-02 10:37:59.520 +00:00 [DBG] Login Return Url Parameter: ReturnUrl
2025-04-02 10:37:59.520 +00:00 [DBG] Logout Url: /Account/Logout
2025-04-02 10:37:59.521 +00:00 [DBG] ConsentUrl Url: /consent
2025-04-02 10:37:59.522 +00:00 [DBG] Consent Return Url Parameter: returnUrl
2025-04-02 10:37:59.524 +00:00 [DBG] Error Url: /home/error
2025-04-02 10:37:59.525 +00:00 [DBG] Error Id Parameter: errorId
2025-04-02 10:37:59.548 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 10:37:59.552 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 10:37:59.553 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 10:37:59.556 +00:00 [DBG] Start discovery request
2025-04-02 10:37:59.670 +00:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2025-04-02 10:37:59.676 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2025-04-02 10:37:59.677 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2025-04-02 10:37:59.679 +00:00 [DBG] Start key discovery request
2025-04-02 10:38:43.588 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 10:38:43.594 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 10:38:43.594 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 10:38:43.606 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 10:38:43.607 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 10:38:43.608 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 10:38:43.610 +00:00 [DBG] Start discovery request
2025-04-02 10:38:43.687 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 10:38:43.688 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 10:38:43.695 +00:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2025-04-02 10:38:43.721 +00:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2025-04-02 10:38:43.722 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2025-04-02 10:38:43.735 +00:00 [DBG] Start authorize request
2025-04-02 10:38:43.759 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 10:38:43.763 +00:00 [DBG] No user present in authorize request
2025-04-02 10:38:43.775 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 10:38:43.800 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:38:43.834 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 10:38:43.852 +00:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","AllowedRedirectUris":["http://localhost:3000/signin-oidc"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email doughnutapi","State":"198315b13d124429a21dbe8c6ffc0db5","UiLocales":null,"Nonce":"5d9709d214f4470781699de09fbc7ba5","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"wewantdoughnuts","redirect_uri":"http://localhost:3000/signin-oidc","response_type":"id_token token","scope":"openid profile email doughnutapi","state":"198315b13d124429a21dbe8c6ffc0db5","nonce":"5d9709d214f4470781699de09fbc7ba5"},"$type":"AuthorizeRequestValidationLog"}
2025-04-02 10:38:43.868 +00:00 [INF] Showing login: User is not authenticated
2025-04-02 10:38:43.897 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 10:38:43.898 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 10:38:43.996 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 10:38:43.997 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 10:38:43.998 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:38:44.000 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 10:38:44.007 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:38:46.929 +00:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2025-04-02 10:38:46.931 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 10:38:46.933 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 10:38:46.984 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 10:38:46.984 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 10:38:46.986 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:38:46.988 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 10:38:47.008 +00:00 [INF] {"Username":"alice","Provider":null,"ProviderUserId":null,"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","DisplayName":"alice","Endpoint":"UI","ClientId":"wewantdoughnuts","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HNBHQ9O0T00T:00000013","TimeStamp":"2025-04-02T10:38:47.0000000Z","ProcessId":1337,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"UserLoginSuccessEvent"}
2025-04-02 10:38:47.014 +00:00 [DBG] Augmenting SignInContext
2025-04-02 10:38:47.017 +00:00 [DBG] Adding idp claim with value: local
2025-04-02 10:38:47.017 +00:00 [DBG] Adding amr claim with value: pwd
2025-04-02 10:38:47.018 +00:00 [DBG] Adding auth_time claim with value: 1743590327
2025-04-02 10:38:47.020 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 10:38:47.030 +00:00 [INF] AuthenticationScheme: idsrv signed in.
2025-04-02 10:38:47.056 +00:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2025-04-02 10:38:47.059 +00:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2025-04-02 10:38:47.059 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2025-04-02 10:38:47.063 +00:00 [DBG] Start authorize callback request
2025-04-02 10:38:47.069 +00:00 [DBG] User in authorize request: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 10:38:47.069 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 10:38:47.070 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:38:47.071 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 10:38:47.074 +00:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","AllowedRedirectUris":["http://localhost:3000/signin-oidc"],"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email doughnutapi","State":"198315b13d124429a21dbe8c6ffc0db5","UiLocales":null,"Nonce":"5d9709d214f4470781699de09fbc7ba5","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"DE1C0BEE17731B83D13B32C45E84AD9D","Raw":{"client_id":"wewantdoughnuts","redirect_uri":"http://localhost:3000/signin-oidc","response_type":"id_token token","scope":"openid profile email doughnutapi","state":"198315b13d124429a21dbe8c6ffc0db5","nonce":"5d9709d214f4470781699de09fbc7ba5"},"$type":"AuthorizeRequestValidationLog"}
2025-04-02 10:38:47.080 +00:00 [DBG] Client is configured to not require consent, no consent is required
2025-04-02 10:38:47.084 +00:00 [DBG] Creating Implicit Flow response.
2025-04-02 10:38:47.091 +00:00 [DBG] Getting claims for access token for client: wewantdoughnuts
2025-04-02 10:38:47.092 +00:00 [DBG] Getting claims for access token for subject: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 10:38:47.177 +00:00 [DBG] Getting claims for identity token for subject: 42006211-B900-4701-A6F8-2986370C3563 and client: wewantdoughnuts
2025-04-02 10:38:47.178 +00:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2025-04-02 10:38:47.187 +00:00 [INF] {"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","Endpoint":"Authorize","SubjectId":"42006211-B900-4701-A6F8-2986370C3563","Scopes":"openid profile email doughnutapi","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****ULkg","$type":"Token"},{"TokenType":"access_token","TokenValue":"****oG4g","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HNBHQ9O0T00T:00000015","TimeStamp":"2025-04-02T10:38:47.0000000Z","ProcessId":1337,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"TokenIssuedSuccessEvent"}
2025-04-02 10:38:47.189 +00:00 [DBG] Authorize endpoint response
{"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ClientId":"wewantdoughnuts","RedirectUri":"http://localhost:3000/signin-oidc","State":"198315b13d124429a21dbe8c6ffc0db5","Scope":"openid profile email doughnutapi","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2025-04-02 10:38:47.195 +00:00 [DBG] Augmenting SignInContext
2025-04-02 10:38:47.196 +00:00 [INF] AuthenticationScheme: idsrv signed in.
2025-04-02 10:38:48.578 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 10:38:48.589 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 10:38:48.590 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 10:38:48.592 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 10:38:48.600 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 10:38:48.602 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 10:38:48.610 +00:00 [DBG] Start discovery request
2025-04-02 10:38:48.704 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:3000
2025-04-02 10:38:48.706 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 10:38:48.707 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 10:38:48.707 +00:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2025-04-02 10:38:48.709 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2025-04-02 10:38:48.710 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2025-04-02 10:38:48.711 +00:00 [DBG] Start key discovery request
2025-04-02 10:38:48.761 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 10:38:48.762 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 10:38:48.763 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 10:38:48.779 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 10:38:48.780 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 10:38:48.780 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 10:38:48.782 +00:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2025-04-02 10:38:48.786 +00:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2025-04-02 10:38:48.787 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2025-04-02 10:38:48.791 +00:00 [DBG] Start userinfo request
2025-04-02 10:38:48.794 +00:00 [DBG] Bearer token found in header
2025-04-02 10:38:48.860 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:38:48.863 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:38:48.864 +00:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2025-04-02 10:38:48.866 +00:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":"5D72309B6D4FC4EBAE96B3C34BF78D6E","Claims":{"nbf":1743590327,"exp":1743593927,"iss":"https://webapi:8081","aud":["doughnutapi","https://webapi:8081/resources"],"client_id":"wewantdoughnuts","sub":"42006211-B900-4701-A6F8-2986370C3563","auth_time":1743590327,"idp":"local","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress":"AliceSmith@email.com","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname":"Alice","jti":"5D72309B6D4FC4EBAE96B3C34BF78D6E","sid":"DE1C0BEE17731B83D13B32C45E84AD9D","iat":1743590327,"scope":["openid","profile","email","doughnutapi"],"amr":"pwd"},"$type":"TokenValidationLog"}
2025-04-02 10:38:48.870 +00:00 [DBG] Creating userinfo response
2025-04-02 10:38:48.876 +00:00 [DBG] Scopes in access token: openid profile email doughnutapi
2025-04-02 10:38:48.879 +00:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2025-04-02 10:38:48.880 +00:00 [INF] Profile service returned the following claim types: email given_name
2025-04-02 10:38:48.880 +00:00 [DBG] End userinfo request
2025-04-02 10:38:48.980 +00:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2025-04-02 10:38:48.985 +00:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2025-04-02 10:38:48.987 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2025-04-02 10:38:48.988 +00:00 [DBG] Rendering check session result
2025-04-02 10:40:13.879 +00:00 [INF] Starting IdentityServer4 version 4.1.1+cebd52f5bc61bdefc262fd20739d4d087c6f961f
2025-04-02 10:40:13.950 +00:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2025-04-02 10:40:13.954 +00:00 [DBG] Custom IssuerUri set to https://webapi:8081
2025-04-02 10:40:13.966 +00:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2025-04-02 10:40:13.966 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2025-04-02 10:40:13.967 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2025-04-02 10:40:13.968 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2025-04-02 10:40:13.970 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2025-04-02 10:40:13.971 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2025-04-02 10:40:14.162 +00:00 [WRN] Using an in-memory repository. Keys will not be persisted to storage.
2025-04-02 10:40:14.163 +00:00 [WRN] Neither user profile nor HKLM registry available. Using an ephemeral key repository. Protected data will be unavailable when application exits.
2025-04-02 10:40:14.181 +00:00 [WRN] No XML encryptor configured. Key "354ad24b-7f26-4524-97f9-198deb1d3721" may be persisted to storage in unencrypted form.
2025-04-02 10:40:23.670 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 10:40:23.677 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 10:40:23.678 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 10:40:23.700 +00:00 [DBG] Login Url: /Account/Login
2025-04-02 10:40:23.702 +00:00 [DBG] Login Return Url Parameter: ReturnUrl
2025-04-02 10:40:23.704 +00:00 [DBG] Logout Url: /Account/Logout
2025-04-02 10:40:23.705 +00:00 [DBG] ConsentUrl Url: /consent
2025-04-02 10:40:23.706 +00:00 [DBG] Consent Return Url Parameter: returnUrl
2025-04-02 10:40:23.708 +00:00 [DBG] Error Url: /home/error
2025-04-02 10:40:23.710 +00:00 [DBG] Error Id Parameter: errorId
2025-04-02 10:40:23.735 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 10:40:23.740 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 10:40:23.742 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 10:40:23.745 +00:00 [DBG] Start discovery request
2025-04-02 10:40:23.871 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 10:40:23.873 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 10:40:23.892 +00:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2025-04-02 10:40:23.938 +00:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2025-04-02 10:40:23.938 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2025-04-02 10:40:23.946 +00:00 [DBG] Start authorize request
2025-04-02 10:40:23.982 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 10:40:23.986 +00:00 [DBG] No user present in authorize request
2025-04-02 10:40:23.993 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 10:40:24.006 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:40:24.040 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 10:40:24.055 +00:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","AllowedRedirectUris":["http://localhost:3000/signin-oidc"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email doughnutapi","State":"0ae997ec3c194d728d7b13fd7b37f34b","UiLocales":null,"Nonce":"7a25a11720724333be78e60504426271","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"wewantdoughnuts","redirect_uri":"http://localhost:3000/signin-oidc","response_type":"id_token token","scope":"openid profile email doughnutapi","state":"0ae997ec3c194d728d7b13fd7b37f34b","nonce":"7a25a11720724333be78e60504426271"},"$type":"AuthorizeRequestValidationLog"}
2025-04-02 10:40:24.070 +00:00 [INF] Showing login: User is not authenticated
2025-04-02 10:40:24.103 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 10:40:24.106 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 10:40:24.152 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 10:40:24.153 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 10:40:24.154 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:40:24.155 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 10:40:24.159 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:40:26.071 +00:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2025-04-02 10:40:26.074 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 10:40:26.074 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 10:40:26.139 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 10:40:26.139 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 10:40:26.140 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:40:26.141 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 10:40:26.159 +00:00 [INF] {"Username":"alice","Provider":null,"ProviderUserId":null,"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","DisplayName":"alice","Endpoint":"UI","ClientId":"wewantdoughnuts","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HNBHQB2VG68N:00000013","TimeStamp":"2025-04-02T10:40:26.0000000Z","ProcessId":1455,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"UserLoginSuccessEvent"}
2025-04-02 10:40:26.165 +00:00 [DBG] Augmenting SignInContext
2025-04-02 10:40:26.168 +00:00 [DBG] Adding idp claim with value: local
2025-04-02 10:40:26.168 +00:00 [DBG] Adding amr claim with value: pwd
2025-04-02 10:40:26.170 +00:00 [DBG] Adding auth_time claim with value: 1743590426
2025-04-02 10:40:26.172 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 10:40:26.179 +00:00 [INF] AuthenticationScheme: idsrv signed in.
2025-04-02 10:40:26.205 +00:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2025-04-02 10:40:26.209 +00:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2025-04-02 10:40:26.210 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2025-04-02 10:40:26.214 +00:00 [DBG] Start authorize callback request
2025-04-02 10:40:26.227 +00:00 [DBG] User in authorize request: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 10:40:26.228 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 10:40:26.228 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:40:26.229 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 10:40:26.234 +00:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","AllowedRedirectUris":["http://localhost:3000/signin-oidc"],"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email doughnutapi","State":"0ae997ec3c194d728d7b13fd7b37f34b","UiLocales":null,"Nonce":"7a25a11720724333be78e60504426271","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"040607CC432F0E419848582FB4B691CF","Raw":{"client_id":"wewantdoughnuts","redirect_uri":"http://localhost:3000/signin-oidc","response_type":"id_token token","scope":"openid profile email doughnutapi","state":"0ae997ec3c194d728d7b13fd7b37f34b","nonce":"7a25a11720724333be78e60504426271"},"$type":"AuthorizeRequestValidationLog"}
2025-04-02 10:40:26.242 +00:00 [DBG] Client is configured to not require consent, no consent is required
2025-04-02 10:40:26.245 +00:00 [DBG] Creating Implicit Flow response.
2025-04-02 10:40:26.258 +00:00 [DBG] Getting claims for access token for client: wewantdoughnuts
2025-04-02 10:40:26.260 +00:00 [DBG] Getting claims for access token for subject: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 10:40:26.345 +00:00 [DBG] Getting claims for identity token for subject: 42006211-B900-4701-A6F8-2986370C3563 and client: wewantdoughnuts
2025-04-02 10:40:26.346 +00:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2025-04-02 10:40:26.355 +00:00 [INF] {"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","Endpoint":"Authorize","SubjectId":"42006211-B900-4701-A6F8-2986370C3563","Scopes":"openid profile email doughnutapi","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****Cang","$type":"Token"},{"TokenType":"access_token","TokenValue":"****S49g","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HNBHQB2VG68N:00000015","TimeStamp":"2025-04-02T10:40:26.0000000Z","ProcessId":1455,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"TokenIssuedSuccessEvent"}
2025-04-02 10:40:26.358 +00:00 [DBG] Authorize endpoint response
{"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ClientId":"wewantdoughnuts","RedirectUri":"http://localhost:3000/signin-oidc","State":"0ae997ec3c194d728d7b13fd7b37f34b","Scope":"openid profile email doughnutapi","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2025-04-02 10:40:26.364 +00:00 [DBG] Augmenting SignInContext
2025-04-02 10:40:26.366 +00:00 [INF] AuthenticationScheme: idsrv signed in.
2025-04-02 10:40:27.252 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 10:40:27.253 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 10:40:27.257 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 10:40:27.259 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 10:40:27.265 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 10:40:27.267 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 10:40:27.269 +00:00 [DBG] Start discovery request
2025-04-02 10:40:27.288 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:3000
2025-04-02 10:40:27.291 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 10:40:27.291 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 10:40:27.293 +00:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2025-04-02 10:40:27.294 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2025-04-02 10:40:27.297 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2025-04-02 10:40:27.302 +00:00 [DBG] Start key discovery request
2025-04-02 10:40:27.350 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 10:40:27.351 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 10:40:27.352 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 10:40:27.405 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 10:40:27.406 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 10:40:27.406 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 10:40:27.407 +00:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2025-04-02 10:40:27.410 +00:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2025-04-02 10:40:27.410 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2025-04-02 10:40:27.413 +00:00 [DBG] Start userinfo request
2025-04-02 10:40:27.415 +00:00 [DBG] Bearer token found in header
2025-04-02 10:40:27.474 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:40:27.476 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:40:27.477 +00:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2025-04-02 10:40:27.479 +00:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":"0F49D1EDD3763516505EF7D6B5D9761C","Claims":{"nbf":1743590426,"exp":1743594026,"iss":"https://webapi:8081","aud":["doughnutapi","https://webapi:8081/resources"],"client_id":"wewantdoughnuts","sub":"42006211-B900-4701-A6F8-2986370C3563","auth_time":1743590426,"idp":"local","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress":"AliceSmith@email.com","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname":"Alice","jti":"0F49D1EDD3763516505EF7D6B5D9761C","sid":"040607CC432F0E419848582FB4B691CF","iat":1743590426,"scope":["openid","profile","email","doughnutapi"],"amr":"pwd"},"$type":"TokenValidationLog"}
2025-04-02 10:40:27.485 +00:00 [DBG] Creating userinfo response
2025-04-02 10:40:27.488 +00:00 [DBG] Scopes in access token: openid profile email doughnutapi
2025-04-02 10:40:27.492 +00:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2025-04-02 10:40:27.493 +00:00 [INF] Profile service returned the following claim types: email given_name
2025-04-02 10:40:27.494 +00:00 [DBG] End userinfo request
2025-04-02 10:40:27.570 +00:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2025-04-02 10:40:27.571 +00:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2025-04-02 10:40:27.572 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2025-04-02 10:40:27.574 +00:00 [DBG] Rendering check session result
2025-04-02 10:40:32.438 +00:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2025-04-02 10:40:32.441 +00:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2025-04-02 10:40:32.444 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2025-04-02 10:40:32.449 +00:00 [DBG] Processing signout request for 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 10:40:32.454 +00:00 [DBG] Start end session request validation
2025-04-02 10:40:32.463 +00:00 [INF] End session request validation success
{"ClientId":null,"ClientName":null,"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","PostLogOutUri":null,"State":null,"Raw":{"post_logout_redirect_uri":"http://localhost:3000/signout-oidc"},"$type":"EndSessionRequestValidationLog"}
2025-04-02 10:40:32.464 +00:00 [DBG] Success validating end session request from null
2025-04-02 10:40:34.917 +00:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2025-04-02 10:40:34.975 +00:00 [INF] AuthenticationScheme: idsrv signed out.
2025-04-02 10:40:34.976 +00:00 [INF] {"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","DisplayName":"alice","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HNBHQB2VG68N:00000029","TimeStamp":"2025-04-02T10:40:34.0000000Z","ProcessId":1455,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"UserLogoutSuccessEvent"}
2025-04-02 10:40:34.985 +00:00 [DBG] SignOutCalled set; processing post-signout session cleanup.
2025-04-02 10:40:34.989 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:40:34.990 +00:00 [DBG] No client back-channel logout URLs
2025-04-02 10:40:35.085 +00:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2025-04-02 10:40:35.088 +00:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2025-04-02 10:40:35.091 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2025-04-02 10:40:35.096 +00:00 [DBG] Processing signout callback request
2025-04-02 10:40:35.118 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:40:35.120 +00:00 [DBG] No client front-channel logout URLs
2025-04-02 10:40:35.123 +00:00 [INF] Successful signout callback.
2025-04-02 10:40:36.897 +00:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2025-04-02 10:40:36.900 +00:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2025-04-02 10:40:36.904 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2025-04-02 10:40:36.907 +00:00 [DBG] Processing signout callback request
2025-04-02 10:40:36.932 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:40:36.936 +00:00 [DBG] No client front-channel logout URLs
2025-04-02 10:40:36.938 +00:00 [INF] Successful signout callback.
2025-04-02 10:41:41.361 +00:00 [INF] Starting IdentityServer4 version 4.1.1+cebd52f5bc61bdefc262fd20739d4d087c6f961f
2025-04-02 10:41:41.436 +00:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2025-04-02 10:41:41.438 +00:00 [DBG] Custom IssuerUri set to https://webapi:8081
2025-04-02 10:41:41.454 +00:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2025-04-02 10:41:41.455 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2025-04-02 10:41:41.455 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2025-04-02 10:41:41.456 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2025-04-02 10:41:41.458 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2025-04-02 10:41:41.459 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2025-04-02 10:41:41.662 +00:00 [WRN] Using an in-memory repository. Keys will not be persisted to storage.
2025-04-02 10:41:41.663 +00:00 [WRN] Neither user profile nor HKLM registry available. Using an ephemeral key repository. Protected data will be unavailable when application exits.
2025-04-02 10:41:41.681 +00:00 [WRN] No XML encryptor configured. Key "68236768-7cb9-4c36-8789-7f083617d620" may be persisted to storage in unencrypted form.
2025-04-02 10:42:35.637 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 10:42:35.644 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 10:42:35.645 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 10:42:35.668 +00:00 [DBG] Login Url: /Account/Login
2025-04-02 10:42:35.669 +00:00 [DBG] Login Return Url Parameter: ReturnUrl
2025-04-02 10:42:35.669 +00:00 [DBG] Logout Url: /Account/Logout
2025-04-02 10:42:35.671 +00:00 [DBG] ConsentUrl Url: /consent
2025-04-02 10:42:35.672 +00:00 [DBG] Consent Return Url Parameter: returnUrl
2025-04-02 10:42:35.674 +00:00 [DBG] Error Url: /home/error
2025-04-02 10:42:35.675 +00:00 [DBG] Error Id Parameter: errorId
2025-04-02 10:42:35.691 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 10:42:35.695 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 10:42:35.695 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 10:42:35.698 +00:00 [DBG] Start discovery request
2025-04-02 10:42:35.830 +00:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2025-04-02 10:42:35.869 +00:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2025-04-02 10:42:35.870 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2025-04-02 10:42:35.881 +00:00 [DBG] Start authorize request
2025-04-02 10:42:35.913 +00:00 [DBG] No user present in authorize request
2025-04-02 10:42:35.916 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 10:42:35.931 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:42:35.964 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 10:42:35.979 +00:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","AllowedRedirectUris":["http://localhost:3000/signin-oidc"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email doughnutapi","State":"3b182e9fa72e40ac82c1e9e1db29e668","UiLocales":null,"Nonce":"a0642b68960c4827a0b20441631bdfa0","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"wewantdoughnuts","redirect_uri":"http://localhost:3000/signin-oidc","response_type":"id_token token","scope":"openid profile email doughnutapi","state":"3b182e9fa72e40ac82c1e9e1db29e668","nonce":"a0642b68960c4827a0b20441631bdfa0"},"$type":"AuthorizeRequestValidationLog"}
2025-04-02 10:42:35.994 +00:00 [INF] Showing login: User is not authenticated
2025-04-02 10:42:36.091 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 10:42:36.092 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:42:36.093 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 10:42:36.097 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:42:37.884 +00:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2025-04-02 10:42:37.943 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 10:42:37.944 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:42:37.945 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 10:42:37.968 +00:00 [INF] {"Username":"alice","Provider":null,"ProviderUserId":null,"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","DisplayName":"alice","Endpoint":"UI","ClientId":"wewantdoughnuts","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HNBHQCAAAI9U:00000013","TimeStamp":"2025-04-02T10:42:37.0000000Z","ProcessId":1581,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"UserLoginSuccessEvent"}
2025-04-02 10:42:37.974 +00:00 [DBG] Augmenting SignInContext
2025-04-02 10:42:37.975 +00:00 [DBG] Adding idp claim with value: local
2025-04-02 10:42:37.976 +00:00 [DBG] Adding amr claim with value: pwd
2025-04-02 10:42:37.977 +00:00 [DBG] Adding auth_time claim with value: 1743590557
2025-04-02 10:42:37.990 +00:00 [INF] AuthenticationScheme: idsrv signed in.
2025-04-02 10:42:38.014 +00:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2025-04-02 10:42:38.018 +00:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2025-04-02 10:42:38.019 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2025-04-02 10:42:38.024 +00:00 [DBG] Start authorize callback request
2025-04-02 10:42:38.043 +00:00 [DBG] User in authorize request: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 10:42:38.044 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 10:42:38.044 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:42:38.045 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 10:42:38.049 +00:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","AllowedRedirectUris":["http://localhost:3000/signin-oidc"],"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email doughnutapi","State":"3b182e9fa72e40ac82c1e9e1db29e668","UiLocales":null,"Nonce":"a0642b68960c4827a0b20441631bdfa0","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"EA30CFE483D2AABD282E252F55CA8D84","Raw":{"client_id":"wewantdoughnuts","redirect_uri":"http://localhost:3000/signin-oidc","response_type":"id_token token","scope":"openid profile email doughnutapi","state":"3b182e9fa72e40ac82c1e9e1db29e668","nonce":"a0642b68960c4827a0b20441631bdfa0"},"$type":"AuthorizeRequestValidationLog"}
2025-04-02 10:42:38.058 +00:00 [DBG] Client is configured to not require consent, no consent is required
2025-04-02 10:42:38.062 +00:00 [DBG] Creating Implicit Flow response.
2025-04-02 10:42:38.077 +00:00 [DBG] Getting claims for access token for client: wewantdoughnuts
2025-04-02 10:42:38.079 +00:00 [DBG] Getting claims for access token for subject: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 10:42:38.176 +00:00 [DBG] Getting claims for identity token for subject: 42006211-B900-4701-A6F8-2986370C3563 and client: wewantdoughnuts
2025-04-02 10:42:38.176 +00:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2025-04-02 10:42:38.186 +00:00 [INF] {"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","Endpoint":"Authorize","SubjectId":"42006211-B900-4701-A6F8-2986370C3563","Scopes":"openid profile email doughnutapi","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****NjIw","$type":"Token"},{"TokenType":"access_token","TokenValue":"****kk8Q","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HNBHQCAAAI9U:00000015","TimeStamp":"2025-04-02T10:42:38.0000000Z","ProcessId":1581,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"TokenIssuedSuccessEvent"}
2025-04-02 10:42:38.191 +00:00 [DBG] Authorize endpoint response
{"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ClientId":"wewantdoughnuts","RedirectUri":"http://localhost:3000/signin-oidc","State":"3b182e9fa72e40ac82c1e9e1db29e668","Scope":"openid profile email doughnutapi","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2025-04-02 10:42:38.196 +00:00 [DBG] Augmenting SignInContext
2025-04-02 10:42:38.197 +00:00 [INF] AuthenticationScheme: idsrv signed in.
2025-04-02 10:42:39.427 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 10:42:39.428 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 10:42:39.431 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 10:42:39.437 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 10:42:39.440 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 10:42:39.442 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 10:42:39.444 +00:00 [DBG] Start discovery request
2025-04-02 10:42:39.493 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:3000
2025-04-02 10:42:39.494 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 10:42:39.495 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 10:42:39.496 +00:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2025-04-02 10:42:39.497 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2025-04-02 10:42:39.497 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2025-04-02 10:42:39.501 +00:00 [DBG] Start key discovery request
2025-04-02 10:42:39.547 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 10:42:39.547 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 10:42:39.548 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 10:42:39.573 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 10:42:39.581 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 10:42:39.583 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 10:42:39.586 +00:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2025-04-02 10:42:39.592 +00:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2025-04-02 10:42:39.593 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2025-04-02 10:42:39.598 +00:00 [DBG] Start userinfo request
2025-04-02 10:42:39.601 +00:00 [DBG] Bearer token found in header
2025-04-02 10:42:39.674 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:42:39.678 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:42:39.680 +00:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2025-04-02 10:42:39.683 +00:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":"1CAD392A535DE5B377B0EAC9BEA14DA3","Claims":{"nbf":1743590558,"exp":1743594158,"iss":"https://webapi:8081","aud":["doughnutapi","https://webapi:8081/resources"],"client_id":"wewantdoughnuts","sub":"42006211-B900-4701-A6F8-2986370C3563","auth_time":1743590557,"idp":"local","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress":"AliceSmith@email.com","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname":"Alice","jti":"1CAD392A535DE5B377B0EAC9BEA14DA3","sid":"EA30CFE483D2AABD282E252F55CA8D84","iat":1743590558,"scope":["openid","profile","email","doughnutapi"],"amr":"pwd"},"$type":"TokenValidationLog"}
2025-04-02 10:42:39.687 +00:00 [DBG] Creating userinfo response
2025-04-02 10:42:39.690 +00:00 [DBG] Scopes in access token: openid profile email doughnutapi
2025-04-02 10:42:39.694 +00:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2025-04-02 10:42:39.697 +00:00 [INF] Profile service returned the following claim types: email given_name
2025-04-02 10:42:39.697 +00:00 [DBG] End userinfo request
2025-04-02 10:42:39.805 +00:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2025-04-02 10:42:39.807 +00:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2025-04-02 10:42:39.808 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2025-04-02 10:42:39.810 +00:00 [DBG] Rendering check session result
2025-04-02 10:42:40.211 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 10:42:40.213 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 10:42:40.213 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 10:42:40.215 +00:00 [DBG] Start discovery request
2025-04-02 10:42:40.244 +00:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2025-04-02 10:42:40.245 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2025-04-02 10:42:40.245 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2025-04-02 10:42:40.246 +00:00 [DBG] Start key discovery request
2025-04-02 10:52:12.978 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 10:52:13.001 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 10:52:13.001 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 10:52:13.003 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 10:52:13.003 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 10:52:13.004 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 10:52:13.005 +00:00 [DBG] Start discovery request
2025-04-02 10:52:13.089 +00:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2025-04-02 10:52:13.090 +00:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2025-04-02 10:52:13.091 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2025-04-02 10:52:13.094 +00:00 [DBG] Start authorize request
2025-04-02 10:52:13.097 +00:00 [DBG] User in authorize request: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 10:52:13.098 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 10:52:13.100 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:52:13.102 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 10:52:13.103 +00:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","AllowedRedirectUris":["http://localhost:3000/signin-oidc"],"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email doughnutapi","State":"38d019661fb84461bac050570f9e50a2","UiLocales":null,"Nonce":"5821cab8db29453ea43f3d8bc78f0771","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"EA30CFE483D2AABD282E252F55CA8D84","Raw":{"client_id":"wewantdoughnuts","redirect_uri":"http://localhost:3000/signin-oidc","response_type":"id_token token","scope":"openid profile email doughnutapi","state":"38d019661fb84461bac050570f9e50a2","nonce":"5821cab8db29453ea43f3d8bc78f0771"},"$type":"AuthorizeRequestValidationLog"}
2025-04-02 10:52:13.105 +00:00 [DBG] Client is configured to not require consent, no consent is required
2025-04-02 10:52:13.107 +00:00 [DBG] Creating Implicit Flow response.
2025-04-02 10:52:13.111 +00:00 [DBG] Getting claims for access token for client: wewantdoughnuts
2025-04-02 10:52:13.113 +00:00 [DBG] Getting claims for access token for subject: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 10:52:13.119 +00:00 [DBG] Getting claims for identity token for subject: 42006211-B900-4701-A6F8-2986370C3563 and client: wewantdoughnuts
2025-04-02 10:52:13.119 +00:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2025-04-02 10:52:13.124 +00:00 [INF] {"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","Endpoint":"Authorize","SubjectId":"42006211-B900-4701-A6F8-2986370C3563","Scopes":"openid profile email doughnutapi","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****okfQ","$type":"Token"},{"TokenType":"access_token","TokenValue":"****CkvA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HNBHQCAAAIA2:00000001","TimeStamp":"2025-04-02T10:52:13.0000000Z","ProcessId":1581,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"TokenIssuedSuccessEvent"}
2025-04-02 10:52:13.126 +00:00 [DBG] Authorize endpoint response
{"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ClientId":"wewantdoughnuts","RedirectUri":"http://localhost:3000/signin-oidc","State":"38d019661fb84461bac050570f9e50a2","Scope":"openid profile email doughnutapi","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2025-04-02 10:52:13.992 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 10:52:14.003 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 10:52:14.006 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 10:52:14.013 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 10:52:14.017 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 10:52:14.019 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 10:52:14.022 +00:00 [DBG] Start discovery request
2025-04-02 10:52:14.046 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:3000
2025-04-02 10:52:14.047 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 10:52:14.051 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 10:52:14.054 +00:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2025-04-02 10:52:14.058 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2025-04-02 10:52:14.061 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2025-04-02 10:52:14.062 +00:00 [DBG] Start key discovery request
2025-04-02 10:52:14.118 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 10:52:14.119 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 10:52:14.119 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 10:52:14.134 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 10:52:14.134 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 10:52:14.135 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 10:52:14.136 +00:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2025-04-02 10:52:14.140 +00:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2025-04-02 10:52:14.141 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2025-04-02 10:52:14.142 +00:00 [DBG] Start userinfo request
2025-04-02 10:52:14.144 +00:00 [DBG] Bearer token found in header
2025-04-02 10:52:14.148 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:52:14.149 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:52:14.150 +00:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2025-04-02 10:52:14.152 +00:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":"087626F4CE7B5189070320E24A52D4AF","Claims":{"nbf":1743591133,"exp":1743594733,"iss":"https://webapi:8081","aud":["doughnutapi","https://webapi:8081/resources"],"client_id":"wewantdoughnuts","sub":"42006211-B900-4701-A6F8-2986370C3563","auth_time":1743590557,"idp":"local","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress":"AliceSmith@email.com","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname":"Alice","jti":"087626F4CE7B5189070320E24A52D4AF","sid":"EA30CFE483D2AABD282E252F55CA8D84","iat":1743591133,"scope":["openid","profile","email","doughnutapi"],"amr":"pwd"},"$type":"TokenValidationLog"}
2025-04-02 10:52:14.153 +00:00 [DBG] Creating userinfo response
2025-04-02 10:52:14.154 +00:00 [DBG] Scopes in access token: openid profile email doughnutapi
2025-04-02 10:52:14.155 +00:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2025-04-02 10:52:14.156 +00:00 [INF] Profile service returned the following claim types: email given_name
2025-04-02 10:52:14.157 +00:00 [DBG] End userinfo request
2025-04-02 10:52:14.250 +00:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2025-04-02 10:52:14.251 +00:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2025-04-02 10:52:14.253 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2025-04-02 10:52:14.255 +00:00 [DBG] Rendering check session result
2025-04-02 10:55:51.056 +00:00 [INF] Starting IdentityServer4 version 4.1.1+cebd52f5bc61bdefc262fd20739d4d087c6f961f
2025-04-02 10:55:51.103 +00:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2025-04-02 10:55:51.104 +00:00 [DBG] Custom IssuerUri set to https://webapi:8081
2025-04-02 10:55:51.118 +00:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2025-04-02 10:55:51.119 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2025-04-02 10:55:51.119 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2025-04-02 10:55:51.120 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2025-04-02 10:55:51.122 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2025-04-02 10:55:51.124 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2025-04-02 10:55:51.332 +00:00 [WRN] Using an in-memory repository. Keys will not be persisted to storage.
2025-04-02 10:55:51.333 +00:00 [WRN] Neither user profile nor HKLM registry available. Using an ephemeral key repository. Protected data will be unavailable when application exits.
2025-04-02 10:55:51.350 +00:00 [WRN] No XML encryptor configured. Key "7780db02-3222-4214-ad88-fd9ef6251dfa" may be persisted to storage in unencrypted form.
2025-04-02 10:56:13.606 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 10:56:13.616 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 10:56:13.616 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 10:56:13.638 +00:00 [DBG] Login Url: /Account/Login
2025-04-02 10:56:13.638 +00:00 [DBG] Login Return Url Parameter: ReturnUrl
2025-04-02 10:56:13.639 +00:00 [DBG] Logout Url: /Account/Logout
2025-04-02 10:56:13.639 +00:00 [DBG] ConsentUrl Url: /consent
2025-04-02 10:56:13.640 +00:00 [DBG] Consent Return Url Parameter: returnUrl
2025-04-02 10:56:13.642 +00:00 [DBG] Error Url: /home/error
2025-04-02 10:56:13.643 +00:00 [DBG] Error Id Parameter: errorId
2025-04-02 10:56:13.663 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 10:56:13.669 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 10:56:13.670 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 10:56:13.675 +00:00 [DBG] Start discovery request
2025-04-02 10:56:13.801 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 10:56:13.802 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 10:56:13.810 +00:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2025-04-02 10:56:13.837 +00:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2025-04-02 10:56:13.838 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2025-04-02 10:56:13.853 +00:00 [DBG] Start authorize request
2025-04-02 10:56:13.881 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 10:56:13.885 +00:00 [DBG] No user present in authorize request
2025-04-02 10:56:13.889 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 10:56:13.900 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:56:13.949 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 10:56:13.967 +00:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","AllowedRedirectUris":["http://localhost:3000/signin-oidc"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email doughnutapi","State":"7693c11b51c640eba5bea761ea0ec75c","UiLocales":null,"Nonce":"a29a4b6d2562481ba430c067f87f8c20","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"wewantdoughnuts","redirect_uri":"http://localhost:3000/signin-oidc","response_type":"id_token token","scope":"openid profile email doughnutapi","state":"7693c11b51c640eba5bea761ea0ec75c","nonce":"a29a4b6d2562481ba430c067f87f8c20"},"$type":"AuthorizeRequestValidationLog"}
2025-04-02 10:56:13.982 +00:00 [INF] Showing login: User is not authenticated
2025-04-02 10:56:14.013 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 10:56:14.018 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 10:56:14.069 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 10:56:14.070 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 10:56:14.070 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:56:14.071 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 10:56:14.075 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:56:16.152 +00:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2025-04-02 10:56:16.155 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 10:56:16.155 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 10:56:16.195 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 10:56:16.196 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 10:56:16.197 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:56:16.199 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 10:56:16.220 +00:00 [INF] {"Username":"alice","Provider":null,"ProviderUserId":null,"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","DisplayName":"alice","Endpoint":"UI","ClientId":"wewantdoughnuts","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HNBHQJU3104T:00000013","TimeStamp":"2025-04-02T10:56:16.0000000Z","ProcessId":1792,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"UserLoginSuccessEvent"}
2025-04-02 10:56:16.225 +00:00 [DBG] Augmenting SignInContext
2025-04-02 10:56:16.227 +00:00 [DBG] Adding idp claim with value: local
2025-04-02 10:56:16.229 +00:00 [DBG] Adding amr claim with value: pwd
2025-04-02 10:56:16.232 +00:00 [DBG] Adding auth_time claim with value: 1743591376
2025-04-02 10:56:16.237 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 10:56:16.245 +00:00 [INF] AuthenticationScheme: idsrv signed in.
2025-04-02 10:56:16.272 +00:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2025-04-02 10:56:16.276 +00:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2025-04-02 10:56:16.276 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2025-04-02 10:56:16.280 +00:00 [DBG] Start authorize callback request
2025-04-02 10:56:16.298 +00:00 [DBG] User in authorize request: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 10:56:16.298 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 10:56:16.299 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:56:16.300 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 10:56:16.304 +00:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","AllowedRedirectUris":["http://localhost:3000/signin-oidc"],"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email doughnutapi","State":"7693c11b51c640eba5bea761ea0ec75c","UiLocales":null,"Nonce":"a29a4b6d2562481ba430c067f87f8c20","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"D38401CDE10E981AE72F2529E5E0F4DC","Raw":{"client_id":"wewantdoughnuts","redirect_uri":"http://localhost:3000/signin-oidc","response_type":"id_token token","scope":"openid profile email doughnutapi","state":"7693c11b51c640eba5bea761ea0ec75c","nonce":"a29a4b6d2562481ba430c067f87f8c20"},"$type":"AuthorizeRequestValidationLog"}
2025-04-02 10:56:16.311 +00:00 [DBG] Client is configured to not require consent, no consent is required
2025-04-02 10:56:16.315 +00:00 [DBG] Creating Implicit Flow response.
2025-04-02 10:56:16.328 +00:00 [DBG] Getting claims for access token for client: wewantdoughnuts
2025-04-02 10:56:16.329 +00:00 [DBG] Getting claims for access token for subject: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 10:56:16.417 +00:00 [DBG] Getting claims for identity token for subject: 42006211-B900-4701-A6F8-2986370C3563 and client: wewantdoughnuts
2025-04-02 10:56:16.417 +00:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2025-04-02 10:56:16.428 +00:00 [INF] {"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","Endpoint":"Authorize","SubjectId":"42006211-B900-4701-A6F8-2986370C3563","Scopes":"openid profile email doughnutapi","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****8txA","$type":"Token"},{"TokenType":"access_token","TokenValue":"****s06w","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HNBHQJU3104T:00000015","TimeStamp":"2025-04-02T10:56:16.0000000Z","ProcessId":1792,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"TokenIssuedSuccessEvent"}
2025-04-02 10:56:16.440 +00:00 [DBG] Authorize endpoint response
{"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ClientId":"wewantdoughnuts","RedirectUri":"http://localhost:3000/signin-oidc","State":"7693c11b51c640eba5bea761ea0ec75c","Scope":"openid profile email doughnutapi","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2025-04-02 10:56:16.446 +00:00 [DBG] Augmenting SignInContext
2025-04-02 10:56:16.448 +00:00 [INF] AuthenticationScheme: idsrv signed in.
2025-04-02 10:56:17.341 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 10:56:17.353 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 10:56:17.354 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 10:56:17.358 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 10:56:17.366 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 10:56:17.372 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 10:56:17.383 +00:00 [DBG] Start discovery request
2025-04-02 10:56:17.437 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:3000
2025-04-02 10:56:17.439 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 10:56:17.442 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 10:56:17.444 +00:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2025-04-02 10:56:17.452 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2025-04-02 10:56:17.458 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2025-04-02 10:56:17.461 +00:00 [DBG] Start key discovery request
2025-04-02 10:56:17.515 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 10:56:17.516 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 10:56:17.516 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 10:56:17.529 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 10:56:17.530 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 10:56:17.532 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 10:56:17.534 +00:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2025-04-02 10:56:17.537 +00:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2025-04-02 10:56:17.538 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2025-04-02 10:56:17.542 +00:00 [DBG] Start userinfo request
2025-04-02 10:56:17.549 +00:00 [DBG] Bearer token found in header
2025-04-02 10:56:17.616 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:56:17.618 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 10:56:17.619 +00:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2025-04-02 10:56:17.621 +00:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":"DC1A6ECB8C04193ABC81647116CA04B0","Claims":{"nbf":1743591376,"exp":1743594976,"iss":"https://webapi:8081","aud":["doughnutapi","https://webapi:8081/resources"],"client_id":"wewantdoughnuts","sub":"42006211-B900-4701-A6F8-2986370C3563","auth_time":1743591376,"idp":"local","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress":"AliceSmith@email.com","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname":"Alice","jti":"DC1A6ECB8C04193ABC81647116CA04B0","sid":"D38401CDE10E981AE72F2529E5E0F4DC","iat":1743591376,"scope":["openid","profile","email","doughnutapi"],"amr":"pwd"},"$type":"TokenValidationLog"}
2025-04-02 10:56:17.626 +00:00 [DBG] Creating userinfo response
2025-04-02 10:56:17.629 +00:00 [DBG] Scopes in access token: openid profile email doughnutapi
2025-04-02 10:56:17.634 +00:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2025-04-02 10:56:17.635 +00:00 [INF] Profile service returned the following claim types: email given_name
2025-04-02 10:56:17.636 +00:00 [DBG] End userinfo request
2025-04-02 10:56:17.737 +00:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2025-04-02 10:56:17.737 +00:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2025-04-02 10:56:17.738 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2025-04-02 10:56:17.740 +00:00 [DBG] Rendering check session result
2025-04-02 10:56:22.065 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 10:56:22.070 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 10:56:22.072 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 10:56:22.075 +00:00 [DBG] Start discovery request
2025-04-02 10:56:22.197 +00:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2025-04-02 10:56:22.199 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2025-04-02 10:56:22.200 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2025-04-02 10:56:22.202 +00:00 [DBG] Start key discovery request
2025-04-02 11:03:45.846 +00:00 [INF] Starting IdentityServer4 version 4.1.1+cebd52f5bc61bdefc262fd20739d4d087c6f961f
2025-04-02 11:03:45.887 +00:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2025-04-02 11:03:45.888 +00:00 [DBG] Custom IssuerUri set to https://webapi:8081
2025-04-02 11:03:45.899 +00:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2025-04-02 11:03:45.899 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2025-04-02 11:03:45.900 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2025-04-02 11:03:45.901 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2025-04-02 11:03:45.902 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2025-04-02 11:03:45.905 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2025-04-02 11:03:46.115 +00:00 [WRN] Using an in-memory repository. Keys will not be persisted to storage.
2025-04-02 11:03:46.115 +00:00 [WRN] Neither user profile nor HKLM registry available. Using an ephemeral key repository. Protected data will be unavailable when application exits.
2025-04-02 11:03:46.137 +00:00 [WRN] No XML encryptor configured. Key "cf8da45e-ed67-4d01-8c74-386e73421b0d" may be persisted to storage in unencrypted form.
2025-04-02 11:03:53.059 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 11:03:53.067 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 11:03:53.068 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 11:03:53.092 +00:00 [DBG] Login Url: /Account/Login
2025-04-02 11:03:53.093 +00:00 [DBG] Login Return Url Parameter: ReturnUrl
2025-04-02 11:03:53.093 +00:00 [DBG] Logout Url: /Account/Logout
2025-04-02 11:03:53.094 +00:00 [DBG] ConsentUrl Url: /consent
2025-04-02 11:03:53.096 +00:00 [DBG] Consent Return Url Parameter: returnUrl
2025-04-02 11:03:53.097 +00:00 [DBG] Error Url: /home/error
2025-04-02 11:03:53.098 +00:00 [DBG] Error Id Parameter: errorId
2025-04-02 11:03:53.120 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 11:03:53.125 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 11:03:53.126 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 11:03:53.130 +00:00 [DBG] Start discovery request
2025-04-02 11:03:53.284 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 11:03:53.286 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 11:03:53.294 +00:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2025-04-02 11:03:53.328 +00:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2025-04-02 11:03:53.329 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2025-04-02 11:03:53.340 +00:00 [DBG] Start authorize request
2025-04-02 11:03:53.365 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 11:03:53.373 +00:00 [DBG] No user present in authorize request
2025-04-02 11:03:53.376 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 11:03:53.389 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 11:03:53.421 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 11:03:53.440 +00:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","AllowedRedirectUris":["http://localhost:3000/signin-oidc"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email doughnutapi","State":"a09e7efd91fd44cea44f27802d7e767c","UiLocales":null,"Nonce":"a1dfb64de1224539874ef12277918990","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"wewantdoughnuts","redirect_uri":"http://localhost:3000/signin-oidc","response_type":"id_token token","scope":"openid profile email doughnutapi","state":"a09e7efd91fd44cea44f27802d7e767c","nonce":"a1dfb64de1224539874ef12277918990"},"$type":"AuthorizeRequestValidationLog"}
2025-04-02 11:03:53.455 +00:00 [INF] Showing login: User is not authenticated
2025-04-02 11:03:53.483 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 11:03:53.486 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 11:03:53.537 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 11:03:53.537 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 11:03:53.538 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 11:03:53.540 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 11:03:53.544 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 11:03:55.403 +00:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2025-04-02 11:03:55.406 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 11:03:55.407 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 11:03:55.464 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 11:03:55.465 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 11:03:55.466 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 11:03:55.468 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 11:03:55.491 +00:00 [INF] {"Username":"alice","Provider":null,"ProviderUserId":null,"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","DisplayName":"alice","Endpoint":"UI","ClientId":"wewantdoughnuts","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HNBHQO70QLLR:00000013","TimeStamp":"2025-04-02T11:03:55.0000000Z","ProcessId":1931,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"UserLoginSuccessEvent"}
2025-04-02 11:03:55.496 +00:00 [DBG] Augmenting SignInContext
2025-04-02 11:03:55.498 +00:00 [DBG] Adding idp claim with value: local
2025-04-02 11:03:55.499 +00:00 [DBG] Adding amr claim with value: pwd
2025-04-02 11:03:55.502 +00:00 [DBG] Adding auth_time claim with value: 1743591835
2025-04-02 11:03:55.506 +00:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2025-04-02 11:03:55.514 +00:00 [INF] AuthenticationScheme: idsrv signed in.
2025-04-02 11:03:55.543 +00:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2025-04-02 11:03:55.546 +00:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2025-04-02 11:03:55.546 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2025-04-02 11:03:55.551 +00:00 [DBG] Start authorize callback request
2025-04-02 11:03:55.569 +00:00 [DBG] User in authorize request: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 11:03:55.569 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 11:03:55.570 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 11:03:55.571 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 11:03:55.574 +00:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","AllowedRedirectUris":["http://localhost:3000/signin-oidc"],"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email doughnutapi","State":"a09e7efd91fd44cea44f27802d7e767c","UiLocales":null,"Nonce":"a1dfb64de1224539874ef12277918990","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"C566E14DFD0D2F6B63A521370E719C73","Raw":{"client_id":"wewantdoughnuts","redirect_uri":"http://localhost:3000/signin-oidc","response_type":"id_token token","scope":"openid profile email doughnutapi","state":"a09e7efd91fd44cea44f27802d7e767c","nonce":"a1dfb64de1224539874ef12277918990"},"$type":"AuthorizeRequestValidationLog"}
2025-04-02 11:03:55.582 +00:00 [DBG] Client is configured to not require consent, no consent is required
2025-04-02 11:03:55.587 +00:00 [DBG] Creating Implicit Flow response.
2025-04-02 11:03:55.598 +00:00 [DBG] Getting claims for access token for client: wewantdoughnuts
2025-04-02 11:03:55.600 +00:00 [DBG] Getting claims for access token for subject: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 11:03:55.685 +00:00 [DBG] Getting claims for identity token for subject: 42006211-B900-4701-A6F8-2986370C3563 and client: wewantdoughnuts
2025-04-02 11:03:55.685 +00:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2025-04-02 11:03:55.693 +00:00 [INF] {"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","Endpoint":"Authorize","SubjectId":"42006211-B900-4701-A6F8-2986370C3563","Scopes":"openid profile email doughnutapi","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****1kGw","$type":"Token"},{"TokenType":"access_token","TokenValue":"****Q9LQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HNBHQO70QLLR:00000015","TimeStamp":"2025-04-02T11:03:55.0000000Z","ProcessId":1931,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"TokenIssuedSuccessEvent"}
2025-04-02 11:03:55.696 +00:00 [DBG] Authorize endpoint response
{"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ClientId":"wewantdoughnuts","RedirectUri":"http://localhost:3000/signin-oidc","State":"a09e7efd91fd44cea44f27802d7e767c","Scope":"openid profile email doughnutapi","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2025-04-02 11:03:55.705 +00:00 [DBG] Augmenting SignInContext
2025-04-02 11:03:55.706 +00:00 [INF] AuthenticationScheme: idsrv signed in.
2025-04-02 11:03:56.941 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 11:03:56.947 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 11:03:56.965 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 11:03:56.982 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 11:03:56.995 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 11:03:57.001 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 11:03:57.006 +00:00 [DBG] Start discovery request
2025-04-02 11:03:57.049 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:3000
2025-04-02 11:03:57.052 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 11:03:57.053 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 11:03:57.055 +00:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2025-04-02 11:03:57.057 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2025-04-02 11:03:57.059 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2025-04-02 11:03:57.064 +00:00 [DBG] Start key discovery request
2025-04-02 11:03:57.115 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 11:03:57.116 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 11:03:57.120 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 11:03:57.135 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 11:03:57.136 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 11:03:57.136 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 11:03:57.138 +00:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2025-04-02 11:03:57.141 +00:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2025-04-02 11:03:57.142 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2025-04-02 11:03:57.147 +00:00 [DBG] Start userinfo request
2025-04-02 11:03:57.155 +00:00 [DBG] Bearer token found in header
2025-04-02 11:03:57.213 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 11:03:57.215 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 11:03:57.217 +00:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2025-04-02 11:03:57.222 +00:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":"8A1A49334A82D86288BF5E2681FC7DCF","Claims":{"nbf":1743591835,"exp":1743595435,"iss":"https://webapi:8081","aud":["doughnutapi","https://webapi:8081/resources"],"client_id":"wewantdoughnuts","sub":"42006211-B900-4701-A6F8-2986370C3563","auth_time":1743591835,"idp":"local","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress":"AliceSmith@email.com","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname":"Alice","jti":"8A1A49334A82D86288BF5E2681FC7DCF","sid":"C566E14DFD0D2F6B63A521370E719C73","iat":1743591835,"scope":["openid","profile","email","doughnutapi"],"amr":"pwd"},"$type":"TokenValidationLog"}
2025-04-02 11:03:57.228 +00:00 [DBG] Creating userinfo response
2025-04-02 11:03:57.230 +00:00 [DBG] Scopes in access token: openid profile email doughnutapi
2025-04-02 11:03:57.234 +00:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2025-04-02 11:03:57.236 +00:00 [INF] Profile service returned the following claim types: email given_name
2025-04-02 11:03:57.240 +00:00 [DBG] End userinfo request
2025-04-02 11:03:57.315 +00:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2025-04-02 11:03:57.315 +00:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2025-04-02 11:03:57.316 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2025-04-02 11:03:57.318 +00:00 [DBG] Rendering check session result
2025-04-02 11:03:59.250 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 11:03:59.254 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 11:03:59.255 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 11:03:59.255 +00:00 [DBG] Start discovery request
2025-04-02 11:03:59.311 +00:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2025-04-02 11:03:59.312 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2025-04-02 11:03:59.314 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2025-04-02 11:03:59.315 +00:00 [DBG] Start key discovery request
2025-04-02 11:04:46.931 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 11:04:46.955 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 11:04:46.959 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 11:04:46.960 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 11:04:46.960 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 11:04:46.961 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 11:04:46.962 +00:00 [DBG] Start discovery request
2025-04-02 11:04:47.026 +00:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2025-04-02 11:04:47.027 +00:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2025-04-02 11:04:47.028 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2025-04-02 11:04:47.031 +00:00 [DBG] Start authorize request
2025-04-02 11:04:47.037 +00:00 [DBG] User in authorize request: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 11:04:47.040 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 11:04:47.041 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 11:04:47.043 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 11:04:47.044 +00:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","AllowedRedirectUris":["http://localhost:3000/signin-oidc"],"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email doughnutapi","State":"fbd09f73b3094837bc1a7f67e9d06189","UiLocales":null,"Nonce":"f1822e831da946d4bd8e7557a382c9a2","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"C566E14DFD0D2F6B63A521370E719C73","Raw":{"client_id":"wewantdoughnuts","redirect_uri":"http://localhost:3000/signin-oidc","response_type":"id_token token","scope":"openid profile email doughnutapi","state":"fbd09f73b3094837bc1a7f67e9d06189","nonce":"f1822e831da946d4bd8e7557a382c9a2"},"$type":"AuthorizeRequestValidationLog"}
2025-04-02 11:04:47.047 +00:00 [DBG] Client is configured to not require consent, no consent is required
2025-04-02 11:04:47.048 +00:00 [DBG] Creating Implicit Flow response.
2025-04-02 11:04:47.051 +00:00 [DBG] Getting claims for access token for client: wewantdoughnuts
2025-04-02 11:04:47.055 +00:00 [DBG] Getting claims for access token for subject: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 11:04:47.061 +00:00 [DBG] Getting claims for identity token for subject: 42006211-B900-4701-A6F8-2986370C3563 and client: wewantdoughnuts
2025-04-02 11:04:47.061 +00:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2025-04-02 11:04:47.075 +00:00 [INF] {"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","Endpoint":"Authorize","SubjectId":"42006211-B900-4701-A6F8-2986370C3563","Scopes":"openid profile email doughnutapi","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****jT8Q","$type":"Token"},{"TokenType":"access_token","TokenValue":"****9hkw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HNBHQO70QLLR:00000017","TimeStamp":"2025-04-02T11:04:47.0000000Z","ProcessId":1931,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"TokenIssuedSuccessEvent"}
2025-04-02 11:04:47.076 +00:00 [DBG] Authorize endpoint response
{"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ClientId":"wewantdoughnuts","RedirectUri":"http://localhost:3000/signin-oidc","State":"fbd09f73b3094837bc1a7f67e9d06189","Scope":"openid profile email doughnutapi","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2025-04-02 11:04:47.975 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 11:04:47.976 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 11:04:47.988 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 11:04:47.996 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 11:04:48.003 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 11:04:48.008 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 11:04:48.010 +00:00 [DBG] Start discovery request
2025-04-02 11:04:48.032 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:3000
2025-04-02 11:04:48.033 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 11:04:48.034 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 11:04:48.036 +00:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2025-04-02 11:04:48.040 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2025-04-02 11:04:48.041 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2025-04-02 11:04:48.042 +00:00 [DBG] Start key discovery request
2025-04-02 11:04:48.070 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 11:04:48.071 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 11:04:48.072 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 11:04:48.085 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 11:04:48.087 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 11:04:48.089 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 11:04:48.093 +00:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2025-04-02 11:04:48.129 +00:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2025-04-02 11:04:48.133 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2025-04-02 11:04:48.137 +00:00 [DBG] Start userinfo request
2025-04-02 11:04:48.139 +00:00 [DBG] Bearer token found in header
2025-04-02 11:04:48.146 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 11:04:48.148 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 11:04:48.150 +00:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2025-04-02 11:04:48.160 +00:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":"457D13AC3A7908D63149A48E28DD561F","Claims":{"nbf":1743591887,"exp":1743595487,"iss":"https://webapi:8081","aud":["doughnutapi","https://webapi:8081/resources"],"client_id":"wewantdoughnuts","sub":"42006211-B900-4701-A6F8-2986370C3563","auth_time":1743591835,"idp":"local","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress":"AliceSmith@email.com","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname":"Alice","jti":"457D13AC3A7908D63149A48E28DD561F","sid":"C566E14DFD0D2F6B63A521370E719C73","iat":1743591887,"scope":["openid","profile","email","doughnutapi"],"amr":"pwd"},"$type":"TokenValidationLog"}
2025-04-02 11:04:48.164 +00:00 [DBG] Creating userinfo response
2025-04-02 11:04:48.170 +00:00 [DBG] Scopes in access token: openid profile email doughnutapi
2025-04-02 11:04:48.173 +00:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2025-04-02 11:04:48.174 +00:00 [INF] Profile service returned the following claim types: email given_name
2025-04-02 11:04:48.181 +00:00 [DBG] End userinfo request
2025-04-02 11:04:48.268 +00:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2025-04-02 11:04:48.278 +00:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2025-04-02 11:04:48.291 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2025-04-02 11:04:48.294 +00:00 [DBG] Rendering check session result
2025-04-02 11:05:47.253 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 11:05:47.254 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 11:05:47.257 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 11:05:47.260 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 11:05:47.260 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 11:05:47.262 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 11:05:47.263 +00:00 [DBG] Start discovery request
2025-04-02 11:05:47.302 +00:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2025-04-02 11:05:47.319 +00:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2025-04-02 11:05:47.323 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2025-04-02 11:05:47.326 +00:00 [DBG] Start authorize request
2025-04-02 11:05:47.327 +00:00 [DBG] User in authorize request: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 11:05:47.329 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 11:05:47.330 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 11:05:47.332 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 11:05:47.338 +00:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","AllowedRedirectUris":["http://localhost:3000/signin-oidc"],"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email doughnutapi","State":"e9bea8271f05423e9846c9ee955f18ac","UiLocales":null,"Nonce":"0fde4ddb1ca74e4886339b9ff7bf1cf3","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"C566E14DFD0D2F6B63A521370E719C73","Raw":{"client_id":"wewantdoughnuts","redirect_uri":"http://localhost:3000/signin-oidc","response_type":"id_token token","scope":"openid profile email doughnutapi","state":"e9bea8271f05423e9846c9ee955f18ac","nonce":"0fde4ddb1ca74e4886339b9ff7bf1cf3"},"$type":"AuthorizeRequestValidationLog"}
2025-04-02 11:05:47.340 +00:00 [DBG] Client is configured to not require consent, no consent is required
2025-04-02 11:05:47.342 +00:00 [DBG] Creating Implicit Flow response.
2025-04-02 11:05:47.343 +00:00 [DBG] Getting claims for access token for client: wewantdoughnuts
2025-04-02 11:05:47.344 +00:00 [DBG] Getting claims for access token for subject: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 11:05:47.348 +00:00 [DBG] Getting claims for identity token for subject: 42006211-B900-4701-A6F8-2986370C3563 and client: wewantdoughnuts
2025-04-02 11:05:47.349 +00:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2025-04-02 11:05:47.352 +00:00 [INF] {"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","Endpoint":"Authorize","SubjectId":"42006211-B900-4701-A6F8-2986370C3563","Scopes":"openid profile email doughnutapi","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****wKzA","$type":"Token"},{"TokenType":"access_token","TokenValue":"****QcLg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HNBHQO70QLLR:00000019","TimeStamp":"2025-04-02T11:05:47.0000000Z","ProcessId":1931,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"TokenIssuedSuccessEvent"}
2025-04-02 11:05:47.353 +00:00 [DBG] Authorize endpoint response
{"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ClientId":"wewantdoughnuts","RedirectUri":"http://localhost:3000/signin-oidc","State":"e9bea8271f05423e9846c9ee955f18ac","Scope":"openid profile email doughnutapi","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2025-04-02 11:05:48.317 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 11:05:48.330 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 11:05:48.334 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 11:05:48.339 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 11:05:48.344 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 11:05:48.346 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 11:05:48.351 +00:00 [DBG] Start discovery request
2025-04-02 11:05:48.373 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:3000
2025-04-02 11:05:48.378 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 11:05:48.380 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 11:05:48.381 +00:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2025-04-02 11:05:48.384 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2025-04-02 11:05:48.389 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2025-04-02 11:05:48.417 +00:00 [DBG] Start key discovery request
2025-04-02 11:05:48.499 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 11:05:48.501 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 11:05:48.503 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 11:05:48.523 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 11:05:48.524 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 11:05:48.526 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 11:05:48.528 +00:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2025-04-02 11:05:48.539 +00:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2025-04-02 11:05:48.539 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2025-04-02 11:05:48.541 +00:00 [DBG] Start userinfo request
2025-04-02 11:05:48.542 +00:00 [DBG] Bearer token found in header
2025-04-02 11:05:48.545 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 11:05:48.549 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 11:05:48.550 +00:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2025-04-02 11:05:48.551 +00:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":"A80E917E6477A118E78E2E4155383280","Claims":{"nbf":1743591947,"exp":1743595547,"iss":"https://webapi:8081","aud":["doughnutapi","https://webapi:8081/resources"],"client_id":"wewantdoughnuts","sub":"42006211-B900-4701-A6F8-2986370C3563","auth_time":1743591835,"idp":"local","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress":"AliceSmith@email.com","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname":"Alice","jti":"A80E917E6477A118E78E2E4155383280","sid":"C566E14DFD0D2F6B63A521370E719C73","iat":1743591947,"scope":["openid","profile","email","doughnutapi"],"amr":"pwd"},"$type":"TokenValidationLog"}
2025-04-02 11:05:48.554 +00:00 [DBG] Creating userinfo response
2025-04-02 11:05:48.555 +00:00 [DBG] Scopes in access token: openid profile email doughnutapi
2025-04-02 11:05:48.555 +00:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2025-04-02 11:05:48.556 +00:00 [INF] Profile service returned the following claim types: email given_name
2025-04-02 11:05:48.556 +00:00 [DBG] End userinfo request
2025-04-02 11:05:48.649 +00:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2025-04-02 11:05:48.650 +00:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2025-04-02 11:05:48.651 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2025-04-02 11:05:48.654 +00:00 [DBG] Rendering check session result
2025-04-02 11:15:28.160 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 11:15:28.160 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 11:15:28.160 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 11:15:28.162 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 11:15:28.163 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 11:15:28.164 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 11:15:28.165 +00:00 [DBG] Start discovery request
2025-04-02 11:15:28.199 +00:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2025-04-02 11:15:28.200 +00:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2025-04-02 11:15:28.201 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2025-04-02 11:15:28.202 +00:00 [DBG] Start authorize request
2025-04-02 11:15:28.206 +00:00 [DBG] User in authorize request: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 11:15:28.207 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 11:15:28.209 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 11:15:28.212 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 11:15:28.214 +00:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","AllowedRedirectUris":["http://localhost:3000/signin-oidc"],"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email doughnutapi","State":"43de977660254f0792ef2c158a5fb5f0","UiLocales":null,"Nonce":"d7270ff4d4bd48fc80d39229649b9c18","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"C566E14DFD0D2F6B63A521370E719C73","Raw":{"client_id":"wewantdoughnuts","redirect_uri":"http://localhost:3000/signin-oidc","response_type":"id_token token","scope":"openid profile email doughnutapi","state":"43de977660254f0792ef2c158a5fb5f0","nonce":"d7270ff4d4bd48fc80d39229649b9c18"},"$type":"AuthorizeRequestValidationLog"}
2025-04-02 11:15:28.215 +00:00 [DBG] Client is configured to not require consent, no consent is required
2025-04-02 11:15:28.217 +00:00 [DBG] Creating Implicit Flow response.
2025-04-02 11:15:28.218 +00:00 [DBG] Getting claims for access token for client: wewantdoughnuts
2025-04-02 11:15:28.219 +00:00 [DBG] Getting claims for access token for subject: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 11:15:28.222 +00:00 [DBG] Getting claims for identity token for subject: 42006211-B900-4701-A6F8-2986370C3563 and client: wewantdoughnuts
2025-04-02 11:15:28.227 +00:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2025-04-02 11:15:28.230 +00:00 [INF] {"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","Endpoint":"Authorize","SubjectId":"42006211-B900-4701-A6F8-2986370C3563","Scopes":"openid profile email doughnutapi","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****P94A","$type":"Token"},{"TokenType":"access_token","TokenValue":"****tTvg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HNBHQO70QLLR:0000001B","TimeStamp":"2025-04-02T11:15:28.0000000Z","ProcessId":1931,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"TokenIssuedSuccessEvent"}
2025-04-02 11:15:28.230 +00:00 [DBG] Authorize endpoint response
{"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ClientId":"wewantdoughnuts","RedirectUri":"http://localhost:3000/signin-oidc","State":"43de977660254f0792ef2c158a5fb5f0","Scope":"openid profile email doughnutapi","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2025-04-02 11:15:28.990 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 11:15:29.016 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 11:15:29.026 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 11:15:29.029 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 11:15:29.031 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 11:15:29.035 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 11:15:29.039 +00:00 [DBG] Start discovery request
2025-04-02 11:15:29.074 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:3000
2025-04-02 11:15:29.076 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 11:15:29.077 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 11:15:29.080 +00:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2025-04-02 11:15:29.082 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2025-04-02 11:15:29.082 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2025-04-02 11:15:29.083 +00:00 [DBG] Start key discovery request
2025-04-02 11:15:29.141 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 11:15:29.142 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 11:15:29.143 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 11:15:29.161 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 11:15:29.162 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 11:15:29.163 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 11:15:29.165 +00:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2025-04-02 11:15:29.167 +00:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2025-04-02 11:15:29.168 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2025-04-02 11:15:29.169 +00:00 [DBG] Start userinfo request
2025-04-02 11:15:29.171 +00:00 [DBG] Bearer token found in header
2025-04-02 11:15:29.175 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 11:15:29.181 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 11:15:29.183 +00:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2025-04-02 11:15:29.184 +00:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":"E29F925C741E44F0639D2C390688E01F","Claims":{"nbf":1743592528,"exp":1743596128,"iss":"https://webapi:8081","aud":["doughnutapi","https://webapi:8081/resources"],"client_id":"wewantdoughnuts","sub":"42006211-B900-4701-A6F8-2986370C3563","auth_time":1743591835,"idp":"local","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress":"AliceSmith@email.com","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname":"Alice","jti":"E29F925C741E44F0639D2C390688E01F","sid":"C566E14DFD0D2F6B63A521370E719C73","iat":1743592528,"scope":["openid","profile","email","doughnutapi"],"amr":"pwd"},"$type":"TokenValidationLog"}
2025-04-02 11:15:29.188 +00:00 [DBG] Creating userinfo response
2025-04-02 11:15:29.190 +00:00 [DBG] Scopes in access token: openid profile email doughnutapi
2025-04-02 11:15:29.196 +00:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2025-04-02 11:15:29.200 +00:00 [INF] Profile service returned the following claim types: email given_name
2025-04-02 11:15:29.205 +00:00 [DBG] End userinfo request
2025-04-02 11:15:29.272 +00:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2025-04-02 11:15:29.278 +00:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2025-04-02 11:15:29.287 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2025-04-02 11:15:29.296 +00:00 [DBG] Rendering check session result
2025-04-02 11:31:09.904 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 11:31:09.905 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 11:31:09.906 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 11:31:09.907 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 11:31:09.908 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 11:31:09.909 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 11:31:09.910 +00:00 [DBG] Start discovery request
2025-04-02 11:31:09.946 +00:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2025-04-02 11:31:09.946 +00:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2025-04-02 11:31:09.946 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2025-04-02 11:31:09.947 +00:00 [DBG] Start authorize request
2025-04-02 11:31:09.951 +00:00 [DBG] User in authorize request: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 11:31:09.952 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 11:31:09.954 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 11:31:09.955 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 11:31:09.956 +00:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","AllowedRedirectUris":["http://localhost:3000/signin-oidc"],"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email doughnutapi","State":"156293d4e8ca40bdaeb503f9643fd320","UiLocales":null,"Nonce":"4efa758d4ccb448eba31a0a2671d0eab","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"C566E14DFD0D2F6B63A521370E719C73","Raw":{"client_id":"wewantdoughnuts","redirect_uri":"http://localhost:3000/signin-oidc","response_type":"id_token token","scope":"openid profile email doughnutapi","state":"156293d4e8ca40bdaeb503f9643fd320","nonce":"4efa758d4ccb448eba31a0a2671d0eab"},"$type":"AuthorizeRequestValidationLog"}
2025-04-02 11:31:09.957 +00:00 [DBG] Client is configured to not require consent, no consent is required
2025-04-02 11:31:09.958 +00:00 [DBG] Creating Implicit Flow response.
2025-04-02 11:31:09.959 +00:00 [DBG] Getting claims for access token for client: wewantdoughnuts
2025-04-02 11:31:09.959 +00:00 [DBG] Getting claims for access token for subject: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 11:31:09.962 +00:00 [DBG] Getting claims for identity token for subject: 42006211-B900-4701-A6F8-2986370C3563 and client: wewantdoughnuts
2025-04-02 11:31:09.963 +00:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2025-04-02 11:31:09.965 +00:00 [INF] {"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","Endpoint":"Authorize","SubjectId":"42006211-B900-4701-A6F8-2986370C3563","Scopes":"openid profile email doughnutapi","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****psYw","$type":"Token"},{"TokenType":"access_token","TokenValue":"****wdIg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HNBHQO70QLLR:0000001D","TimeStamp":"2025-04-02T11:31:09.0000000Z","ProcessId":1931,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"TokenIssuedSuccessEvent"}
2025-04-02 11:31:09.965 +00:00 [DBG] Authorize endpoint response
{"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ClientId":"wewantdoughnuts","RedirectUri":"http://localhost:3000/signin-oidc","State":"156293d4e8ca40bdaeb503f9643fd320","Scope":"openid profile email doughnutapi","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2025-04-02 11:31:10.285 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 11:31:10.286 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 11:31:10.287 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 11:31:10.288 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 11:31:10.289 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 11:31:10.290 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 11:31:10.292 +00:00 [DBG] Start discovery request
2025-04-02 11:31:10.325 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:3000
2025-04-02 11:31:10.325 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 11:31:10.326 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 11:31:10.326 +00:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2025-04-02 11:31:10.327 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2025-04-02 11:31:10.328 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2025-04-02 11:31:10.329 +00:00 [DBG] Start key discovery request
2025-04-02 11:31:10.358 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 11:31:10.359 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 11:31:10.359 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 11:31:10.372 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 11:31:10.373 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 11:31:10.374 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 11:31:10.374 +00:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2025-04-02 11:31:10.375 +00:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2025-04-02 11:31:10.376 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2025-04-02 11:31:10.376 +00:00 [DBG] Start userinfo request
2025-04-02 11:31:10.378 +00:00 [DBG] Bearer token found in header
2025-04-02 11:31:10.379 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 11:31:10.380 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 11:31:10.381 +00:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2025-04-02 11:31:10.382 +00:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":"618233506FEBDAB772CAA8042DB0AB18","Claims":{"nbf":1743593469,"exp":1743597069,"iss":"https://webapi:8081","aud":["doughnutapi","https://webapi:8081/resources"],"client_id":"wewantdoughnuts","sub":"42006211-B900-4701-A6F8-2986370C3563","auth_time":1743591835,"idp":"local","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress":"AliceSmith@email.com","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname":"Alice","jti":"618233506FEBDAB772CAA8042DB0AB18","sid":"C566E14DFD0D2F6B63A521370E719C73","iat":1743593469,"scope":["openid","profile","email","doughnutapi"],"amr":"pwd"},"$type":"TokenValidationLog"}
2025-04-02 11:31:10.384 +00:00 [DBG] Creating userinfo response
2025-04-02 11:31:10.387 +00:00 [DBG] Scopes in access token: openid profile email doughnutapi
2025-04-02 11:31:10.390 +00:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2025-04-02 11:31:10.390 +00:00 [INF] Profile service returned the following claim types: email given_name
2025-04-02 11:31:10.393 +00:00 [DBG] End userinfo request
2025-04-02 11:31:10.453 +00:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2025-04-02 11:31:10.454 +00:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2025-04-02 11:31:10.457 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2025-04-02 11:31:10.458 +00:00 [DBG] Rendering check session result
2025-04-02 11:32:21.804 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 11:32:21.806 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 11:32:21.807 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 11:32:21.808 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 11:32:21.810 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 11:32:21.811 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 11:32:21.813 +00:00 [DBG] Start discovery request
2025-04-02 11:32:21.861 +00:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2025-04-02 11:32:21.861 +00:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2025-04-02 11:32:21.862 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2025-04-02 11:32:21.863 +00:00 [DBG] Start authorize request
2025-04-02 11:32:21.864 +00:00 [DBG] User in authorize request: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 11:32:21.867 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 11:32:21.869 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 11:32:21.870 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 11:32:21.870 +00:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","AllowedRedirectUris":["http://localhost:3000/signin-oidc"],"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email doughnutapi","State":"193a0c070d6c4341a29db5e2e2aa054a","UiLocales":null,"Nonce":"fc1de59aa91c49989bf32a68579c0094","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"C566E14DFD0D2F6B63A521370E719C73","Raw":{"client_id":"wewantdoughnuts","redirect_uri":"http://localhost:3000/signin-oidc","response_type":"id_token token","scope":"openid profile email doughnutapi","state":"193a0c070d6c4341a29db5e2e2aa054a","nonce":"fc1de59aa91c49989bf32a68579c0094"},"$type":"AuthorizeRequestValidationLog"}
2025-04-02 11:32:21.871 +00:00 [DBG] Client is configured to not require consent, no consent is required
2025-04-02 11:32:21.872 +00:00 [DBG] Creating Implicit Flow response.
2025-04-02 11:32:21.873 +00:00 [DBG] Getting claims for access token for client: wewantdoughnuts
2025-04-02 11:32:21.873 +00:00 [DBG] Getting claims for access token for subject: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 11:32:21.877 +00:00 [DBG] Getting claims for identity token for subject: 42006211-B900-4701-A6F8-2986370C3563 and client: wewantdoughnuts
2025-04-02 11:32:21.879 +00:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2025-04-02 11:32:21.882 +00:00 [INF] {"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","Endpoint":"Authorize","SubjectId":"42006211-B900-4701-A6F8-2986370C3563","Scopes":"openid profile email doughnutapi","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****dV1Q","$type":"Token"},{"TokenType":"access_token","TokenValue":"****HJpQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HNBHQO70QLLR:0000001F","TimeStamp":"2025-04-02T11:32:21.0000000Z","ProcessId":1931,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"TokenIssuedSuccessEvent"}
2025-04-02 11:32:21.883 +00:00 [DBG] Authorize endpoint response
{"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ClientId":"wewantdoughnuts","RedirectUri":"http://localhost:3000/signin-oidc","State":"193a0c070d6c4341a29db5e2e2aa054a","Scope":"openid profile email doughnutapi","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2025-04-02 11:32:22.289 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 11:32:22.290 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 11:32:22.291 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 11:32:22.293 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 11:32:22.294 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 11:32:22.295 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 11:32:22.296 +00:00 [DBG] Start discovery request
2025-04-02 11:32:22.343 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:3000
2025-04-02 11:32:22.344 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 11:32:22.345 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 11:32:22.346 +00:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2025-04-02 11:32:22.347 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2025-04-02 11:32:22.349 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2025-04-02 11:32:22.350 +00:00 [DBG] Start key discovery request
2025-04-02 11:32:22.385 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 11:32:22.385 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 11:32:22.386 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 11:32:22.438 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 11:32:22.439 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 11:32:22.440 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 11:32:22.441 +00:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2025-04-02 11:32:22.443 +00:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2025-04-02 11:32:22.444 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2025-04-02 11:32:22.445 +00:00 [DBG] Start userinfo request
2025-04-02 11:32:22.446 +00:00 [DBG] Bearer token found in header
2025-04-02 11:32:22.448 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 11:32:22.448 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 11:32:22.449 +00:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2025-04-02 11:32:22.450 +00:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":"B6A3A2812BAABDFD50A7BA721E6FCE3A","Claims":{"nbf":1743593541,"exp":1743597141,"iss":"https://webapi:8081","aud":["doughnutapi","https://webapi:8081/resources"],"client_id":"wewantdoughnuts","sub":"42006211-B900-4701-A6F8-2986370C3563","auth_time":1743591835,"idp":"local","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress":"AliceSmith@email.com","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname":"Alice","jti":"B6A3A2812BAABDFD50A7BA721E6FCE3A","sid":"C566E14DFD0D2F6B63A521370E719C73","iat":1743593541,"scope":["openid","profile","email","doughnutapi"],"amr":"pwd"},"$type":"TokenValidationLog"}
2025-04-02 11:32:22.451 +00:00 [DBG] Creating userinfo response
2025-04-02 11:32:22.452 +00:00 [DBG] Scopes in access token: openid profile email doughnutapi
2025-04-02 11:32:22.453 +00:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2025-04-02 11:32:22.455 +00:00 [INF] Profile service returned the following claim types: email given_name
2025-04-02 11:32:22.461 +00:00 [DBG] End userinfo request
2025-04-02 11:32:22.516 +00:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2025-04-02 11:32:22.517 +00:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2025-04-02 11:32:22.517 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2025-04-02 11:32:22.519 +00:00 [DBG] Rendering check session result
2025-04-02 11:48:19.874 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 11:48:19.875 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 11:48:19.879 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 11:48:19.882 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 11:48:19.883 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 11:48:19.885 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 11:48:19.886 +00:00 [DBG] Start discovery request
2025-04-02 11:48:19.921 +00:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2025-04-02 11:48:19.922 +00:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2025-04-02 11:48:19.922 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2025-04-02 11:48:19.923 +00:00 [DBG] Start authorize request
2025-04-02 11:48:19.925 +00:00 [DBG] User in authorize request: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 11:48:19.926 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 11:48:19.927 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 11:48:19.930 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 11:48:19.933 +00:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","AllowedRedirectUris":["http://localhost:3000/signin-oidc"],"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email doughnutapi","State":"759b1de60a7d432ca7210fb182d1b207","UiLocales":null,"Nonce":"a1ced4f4fbd34f0ba862c87094121728","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"C566E14DFD0D2F6B63A521370E719C73","Raw":{"client_id":"wewantdoughnuts","redirect_uri":"http://localhost:3000/signin-oidc","response_type":"id_token token","scope":"openid profile email doughnutapi","state":"759b1de60a7d432ca7210fb182d1b207","nonce":"a1ced4f4fbd34f0ba862c87094121728"},"$type":"AuthorizeRequestValidationLog"}
2025-04-02 11:48:19.934 +00:00 [DBG] Client is configured to not require consent, no consent is required
2025-04-02 11:48:19.937 +00:00 [DBG] Creating Implicit Flow response.
2025-04-02 11:48:19.939 +00:00 [DBG] Getting claims for access token for client: wewantdoughnuts
2025-04-02 11:48:19.940 +00:00 [DBG] Getting claims for access token for subject: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 11:48:19.944 +00:00 [DBG] Getting claims for identity token for subject: 42006211-B900-4701-A6F8-2986370C3563 and client: wewantdoughnuts
2025-04-02 11:48:19.944 +00:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2025-04-02 11:48:19.947 +00:00 [INF] {"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","Endpoint":"Authorize","SubjectId":"42006211-B900-4701-A6F8-2986370C3563","Scopes":"openid profile email doughnutapi","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****whrw","$type":"Token"},{"TokenType":"access_token","TokenValue":"****AgMw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HNBHQO70QLLR:00000021","TimeStamp":"2025-04-02T11:48:19.0000000Z","ProcessId":1931,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"TokenIssuedSuccessEvent"}
2025-04-02 11:48:19.947 +00:00 [DBG] Authorize endpoint response
{"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ClientId":"wewantdoughnuts","RedirectUri":"http://localhost:3000/signin-oidc","State":"759b1de60a7d432ca7210fb182d1b207","Scope":"openid profile email doughnutapi","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2025-04-02 11:48:20.777 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 11:48:20.792 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 11:48:20.802 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 11:48:20.806 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 11:48:20.820 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 11:48:20.828 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 11:48:20.830 +00:00 [DBG] Start discovery request
2025-04-02 11:48:20.892 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:3000
2025-04-02 11:48:20.893 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 11:48:20.894 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 11:48:20.895 +00:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2025-04-02 11:48:20.896 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2025-04-02 11:48:20.900 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2025-04-02 11:48:20.902 +00:00 [DBG] Start key discovery request
2025-04-02 11:48:20.934 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 11:48:20.936 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 11:48:20.936 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 11:48:20.948 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 11:48:20.949 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 11:48:20.950 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 11:48:20.952 +00:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2025-04-02 11:48:20.954 +00:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2025-04-02 11:48:20.956 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2025-04-02 11:48:20.958 +00:00 [DBG] Start userinfo request
2025-04-02 11:48:20.959 +00:00 [DBG] Bearer token found in header
2025-04-02 11:48:20.962 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 11:48:20.963 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 11:48:20.966 +00:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2025-04-02 11:48:20.968 +00:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":"E6BE6CB70FEF7A2F4E6A5756B94C162A","Claims":{"nbf":1743594499,"exp":1743598099,"iss":"https://webapi:8081","aud":["doughnutapi","https://webapi:8081/resources"],"client_id":"wewantdoughnuts","sub":"42006211-B900-4701-A6F8-2986370C3563","auth_time":1743591835,"idp":"local","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress":"AliceSmith@email.com","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname":"Alice","jti":"E6BE6CB70FEF7A2F4E6A5756B94C162A","sid":"C566E14DFD0D2F6B63A521370E719C73","iat":1743594499,"scope":["openid","profile","email","doughnutapi"],"amr":"pwd"},"$type":"TokenValidationLog"}
2025-04-02 11:48:20.969 +00:00 [DBG] Creating userinfo response
2025-04-02 11:48:20.971 +00:00 [DBG] Scopes in access token: openid profile email doughnutapi
2025-04-02 11:48:20.976 +00:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2025-04-02 11:48:20.978 +00:00 [INF] Profile service returned the following claim types: email given_name
2025-04-02 11:48:20.979 +00:00 [DBG] End userinfo request
2025-04-02 11:48:21.132 +00:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2025-04-02 11:48:21.133 +00:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2025-04-02 11:48:21.133 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2025-04-02 11:48:21.133 +00:00 [DBG] Rendering check session result
2025-04-02 12:24:15.700 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 12:24:15.784 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 12:24:15.784 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 12:24:15.785 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 12:24:15.786 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 12:24:15.786 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 12:24:15.788 +00:00 [DBG] Start discovery request
2025-04-02 12:24:15.849 +00:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2025-04-02 12:24:15.851 +00:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2025-04-02 12:24:15.872 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2025-04-02 12:24:15.895 +00:00 [DBG] Start authorize request
2025-04-02 12:24:15.896 +00:00 [DBG] No user present in authorize request
2025-04-02 12:24:15.897 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 12:24:15.899 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 12:24:15.901 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 12:24:15.902 +00:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","AllowedRedirectUris":["http://localhost:3000/signin-oidc"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email doughnutapi","State":"a9531e6bbf4e41688a21aa1865c2995b","UiLocales":null,"Nonce":"4cd5e0b4556f4d458445f8d1a47e193a","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"wewantdoughnuts","redirect_uri":"http://localhost:3000/signin-oidc","response_type":"id_token token","scope":"openid profile email doughnutapi","state":"a9531e6bbf4e41688a21aa1865c2995b","nonce":"4cd5e0b4556f4d458445f8d1a47e193a"},"$type":"AuthorizeRequestValidationLog"}
2025-04-02 12:24:15.902 +00:00 [INF] Showing login: User is not authenticated
2025-04-02 12:24:15.973 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 12:24:15.974 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 12:24:15.974 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 12:24:15.976 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 12:24:21.219 +00:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2025-04-02 12:24:21.273 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 12:24:21.274 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 12:24:21.276 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 12:24:21.280 +00:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"8FD59FBE-C9F1-443A-8DCA-901C263C29F1","DisplayName":"bob","Endpoint":"UI","ClientId":"wewantdoughnuts","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HNBHQO70QLLV:00000011","TimeStamp":"2025-04-02T12:24:21.0000000Z","ProcessId":1931,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"UserLoginSuccessEvent"}
2025-04-02 12:24:21.280 +00:00 [DBG] Augmenting SignInContext
2025-04-02 12:24:21.281 +00:00 [DBG] Adding idp claim with value: local
2025-04-02 12:24:21.283 +00:00 [DBG] Adding amr claim with value: pwd
2025-04-02 12:24:21.284 +00:00 [DBG] Adding auth_time claim with value: 1743596661
2025-04-02 12:24:21.291 +00:00 [INF] AuthenticationScheme: idsrv signed in.
2025-04-02 12:24:21.335 +00:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2025-04-02 12:24:21.336 +00:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2025-04-02 12:24:21.337 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2025-04-02 12:24:21.338 +00:00 [DBG] Start authorize callback request
2025-04-02 12:24:21.341 +00:00 [DBG] User in authorize request: 8FD59FBE-C9F1-443A-8DCA-901C263C29F1
2025-04-02 12:24:21.341 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 12:24:21.343 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 12:24:21.344 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 12:24:21.345 +00:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","AllowedRedirectUris":["http://localhost:3000/signin-oidc"],"SubjectId":"8FD59FBE-C9F1-443A-8DCA-901C263C29F1","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email doughnutapi","State":"a9531e6bbf4e41688a21aa1865c2995b","UiLocales":null,"Nonce":"4cd5e0b4556f4d458445f8d1a47e193a","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"1A6ACBC46DE85F84E9FB301B54D9DDE7","Raw":{"client_id":"wewantdoughnuts","redirect_uri":"http://localhost:3000/signin-oidc","response_type":"id_token token","scope":"openid profile email doughnutapi","state":"a9531e6bbf4e41688a21aa1865c2995b","nonce":"4cd5e0b4556f4d458445f8d1a47e193a"},"$type":"AuthorizeRequestValidationLog"}
2025-04-02 12:24:21.346 +00:00 [DBG] Client is configured to not require consent, no consent is required
2025-04-02 12:24:21.347 +00:00 [DBG] Creating Implicit Flow response.
2025-04-02 12:24:21.348 +00:00 [DBG] Getting claims for access token for client: wewantdoughnuts
2025-04-02 12:24:21.349 +00:00 [DBG] Getting claims for access token for subject: 8FD59FBE-C9F1-443A-8DCA-901C263C29F1
2025-04-02 12:24:21.352 +00:00 [DBG] Getting claims for identity token for subject: 8FD59FBE-C9F1-443A-8DCA-901C263C29F1 and client: wewantdoughnuts
2025-04-02 12:24:21.352 +00:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2025-04-02 12:24:21.355 +00:00 [INF] {"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","Endpoint":"Authorize","SubjectId":"8FD59FBE-C9F1-443A-8DCA-901C263C29F1","Scopes":"openid profile email doughnutapi","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****6zAQ","$type":"Token"},{"TokenType":"access_token","TokenValue":"****hxIg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HNBHQO70QLLV:00000013","TimeStamp":"2025-04-02T12:24:21.0000000Z","ProcessId":1931,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"TokenIssuedSuccessEvent"}
2025-04-02 12:24:21.355 +00:00 [DBG] Authorize endpoint response
{"SubjectId":"8FD59FBE-C9F1-443A-8DCA-901C263C29F1","ClientId":"wewantdoughnuts","RedirectUri":"http://localhost:3000/signin-oidc","State":"a9531e6bbf4e41688a21aa1865c2995b","Scope":"openid profile email doughnutapi","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2025-04-02 12:24:21.357 +00:00 [DBG] Augmenting SignInContext
2025-04-02 12:24:21.359 +00:00 [INF] AuthenticationScheme: idsrv signed in.
2025-04-02 12:24:22.214 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 12:24:22.215 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 12:24:22.215 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 12:24:22.217 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 12:24:22.218 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 12:24:22.219 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 12:24:22.221 +00:00 [DBG] Start discovery request
2025-04-02 12:24:22.304 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:3000
2025-04-02 12:24:22.305 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 12:24:22.306 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 12:24:22.307 +00:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2025-04-02 12:24:22.308 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2025-04-02 12:24:22.308 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2025-04-02 12:24:22.309 +00:00 [DBG] Start key discovery request
2025-04-02 12:24:22.333 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 12:24:22.354 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 12:24:22.355 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 12:24:22.367 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 12:24:22.368 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 12:24:22.368 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 12:24:22.369 +00:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2025-04-02 12:24:22.369 +00:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2025-04-02 12:24:22.370 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2025-04-02 12:24:22.370 +00:00 [DBG] Start userinfo request
2025-04-02 12:24:22.371 +00:00 [DBG] Bearer token found in header
2025-04-02 12:24:22.374 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 12:24:22.375 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 12:24:22.376 +00:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2025-04-02 12:24:22.377 +00:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":"D8E8487EAA1DC80D71FF9895FD4DBD66","Claims":{"nbf":1743596661,"exp":1743600261,"iss":"https://webapi:8081","aud":["doughnutapi","https://webapi:8081/resources"],"client_id":"wewantdoughnuts","sub":"8FD59FBE-C9F1-443A-8DCA-901C263C29F1","auth_time":1743596661,"idp":"local","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress":"BobSmith@email.com","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname":"Bob","jti":"D8E8487EAA1DC80D71FF9895FD4DBD66","sid":"1A6ACBC46DE85F84E9FB301B54D9DDE7","iat":1743596661,"scope":["openid","profile","email","doughnutapi"],"amr":"pwd"},"$type":"TokenValidationLog"}
2025-04-02 12:24:22.378 +00:00 [DBG] Creating userinfo response
2025-04-02 12:24:22.379 +00:00 [DBG] Scopes in access token: openid profile email doughnutapi
2025-04-02 12:24:22.379 +00:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2025-04-02 12:24:22.380 +00:00 [INF] Profile service returned the following claim types: email given_name
2025-04-02 12:24:22.381 +00:00 [DBG] End userinfo request
2025-04-02 12:24:22.517 +00:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2025-04-02 12:24:22.518 +00:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2025-04-02 12:24:22.518 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2025-04-02 12:24:22.518 +00:00 [DBG] Rendering check session result
2025-04-02 13:44:33.391 +00:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2025-04-02 13:44:33.414 +00:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2025-04-02 13:44:33.416 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2025-04-02 13:44:33.440 +00:00 [DBG] Processing signout request for 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 13:44:33.448 +00:00 [DBG] Start end session request validation
2025-04-02 13:44:33.463 +00:00 [INF] End session request validation success
{"ClientId":null,"ClientName":null,"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","PostLogOutUri":null,"State":null,"Raw":{"post_logout_redirect_uri":"http://localhost:3000/signout-oidc"},"$type":"EndSessionRequestValidationLog"}
2025-04-02 13:44:33.464 +00:00 [DBG] Success validating end session request from null
2025-04-02 13:44:35.512 +00:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2025-04-02 13:44:35.577 +00:00 [INF] AuthenticationScheme: idsrv signed out.
2025-04-02 13:44:35.580 +00:00 [INF] {"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","DisplayName":"alice","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HNBHQO70QLM1:00000013","TimeStamp":"2025-04-02T13:44:35.0000000Z","ProcessId":1931,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"UserLogoutSuccessEvent"}
2025-04-02 13:44:35.592 +00:00 [DBG] SignOutCalled set; processing post-signout session cleanup.
2025-04-02 13:44:35.599 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 13:44:35.600 +00:00 [DBG] No client back-channel logout URLs
2025-04-02 13:44:35.738 +00:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2025-04-02 13:44:35.804 +00:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2025-04-02 13:44:35.825 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2025-04-02 13:44:35.920 +00:00 [DBG] Processing signout callback request
2025-04-02 13:44:35.954 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 13:44:35.978 +00:00 [DBG] No client front-channel logout URLs
2025-04-02 13:44:35.979 +00:00 [INF] Successful signout callback.
2025-04-02 13:44:36.901 +00:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2025-04-02 13:44:36.903 +00:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2025-04-02 13:44:36.905 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2025-04-02 13:44:36.929 +00:00 [DBG] Processing signout callback request
2025-04-02 13:44:36.973 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 13:44:36.994 +00:00 [DBG] No client front-channel logout URLs
2025-04-02 13:44:36.995 +00:00 [INF] Successful signout callback.
2025-04-02 13:44:47.435 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 13:44:47.457 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 13:44:47.458 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 13:44:47.521 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 13:44:47.522 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 13:44:47.523 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 13:44:47.523 +00:00 [DBG] Start discovery request
2025-04-02 13:44:47.583 +00:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2025-04-02 13:44:47.606 +00:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2025-04-02 13:44:47.607 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2025-04-02 13:44:47.608 +00:00 [DBG] Start authorize request
2025-04-02 13:44:47.610 +00:00 [DBG] No user present in authorize request
2025-04-02 13:44:47.611 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 13:44:47.612 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 13:44:47.615 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 13:44:47.616 +00:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","AllowedRedirectUris":["http://localhost:3000/signin-oidc"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email doughnutapi","State":"25f5891bf2444c07878e758c5e37228b","UiLocales":null,"Nonce":"fb0b52d3aa0947e9a3ca671b413ee598","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"wewantdoughnuts","redirect_uri":"http://localhost:3000/signin-oidc","response_type":"id_token token","scope":"openid profile email doughnutapi","state":"25f5891bf2444c07878e758c5e37228b","nonce":"fb0b52d3aa0947e9a3ca671b413ee598"},"$type":"AuthorizeRequestValidationLog"}
2025-04-02 13:44:47.617 +00:00 [INF] Showing login: User is not authenticated
2025-04-02 13:44:47.637 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 13:44:47.638 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 13:44:47.640 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 13:44:47.641 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 13:44:49.324 +00:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2025-04-02 13:44:49.369 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 13:44:49.370 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 13:44:49.373 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 13:44:49.376 +00:00 [INF] {"Username":"alice","Provider":null,"ProviderUserId":null,"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","DisplayName":"alice","Endpoint":"UI","ClientId":"wewantdoughnuts","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HNBHQO70QLM1:00000049","TimeStamp":"2025-04-02T13:44:49.0000000Z","ProcessId":1931,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"UserLoginSuccessEvent"}
2025-04-02 13:44:49.377 +00:00 [DBG] Augmenting SignInContext
2025-04-02 13:44:49.378 +00:00 [DBG] Adding idp claim with value: local
2025-04-02 13:44:49.379 +00:00 [DBG] Adding amr claim with value: pwd
2025-04-02 13:44:49.381 +00:00 [DBG] Adding auth_time claim with value: 1743601489
2025-04-02 13:44:49.383 +00:00 [INF] AuthenticationScheme: idsrv signed in.
2025-04-02 13:44:49.405 +00:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2025-04-02 13:44:49.412 +00:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2025-04-02 13:44:49.413 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2025-04-02 13:44:49.413 +00:00 [DBG] Start authorize callback request
2025-04-02 13:44:49.414 +00:00 [DBG] User in authorize request: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 13:44:49.415 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 13:44:49.416 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 13:44:49.417 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 13:44:49.418 +00:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","AllowedRedirectUris":["http://localhost:3000/signin-oidc"],"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email doughnutapi","State":"25f5891bf2444c07878e758c5e37228b","UiLocales":null,"Nonce":"fb0b52d3aa0947e9a3ca671b413ee598","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"5FEAA00ED4854DF0A51B9F544596FD8F","Raw":{"client_id":"wewantdoughnuts","redirect_uri":"http://localhost:3000/signin-oidc","response_type":"id_token token","scope":"openid profile email doughnutapi","state":"25f5891bf2444c07878e758c5e37228b","nonce":"fb0b52d3aa0947e9a3ca671b413ee598"},"$type":"AuthorizeRequestValidationLog"}
2025-04-02 13:44:49.419 +00:00 [DBG] Client is configured to not require consent, no consent is required
2025-04-02 13:44:49.421 +00:00 [DBG] Creating Implicit Flow response.
2025-04-02 13:44:49.422 +00:00 [DBG] Getting claims for access token for client: wewantdoughnuts
2025-04-02 13:44:49.422 +00:00 [DBG] Getting claims for access token for subject: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 13:44:49.430 +00:00 [DBG] Getting claims for identity token for subject: 42006211-B900-4701-A6F8-2986370C3563 and client: wewantdoughnuts
2025-04-02 13:44:49.431 +00:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2025-04-02 13:44:49.435 +00:00 [INF] {"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","Endpoint":"Authorize","SubjectId":"42006211-B900-4701-A6F8-2986370C3563","Scopes":"openid profile email doughnutapi","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****f9Uw","$type":"Token"},{"TokenType":"access_token","TokenValue":"****OreQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HNBHQO70QLM1:0000004B","TimeStamp":"2025-04-02T13:44:49.0000000Z","ProcessId":1931,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"TokenIssuedSuccessEvent"}
2025-04-02 13:44:49.436 +00:00 [DBG] Authorize endpoint response
{"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ClientId":"wewantdoughnuts","RedirectUri":"http://localhost:3000/signin-oidc","State":"25f5891bf2444c07878e758c5e37228b","Scope":"openid profile email doughnutapi","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2025-04-02 13:44:49.438 +00:00 [DBG] Augmenting SignInContext
2025-04-02 13:44:49.439 +00:00 [INF] AuthenticationScheme: idsrv signed in.
2025-04-02 13:44:50.278 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 13:44:50.293 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 13:44:50.300 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 13:44:50.329 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 13:44:50.344 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 13:44:50.345 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 13:44:50.353 +00:00 [DBG] Start discovery request
2025-04-02 13:44:50.401 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:3000
2025-04-02 13:44:50.404 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 13:44:50.406 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 13:44:50.410 +00:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2025-04-02 13:44:50.414 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2025-04-02 13:44:50.417 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2025-04-02 13:44:50.423 +00:00 [DBG] Start key discovery request
2025-04-02 13:44:50.480 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 13:44:50.502 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 13:44:50.502 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 13:44:50.517 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 13:44:50.519 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 13:44:50.525 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 13:44:50.528 +00:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2025-04-02 13:44:50.530 +00:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2025-04-02 13:44:50.531 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2025-04-02 13:44:50.533 +00:00 [DBG] Start userinfo request
2025-04-02 13:44:50.539 +00:00 [DBG] Bearer token found in header
2025-04-02 13:44:50.555 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 13:44:50.557 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 13:44:50.559 +00:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2025-04-02 13:44:50.563 +00:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":"4E148EF3FC42E883AB6E92220E489D9F","Claims":{"nbf":1743601489,"exp":1743605089,"iss":"https://webapi:8081","aud":["doughnutapi","https://webapi:8081/resources"],"client_id":"wewantdoughnuts","sub":"42006211-B900-4701-A6F8-2986370C3563","auth_time":1743601489,"idp":"local","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress":"AliceSmith@email.com","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname":"Alice","jti":"4E148EF3FC42E883AB6E92220E489D9F","sid":"5FEAA00ED4854DF0A51B9F544596FD8F","iat":1743601489,"scope":["openid","profile","email","doughnutapi"],"amr":"pwd"},"$type":"TokenValidationLog"}
2025-04-02 13:44:50.564 +00:00 [DBG] Creating userinfo response
2025-04-02 13:44:50.567 +00:00 [DBG] Scopes in access token: openid profile email doughnutapi
2025-04-02 13:44:50.571 +00:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2025-04-02 13:44:50.576 +00:00 [INF] Profile service returned the following claim types: email given_name
2025-04-02 13:44:50.580 +00:00 [DBG] End userinfo request
2025-04-02 13:44:50.747 +00:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2025-04-02 13:44:50.748 +00:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2025-04-02 13:44:50.749 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2025-04-02 13:44:50.750 +00:00 [DBG] Rendering check session result
2025-04-02 13:59:12.433 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 13:59:12.461 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 13:59:12.474 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 13:59:12.501 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 13:59:12.503 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 13:59:12.504 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 13:59:12.508 +00:00 [DBG] Start discovery request
2025-04-02 13:59:12.640 +00:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2025-04-02 13:59:12.641 +00:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2025-04-02 13:59:12.642 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2025-04-02 13:59:12.648 +00:00 [DBG] Rendering check session result
2025-04-02 13:59:13.957 +00:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2025-04-02 13:59:14.002 +00:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2025-04-02 13:59:14.004 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2025-04-02 13:59:14.005 +00:00 [DBG] Start authorize request
2025-04-02 13:59:14.006 +00:00 [DBG] User in authorize request: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 13:59:14.007 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 13:59:14.009 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 13:59:14.010 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 13:59:14.013 +00:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","AllowedRedirectUris":["http://localhost:3000/signin-oidc"],"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email doughnutapi","State":"0b3c88d4ee714ba7b924377be8822050","UiLocales":null,"Nonce":"2bbaa8b5113c47a18e501148b90049ae","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"5FEAA00ED4854DF0A51B9F544596FD8F","Raw":{"client_id":"wewantdoughnuts","redirect_uri":"http://localhost:3000/signin-oidc","response_type":"id_token token","scope":"openid profile email doughnutapi","state":"0b3c88d4ee714ba7b924377be8822050","nonce":"2bbaa8b5113c47a18e501148b90049ae"},"$type":"AuthorizeRequestValidationLog"}
2025-04-02 13:59:14.014 +00:00 [DBG] Client is configured to not require consent, no consent is required
2025-04-02 13:59:14.015 +00:00 [DBG] Creating Implicit Flow response.
2025-04-02 13:59:14.016 +00:00 [DBG] Getting claims for access token for client: wewantdoughnuts
2025-04-02 13:59:14.017 +00:00 [DBG] Getting claims for access token for subject: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 13:59:14.023 +00:00 [DBG] Getting claims for identity token for subject: 42006211-B900-4701-A6F8-2986370C3563 and client: wewantdoughnuts
2025-04-02 13:59:14.023 +00:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2025-04-02 13:59:14.028 +00:00 [INF] {"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","Endpoint":"Authorize","SubjectId":"42006211-B900-4701-A6F8-2986370C3563","Scopes":"openid profile email doughnutapi","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****Dz7A","$type":"Token"},{"TokenType":"access_token","TokenValue":"****a9uw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HNBHQO70QLM1:0000004D","TimeStamp":"2025-04-02T13:59:14.0000000Z","ProcessId":1931,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"TokenIssuedSuccessEvent"}
2025-04-02 13:59:14.029 +00:00 [DBG] Authorize endpoint response
{"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ClientId":"wewantdoughnuts","RedirectUri":"http://localhost:3000/signin-oidc","State":"0b3c88d4ee714ba7b924377be8822050","Scope":"openid profile email doughnutapi","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2025-04-02 13:59:14.683 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 13:59:14.684 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 13:59:14.685 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 13:59:14.686 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 13:59:14.688 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 13:59:14.689 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 13:59:14.690 +00:00 [DBG] Start discovery request
2025-04-02 13:59:14.823 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:3000
2025-04-02 13:59:14.848 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 13:59:14.849 +00:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2025-04-02 13:59:14.859 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 13:59:14.864 +00:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2025-04-02 13:59:14.873 +00:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2025-04-02 13:59:14.889 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2025-04-02 13:59:14.897 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2025-04-02 13:59:14.903 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2025-04-02 13:59:14.906 +00:00 [DBG] Rendering check session result
2025-04-02 13:59:14.908 +00:00 [DBG] Start key discovery request
2025-04-02 13:59:14.986 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 13:59:14.988 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 13:59:14.988 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 13:59:15.001 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 13:59:15.002 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 13:59:15.002 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 13:59:15.004 +00:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2025-04-02 13:59:15.005 +00:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2025-04-02 13:59:15.006 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2025-04-02 13:59:15.007 +00:00 [DBG] Start userinfo request
2025-04-02 13:59:15.009 +00:00 [DBG] Bearer token found in header
2025-04-02 13:59:15.011 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 13:59:15.017 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 13:59:15.018 +00:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2025-04-02 13:59:15.023 +00:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":"67C38EC1B847E911E61A78A10C73FD66","Claims":{"nbf":1743602354,"exp":1743605954,"iss":"https://webapi:8081","aud":["doughnutapi","https://webapi:8081/resources"],"client_id":"wewantdoughnuts","sub":"42006211-B900-4701-A6F8-2986370C3563","auth_time":1743601489,"idp":"local","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress":"AliceSmith@email.com","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname":"Alice","jti":"67C38EC1B847E911E61A78A10C73FD66","sid":"5FEAA00ED4854DF0A51B9F544596FD8F","iat":1743602354,"scope":["openid","profile","email","doughnutapi"],"amr":"pwd"},"$type":"TokenValidationLog"}
2025-04-02 13:59:15.029 +00:00 [DBG] Creating userinfo response
2025-04-02 13:59:15.030 +00:00 [DBG] Scopes in access token: openid profile email doughnutapi
2025-04-02 13:59:15.031 +00:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2025-04-02 13:59:15.033 +00:00 [INF] Profile service returned the following claim types: email given_name
2025-04-02 13:59:15.035 +00:00 [DBG] End userinfo request
2025-04-02 13:59:45.031 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 13:59:45.053 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 13:59:45.056 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 13:59:45.061 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 13:59:45.063 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 13:59:45.067 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 13:59:45.069 +00:00 [DBG] Start discovery request
2025-04-02 13:59:45.221 +00:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2025-04-02 13:59:45.224 +00:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2025-04-02 13:59:45.229 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2025-04-02 13:59:45.231 +00:00 [DBG] Rendering check session result
2025-04-02 13:59:53.336 +00:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2025-04-02 13:59:53.337 +00:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2025-04-02 13:59:53.338 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2025-04-02 13:59:53.339 +00:00 [DBG] Start authorize request
2025-04-02 13:59:53.340 +00:00 [DBG] User in authorize request: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 13:59:53.344 +00:00 [DBG] Start authorize request protocol validation
2025-04-02 13:59:53.347 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 13:59:53.352 +00:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2025-04-02 13:59:53.353 +00:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","AllowedRedirectUris":["http://localhost:3000/signin-oidc"],"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email doughnutapi","State":"5a584b972d154b14bb7bdc94c8c07d57","UiLocales":null,"Nonce":"a18f23308b2c4e8dbe29d96c1f5698d7","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"5FEAA00ED4854DF0A51B9F544596FD8F","Raw":{"client_id":"wewantdoughnuts","redirect_uri":"http://localhost:3000/signin-oidc","response_type":"id_token token","scope":"openid profile email doughnutapi","state":"5a584b972d154b14bb7bdc94c8c07d57","nonce":"a18f23308b2c4e8dbe29d96c1f5698d7"},"$type":"AuthorizeRequestValidationLog"}
2025-04-02 13:59:53.356 +00:00 [DBG] Client is configured to not require consent, no consent is required
2025-04-02 13:59:53.357 +00:00 [DBG] Creating Implicit Flow response.
2025-04-02 13:59:53.358 +00:00 [DBG] Getting claims for access token for client: wewantdoughnuts
2025-04-02 13:59:53.360 +00:00 [DBG] Getting claims for access token for subject: 42006211-B900-4701-A6F8-2986370C3563
2025-04-02 13:59:53.363 +00:00 [DBG] Getting claims for identity token for subject: 42006211-B900-4701-A6F8-2986370C3563 and client: wewantdoughnuts
2025-04-02 13:59:53.364 +00:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2025-04-02 13:59:53.370 +00:00 [INF] {"ClientId":"wewantdoughnuts","ClientName":"We Want Doughnuts","RedirectUri":"http://localhost:3000/signin-oidc","Endpoint":"Authorize","SubjectId":"42006211-B900-4701-A6F8-2986370C3563","Scopes":"openid profile email doughnutapi","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****XYqA","$type":"Token"},{"TokenType":"access_token","TokenValue":"****dYpw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HNBHQO70QLM1:0000004F","TimeStamp":"2025-04-02T13:59:53.0000000Z","ProcessId":1931,"LocalIpAddress":"::ffff:172.18.0.2:8081","RemoteIpAddress":"::ffff:172.18.0.1","$type":"TokenIssuedSuccessEvent"}
2025-04-02 13:59:53.371 +00:00 [DBG] Authorize endpoint response
{"SubjectId":"42006211-B900-4701-A6F8-2986370C3563","ClientId":"wewantdoughnuts","RedirectUri":"http://localhost:3000/signin-oidc","State":"5a584b972d154b14bb7bdc94c8c07d57","Scope":"openid profile email doughnutapi","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2025-04-02 13:59:54.444 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:3000
2025-04-02 13:59:54.445 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 13:59:54.447 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 13:59:54.452 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 13:59:54.455 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 13:59:54.456 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 13:59:54.459 +00:00 [DBG] Start discovery request
2025-04-02 13:59:54.582 +00:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:3000
2025-04-02 13:59:54.604 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 13:59:54.608 +00:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2025-04-02 13:59:54.624 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 13:59:54.627 +00:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2025-04-02 13:59:54.634 +00:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2025-04-02 13:59:54.635 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2025-04-02 13:59:54.638 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2025-04-02 13:59:54.638 +00:00 [DBG] Rendering check session result
2025-04-02 13:59:54.639 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2025-04-02 13:59:54.640 +00:00 [DBG] Start key discovery request
2025-04-02 13:59:54.718 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 13:59:54.719 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 13:59:54.720 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 13:59:54.731 +00:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:3000
2025-04-02 13:59:54.732 +00:00 [DBG] Client list checked and origin: http://localhost:3000 is allowed
2025-04-02 13:59:54.734 +00:00 [DBG] CorsPolicyService allowed origin: http://localhost:3000
2025-04-02 13:59:54.735 +00:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2025-04-02 13:59:54.736 +00:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2025-04-02 13:59:54.737 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2025-04-02 13:59:54.738 +00:00 [DBG] Start userinfo request
2025-04-02 13:59:54.742 +00:00 [DBG] Bearer token found in header
2025-04-02 13:59:54.744 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 13:59:54.744 +00:00 [DBG] client configuration validation for client wewantdoughnuts succeeded.
2025-04-02 13:59:54.747 +00:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2025-04-02 13:59:54.750 +00:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":"19D38A39D17FA3DFE2BF508D426238D0","Claims":{"nbf":1743602393,"exp":1743605993,"iss":"https://webapi:8081","aud":["doughnutapi","https://webapi:8081/resources"],"client_id":"wewantdoughnuts","sub":"42006211-B900-4701-A6F8-2986370C3563","auth_time":1743601489,"idp":"local","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress":"AliceSmith@email.com","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname":"Alice","jti":"19D38A39D17FA3DFE2BF508D426238D0","sid":"5FEAA00ED4854DF0A51B9F544596FD8F","iat":1743602393,"scope":["openid","profile","email","doughnutapi"],"amr":"pwd"},"$type":"TokenValidationLog"}
2025-04-02 13:59:54.751 +00:00 [DBG] Creating userinfo response
2025-04-02 13:59:54.754 +00:00 [DBG] Scopes in access token: openid profile email doughnutapi
2025-04-02 13:59:54.757 +00:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2025-04-02 13:59:54.758 +00:00 [INF] Profile service returned the following claim types: email given_name
2025-04-02 13:59:54.759 +00:00 [DBG] End userinfo request
2025-04-02 14:15:38.759 +00:00 [INF] Starting IdentityServer4 version 4.1.1+cebd52f5bc61bdefc262fd20739d4d087c6f961f
2025-04-02 14:15:38.807 +00:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2025-04-02 14:15:38.808 +00:00 [DBG] Custom IssuerUri set to https://webapi:8081
2025-04-02 14:15:38.823 +00:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2025-04-02 14:15:38.823 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2025-04-02 14:15:38.824 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2025-04-02 14:15:38.825 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2025-04-02 14:15:38.826 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2025-04-02 14:15:38.827 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2025-04-02 14:15:39.078 +00:00 [WRN] Using an in-memory repository. Keys will not be persisted to storage.
2025-04-02 14:15:39.079 +00:00 [WRN] Neither user profile nor HKLM registry available. Using an ephemeral key repository. Protected data will be unavailable when application exits.
2025-04-02 14:15:39.101 +00:00 [WRN] No XML encryptor configured. Key "8007a7f4-f245-4611-8ca3-cb8016c96fb2" may be persisted to storage in unencrypted form.
2025-04-02 14:16:17.769 +00:00 [DBG] Login Url: /Account/Login
2025-04-02 14:16:17.771 +00:00 [DBG] Login Return Url Parameter: ReturnUrl
2025-04-02 14:16:17.772 +00:00 [DBG] Logout Url: /Account/Logout
2025-04-02 14:16:17.772 +00:00 [DBG] ConsentUrl Url: /consent
2025-04-02 14:16:17.774 +00:00 [DBG] Consent Return Url Parameter: returnUrl
2025-04-02 14:16:17.775 +00:00 [DBG] Error Url: /home/error
2025-04-02 14:16:17.776 +00:00 [DBG] Error Id Parameter: errorId
2025-04-02 14:16:17.795 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 14:16:17.798 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 14:16:17.799 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 14:16:17.801 +00:00 [DBG] Start discovery request
2025-04-02 14:16:17.916 +00:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2025-04-02 14:16:17.942 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2025-04-02 14:16:17.942 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2025-04-02 14:16:17.945 +00:00 [DBG] Start key discovery request
2025-04-02 14:39:12.130 +00:00 [INF] Starting IdentityServer4 version 4.1.1+cebd52f5bc61bdefc262fd20739d4d087c6f961f
2025-04-02 14:39:12.165 +00:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2025-04-02 14:39:12.167 +00:00 [DBG] Custom IssuerUri set to https://webapi:8081
2025-04-02 14:39:12.178 +00:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2025-04-02 14:39:12.178 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2025-04-02 14:39:12.179 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2025-04-02 14:39:12.179 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2025-04-02 14:39:12.180 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2025-04-02 14:39:12.181 +00:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2025-04-02 14:39:12.360 +00:00 [WRN] Using an in-memory repository. Keys will not be persisted to storage.
2025-04-02 14:39:12.360 +00:00 [WRN] Neither user profile nor HKLM registry available. Using an ephemeral key repository. Protected data will be unavailable when application exits.
2025-04-02 14:39:12.381 +00:00 [WRN] No XML encryptor configured. Key "1fe3a64a-3520-49e4-9b7c-017cee33fb14" may be persisted to storage in unencrypted form.
2025-04-02 14:40:37.570 +00:00 [DBG] Login Url: /Account/Login
2025-04-02 14:40:37.572 +00:00 [DBG] Login Return Url Parameter: ReturnUrl
2025-04-02 14:40:37.572 +00:00 [DBG] Logout Url: /Account/Logout
2025-04-02 14:40:37.573 +00:00 [DBG] ConsentUrl Url: /consent
2025-04-02 14:40:37.574 +00:00 [DBG] Consent Return Url Parameter: returnUrl
2025-04-02 14:40:37.576 +00:00 [DBG] Error Url: /home/error
2025-04-02 14:40:37.577 +00:00 [DBG] Error Id Parameter: errorId
2025-04-02 14:40:37.594 +00:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-04-02 14:40:37.598 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2025-04-02 14:40:37.598 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-04-02 14:40:37.601 +00:00 [DBG] Start discovery request
2025-04-02 14:40:37.684 +00:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2025-04-02 14:40:37.694 +00:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2025-04-02 14:40:37.694 +00:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2025-04-02 14:40:37.696 +00:00 [DBG] Start key discovery request
